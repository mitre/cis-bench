{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"CIS Benchmark CLI","text":"<p>Professional command-line tool for downloading and managing CIS security benchmarks from CIS WorkBench</p> <p> </p>"},{"location":"#what-is-cis-benchmark-cli","title":"What is CIS Benchmark CLI?","text":"<p><code>cis-bench</code> downloads CIS security benchmarks from CIS WorkBench and exports them to multiple formats, including NIST XCCDF for use with SCAP compliance scanners like OpenSCAP, SCC, and Nessus.</p> <p>Use Cases:</p> <ul> <li>Discover - Search 1,300+ CIS benchmarks with platform filtering</li> <li>Download - Fetch benchmarks with browser-based authentication</li> <li>Convert - Export to YAML, CSV, Markdown, or NIST XCCDF</li> <li>Comply - Generate DISA STIG-compatible XCCDF for DoD environments</li> <li>Analyze - Extract 19 fields including CIS Controls, MITRE ATT&amp;CK, NIST mappings</li> </ul>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># 1. Install\npip install -e .\n\n# 2. Login (one-time)\ncis-bench auth login --browser chrome\n\n# 3. Build catalog (one-time, ~2 minutes)\ncis-bench catalog refresh\n\n# 4. Get a benchmark\ncis-bench get \"ubuntu 22.04\" --format xccdf --style cis\n\n# Done! You have a SCAP-compliant XCCDF file\n</code></pre> <p>Get Started Guide for detailed setup</p>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#session-based-authentication","title":"Session-Based Authentication","text":"<p>Login once, use everywhere. No more passing <code>--browser</code> on every command.</p> <pre><code>cis-bench auth login --browser chrome\ncis-bench download 23598 # Uses saved session\n</code></pre>"},{"location":"#searchable-catalog","title":"Searchable Catalog","text":"<p>Fast local search of 1,300+ benchmarks with FTS5 full-text search and platform taxonomy.</p> <pre><code>cis-bench search \"oracle\" --platform-type cloud\ncis-bench search --platform-type database --latest\n</code></pre>"},{"location":"#unified-get-command","title":"Unified Get Command","text":"<p>Search + download + export in one step.</p> <pre><code>cis-bench get \"ubuntu 22\" --format xccdf --style cis\n</code></pre>"},{"location":"#database-caching","title":"Database Caching","text":"<p>Downloaded benchmarks cached in SQLite for instant re-export.</p> <pre><code>cis-bench export 23598 --format xccdf # Instant (from cache)\n</code></pre>"},{"location":"#multiple-export-formats","title":"Multiple Export Formats","text":"<ul> <li>YAML - Human-readable structured data</li> <li>CSV - Spreadsheet import</li> <li>Markdown - Documentation</li> <li>JSON - Machine-readable</li> <li>XCCDF - SCAP compliance (DISA STIG or CIS native)</li> </ul>"},{"location":"#platform-filtering","title":"Platform Filtering","text":"<p>Two-level taxonomy: category (cloud/os/database) + specific platform (aws/ubuntu/oracle).</p> <pre><code>cis-bench search --platform-type cloud # All cloud benchmarks\ncis-bench search --platform ubuntu # All Ubuntu versions\n</code></pre>"},{"location":"#scriptable-and-automatable","title":"Scriptable and Automatable","text":"<p>All commands support JSON output for piping to <code>jq</code>, scripting, CI/CD.</p> <pre><code>cis-bench search oracle --output-format json | jq -r '.[].benchmark_id'\n</code></pre>"},{"location":"#performance","title":"Performance","text":"<ul> <li>Parallel catalog scraping (~2 min for 1,300+ benchmarks)</li> <li>Retry logic with exponential backoff</li> <li>Progress bars on long operations</li> </ul>"},{"location":"#documentation","title":"Documentation","text":""},{"location":"#for-users","title":"For Users","text":"<ul> <li>Getting Started - Installation and first steps</li> <li>End-to-End Workflows - Real-world scenarios</li> <li>Commands Reference - Complete command syntax and options</li> <li>Catalog Guide - Search and discovery workflows</li> <li>XCCDF Export Guide - SCAP compliance export</li> <li>Configuration - Environment variables and settings</li> <li>Troubleshooting - Common issues and solutions</li> </ul>"},{"location":"#for-developers","title":"For Developers","text":"<ul> <li>Architecture Overview - System design and components</li> <li>Data Flow Pipeline - Complete transformation pipeline</li> <li>MappingEngine Guide - Working with YAML configs</li> <li>Contributing Guide - Code standards and development workflow</li> <li>Testing Guide - Running and writing tests</li> <li>How to Add XCCDF Style - Extending XCCDF export</li> </ul>"},{"location":"#technical-reference","title":"Technical Reference","text":"<ul> <li>Data Model - Pydantic models and field definitions</li> <li>Mapping Engine Design - Technical architecture</li> <li>XCCDF Styles - DISA vs CIS format comparison</li> <li>YAML Config Reference - Mapping configuration syntax</li> </ul>"},{"location":"#example-workflows","title":"Example Workflows","text":""},{"location":"#export-almalinux-10-for-openscap-scanning","title":"Export AlmaLinux 10 for OpenSCAP Scanning","text":"<pre><code>cis-bench auth login --browser chrome\ncis-bench search \"almalinux 10\"\n# Shows: Benchmark ID 23598\n\ncis-bench download 23598\ncis-bench export 23598 --format xccdf --style cis -o almalinux10-cis.xml\n\n# Use with OpenSCAP\noscap xccdf eval --profile Level_1 almalinux10-cis.xml\n</code></pre>"},{"location":"#batch-export-all-cloud-benchmarks","title":"Batch Export All Cloud Benchmarks","text":"<pre><code># Search and download all cloud benchmarks\ncis-bench search --platform-type cloud --output-format json | \\\njq -r '.[].benchmark_id' | \\\nhead -5 | \\\nxargs -I {} cis-bench download {}\n\n# Export all to DISA STIG format\ncis-bench list --output-format json | \\\njq -r '.[].file' | \\\nxargs -I {} cis-bench export {} --format xccdf --style disa\n</code></pre>"},{"location":"#create-compliance-spreadsheet","title":"Create Compliance Spreadsheet","text":"<pre><code>cis-bench download 24008 # Oracle Cloud Infrastructure\ncis-bench export 24008 --format csv -o oci-compliance.csv\n\n# Open in Excel/Numbers for tracking\nopen oci-compliance.csv\n</code></pre> <p>** More examples in User Guide**</p>"},{"location":"#xccdf-export","title":"XCCDF Export","text":"<p>Generate NIST XCCDF 1.2 format compatible with SCAP compliance tools:</p> <p>Two Styles Available:</p>"},{"location":"#disa-stig-style-for-dodgovernment","title":"DISA STIG Style (For DoD/Government)","text":"<pre><code>cis-bench export 23598 --format xccdf --style disa\n</code></pre> <p>Features:</p> <ul> <li>XCCDF 1.1.4 (DISA standard)</li> <li>CCI mappings (2,161 DoD Control Correlation Identifiers)</li> <li>VulnDiscussion elements</li> <li>STIG-compatible structure</li> </ul>"},{"location":"#cis-native-style-for-full-metadata","title":"CIS Native Style (For Full Metadata)","text":"<pre><code>cis-bench export 23598 --format xccdf --style cis\n</code></pre> <p>Features:</p> <ul> <li>XCCDF 1.2 (latest standard)</li> <li>Full CIS Controls v8 metadata (318 controls)</li> <li>MITRE ATT&amp;CK techniques (296 mappings)</li> <li>Enhanced namespace for custom fields</li> </ul> <p>XCCDF Styles Comparison for detailed differences</p>"},{"location":"#architecture","title":"Architecture","text":""},{"location":"#design-principles","title":"Design Principles","text":"<p>Config-Driven - XCCDF field mappings defined in YAML, not hard-coded Extensible - Strategy pattern for HTML changes, Factory pattern for exporters Validated - xsdata-generated models from NIST XSD schemas Tested - 512 tests with comprehensive coverage</p>"},{"location":"#component-overview","title":"Component Overview","text":"<pre><code>CIS WorkBench HTML\n (WorkbenchScraper + Strategy Pattern)\nPydantic Models (19 fields)\n (MappingEngine + YAML Config)\nxsdata XCCDF Models\n (XML Serialization)\nNIST XCCDF Output\n</code></pre> <p>Architecture Documentation for complete system design</p>"},{"location":"#project-status","title":"Project Status","text":"<p>Version: 1.0.0 (Production Ready) Tests: 512 passing, 0 failing Python: 3.8+ License: Apache 2.0</p> <p>Current Features:</p> <ul> <li>Session-based authentication</li> <li>Searchable catalog with 1,300+ benchmarks</li> <li>Platform taxonomy (cloud/os/database/container/application)</li> <li>Unified <code>get</code> command</li> <li>Database caching</li> <li>Multiple export formats</li> <li>XCCDF export (both DISA and CIS styles)</li> <li>Parallel catalog scraping</li> <li>Output formats for scripting (json/csv/yaml)</li> </ul> <p>Future Features:</p> <ul> <li>Offline mode</li> <li>Benchmark comparison/diff</li> <li>Recommendation search across benchmarks</li> </ul> <p>Future Features for roadmap</p>"},{"location":"#installation","title":"Installation","text":""},{"location":"#from-source","title":"From Source","text":"<pre><code>git clone https://github.com/mitre/cis-bench.git\ncd cis-benchmark-cli\n\n# Install\npip install -e .\n\n# Verify\ncis-bench --version\n</code></pre>"},{"location":"#development-install","title":"Development Install","text":"<pre><code># Install with dev dependencies\npip install -e \".[dev]\"\n\n# Install pre-commit hooks\npre-commit install\n\n# Run tests\npytest tests/ -v\n</code></pre> <p>Getting Started for detailed installation</p>"},{"location":"#requirements","title":"Requirements","text":"<p>Runtime:</p> <ul> <li>Python 3.8+</li> <li>CIS WorkBench account (free registration at workbench.cisecurity.org)</li> <li>Supported browser (Chrome, Firefox, Edge, or Safari)</li> </ul> <p>Development:</p> <ul> <li>All runtime requirements</li> <li>pytest, ruff, bandit, pre-commit (installed via <code>[dev]</code> extras)</li> </ul>"},{"location":"#support-and-contributing","title":"Support and Contributing","text":"<p>Found a bug? Open an issue at GitHub Issues</p> <p>Want to contribute? See Contributing Guide</p> <p>Questions? Check Documentation or open a discussion</p>"},{"location":"#license","title":"License","text":"<p>Apache License 2.0 - See LICENSE for details</p> <p>Acknowledgments:</p> <ul> <li>Based on proof-of-concept by m-ghonim (Mohamed Ghoneam)</li> <li>CIS WorkBench for providing benchmark data</li> <li>NIST for XCCDF schema specifications</li> <li>DISA for STIG formatting conventions</li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"<p>User Documentation:</p> <ul> <li>Getting Started</li> <li>End-to-End Workflows</li> <li>Commands Reference Complete command syntax</li> <li>XCCDF Guide</li> </ul> <p>Developer Documentation:</p> <ul> <li>Architecture</li> <li>Data Flow Pipeline</li> <li>MappingEngine Guide</li> <li>Contributing</li> <li>Testing</li> </ul> <p>Need Help?</p> <ul> <li>Check Troubleshooting Guide</li> <li>Review Configuration Options</li> <li>Browse Documentation</li> </ul>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Quick Navigation</p> <ul> <li>After setup: Try End-to-End Workflows for real examples</li> <li>Full command syntax: Commands Reference</li> <li>Troubleshooting: Common Issues</li> </ul>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#requirements","title":"Requirements","text":"<ul> <li>Python 3.8 or higher</li> <li>pip</li> </ul>"},{"location":"getting-started/#install-from-source","title":"Install from source","text":"<pre><code># Clone the repository\ngit clone https://github.com/mitre/cis-bench.git\ncd cis-benchmark-cli\n\n# Create virtual environment\npython3 -m venv venv\nsource venv/bin/activate # On Mac/Linux\n# or\nvenv\\Scripts\\activate # On Windows\n\n# Install the package\npip install -e .\n\n# Verify installation\ncis-bench --version\n</code></pre>"},{"location":"getting-started/#install-with-development-tools","title":"Install with development tools","text":"<pre><code>pip install -e \".[dev]\"\npre-commit install\n</code></pre>"},{"location":"getting-started/#quick-start","title":"Quick Start","text":"<p>The fastest way to get started:</p>"},{"location":"getting-started/#1-login-one-time","title":"1. Login (One-Time)","text":"<p>Log into CIS WorkBench and save your session:</p> <pre><code># Login with Chrome\ncis-bench auth login --browser chrome\n\n# Or with Firefox/Edge/Safari\ncis-bench auth login --browser firefox\n</code></pre> <p>What this does: 1. Optionally opens CIS WorkBench in your browser 2. Extracts session cookies from your browser 3. Validates the session 4. Saves to <code>~/.cis-bench/session.cookies</code> 5. All future commands use this saved session automatically</p> <p>Supported browsers: Chrome, Firefox, Edge, Safari</p>"},{"location":"getting-started/#2-build-catalog-one-time-2-minutes","title":"2. Build Catalog (One-Time, ~2 minutes)","text":"<p>Build a searchable local database of all CIS benchmarks:</p> <pre><code>cis-bench catalog refresh\n</code></pre> <p>This scrapes ~66 pages from CIS WorkBench using parallel processing and creates a searchable database with:</p> <ul> <li>1,300+ benchmarks indexed</li> <li>Full-text search (FTS5)</li> <li>Platform taxonomy (cloud, os, database, etc.)</li> <li>Fast local queries (no network needed)</li> </ul>"},{"location":"getting-started/#3-find-and-get-benchmarks","title":"3. Find and Get Benchmarks","text":"<p>Now you can search and download benchmarks:</p> <pre><code># Search for benchmarks\ncis-bench search \"ubuntu 22.04\"\ncis-bench search \"oracle cloud\" --platform-type cloud\n\n# All-in-one: search + download + export\ncis-bench get \"ubuntu 22\" --format xccdf --style cis\ncis-bench get \"aws eks\" --format yaml\n\n# Or download by ID first\ncis-bench download 23598\ncis-bench export 23598 --format xccdf --style cis\n</code></pre>"},{"location":"getting-started/#authentication-details","title":"Authentication Details","text":""},{"location":"getting-started/#session-based-authentication","title":"Session-Based Authentication","text":"<p>After running <code>auth login</code> once, your session is saved and all commands work without <code>--browser</code>:</p> <pre><code># Login once\ncis-bench auth login --browser chrome\n\n# Now all these work automatically\ncis-bench catalog refresh\ncis-bench download 23598\ncis-bench search \"ubuntu\"\n</code></pre>"},{"location":"getting-started/#check-login-status","title":"Check Login Status","text":"<pre><code># Check if logged in\ncis-bench auth status\n\n# JSON output for scripting\ncis-bench auth status --output-format json\n</code></pre>"},{"location":"getting-started/#logout","title":"Logout","text":"<pre><code># Clear saved session\ncis-bench auth logout\n\n# You'll need to login again\ncis-bench auth login --browser chrome\n</code></pre>"},{"location":"getting-started/#alternative-cookie-file","title":"Alternative: Cookie File","text":"<p>For automation or if browser cookie extraction fails:</p> <pre><code># Export cookies from browser using ExportCookies plugin\n# Save as cookies.txt in Netscape format\n\n# Use cookie file\ncis-bench download 23598 --cookies cookies.txt\n</code></pre>"},{"location":"getting-started/#common-workflows","title":"Common Workflows","text":""},{"location":"getting-started/#workflow-1-interactive-discovery","title":"Workflow 1: Interactive Discovery","text":"<p>Use the unified <code>get</code> command for the easiest experience:</p> <pre><code># Search and download interactively\ncis-bench get \"ubuntu\"\n# Shows matching benchmarks select one downloads exports\n\n# Or skip interactive mode\ncis-bench get \"ubuntu 22.04\" --format xccdf --style cis --non-interactive\n</code></pre>"},{"location":"getting-started/#workflow-2-search-and-download","title":"Workflow 2: Search and Download","text":"<p>For more control over the process:</p> <pre><code># 1. Search with filters\ncis-bench search \"oracle\" --platform-type cloud --latest\n\n# 2. Download by ID\ncis-bench download 23598\n\n# 3. Export to format\ncis-bench export 23598 --format xccdf --style cis\n</code></pre>"},{"location":"getting-started/#workflow-3-platform-specific-search","title":"Workflow 3: Platform-Specific Search","text":"<p>Find all benchmarks for a platform category:</p> <pre><code># All cloud benchmarks\ncis-bench search --platform-type cloud\n\n# All databases\ncis-bench search --platform-type database\n\n# Specific platform\ncis-bench search --platform ubuntu --latest\n</code></pre>"},{"location":"getting-started/#workflow-4-export-to-multiple-formats","title":"Workflow 4: Export to Multiple Formats","text":"<p>Export a benchmark to different formats:</p> <pre><code># Export by ID (from database)\ncis-bench export 23598 --format yaml\ncis-bench export 23598 --format csv\ncis-bench export 23598 --format markdown\ncis-bench export 23598 --format xccdf --style cis\ncis-bench export 23598 --format xccdf --style disa\n\n# Or export from file\ncis-bench export benchmark.json --format xccdf --style cis\n</code></pre>"},{"location":"getting-started/#workflow-5-scriptable-with-json","title":"Workflow 5: Scriptable with JSON","text":"<p>All query commands support JSON output for piping:</p> <pre><code># Search with JSON output\ncis-bench search \"oracle\" --output-format json | jq -r '.[].benchmark_id'\n\n# List downloaded benchmarks\ncis-bench list --output-format json | jq\n\n# Check auth status\ncis-bench auth status --output-format json\n</code></pre>"},{"location":"getting-started/#workflow-6-batch-downloads","title":"Workflow 6: Batch Downloads","text":"<p>Download multiple benchmarks:</p> <pre><code># Download multiple IDs\ncis-bench download 23598 24008 22162\n\n# From file\necho \"23598\" &gt; urls.txt\necho \"24008\" &gt;&gt; urls.txt\ncis-bench download --file urls.txt\n\n# Download and export in one command\ncis-bench download 23598 --format xccdf --format yaml\n</code></pre>"},{"location":"getting-started/#environment-configuration","title":"Environment Configuration","text":""},{"location":"getting-started/#data-storage-locations","title":"Data Storage Locations","text":"<p>The CLI supports three environments:</p> <p>Production (default): <pre><code># Data stored in: ~/.cis-bench/\ncis-bench catalog refresh\n</code></pre></p> <p>Development: <pre><code># Data stored in: ~/.cis-bench-dev/\nexport CIS_BENCH_ENV=dev\ncis-bench catalog refresh\n</code></pre></p> <p>Test (automatic): <pre><code># Data stored in: /tmp/cis-bench-test/\n# Used by pytest automatically\n# Keeps tests isolated\n</code></pre></p>"},{"location":"getting-started/#environment-variables","title":"Environment Variables","text":"<pre><code># Disable SSL verification (for corporate proxies)\nexport CIS_BENCH_VERIFY_SSL=false\n\n# Change data directory environment\nexport CIS_BENCH_ENV=dev\n\n# Configure search limit\nexport CIS_BENCH_SEARCH_LIMIT=500\n\n# Configure table title width\nexport CIS_BENCH_TABLE_TITLE_WIDTH=120\n</code></pre>"},{"location":"getting-started/#catalog-management","title":"Catalog Management","text":""},{"location":"getting-started/#update-catalog","title":"Update Catalog","text":"<p>Keep your catalog up to date:</p> <pre><code># Quick update (page 1 only - new benchmarks)\ncis-bench catalog update\n\n# Full refresh (all 66 pages - ~2 minutes)\ncis-bench catalog refresh\n\n# Check for updates to downloaded benchmarks\ncis-bench catalog check-updates\n</code></pre>"},{"location":"getting-started/#catalog-commands","title":"Catalog Commands","text":"<p>For complete catalog command syntax and options, see Commands Reference.</p> <p>Quick examples: <pre><code>cis-bench search \"ubuntu\" # Search catalog\ncis-bench catalog platforms # List all platforms\ncis-bench catalog stats # Show statistics\n</code></pre></p>"},{"location":"getting-started/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/#ssl-certificate-errors","title":"SSL Certificate Errors","text":"<p>If you get SSL errors with corporate proxies:</p> <pre><code># Disable SSL verification\ncis-bench auth login --browser chrome --no-verify-ssl\n\n# Or set environment variable\nexport CIS_BENCH_VERIFY_SSL=false\ncis-bench catalog refresh\n</code></pre> <p>See Troubleshooting Guide for more SSL solutions.</p>"},{"location":"getting-started/#session-expired","title":"Session Expired","text":"<p>If your session expires:</p> <pre><code># Check status\ncis-bench auth status\n\n# Login again\ncis-bench auth login --browser chrome\n</code></pre>"},{"location":"getting-started/#catalog-not-found","title":"Catalog Not Found","text":"<p>If you get \"catalog not found\" errors:</p> <pre><code># Build catalog first\ncis-bench catalog refresh\n\n# Then search\ncis-bench search \"ubuntu\"\n</code></pre>"},{"location":"about/FUTURE_FEATURES/","title":"CIS Benchmark CLI - Future Features","text":"<p>Status: Design document for v1.1+ features</p> <p>Note: As of v1.0.0, many originally planned features have been implemented. See Commands Reference for current features.</p>"},{"location":"about/FUTURE_FEATURES/#implemented-features-v100","title":"Implemented Features (v1.0.0)","text":"<p>The following features were originally planned as \"future\" but are now complete:</p> <ul> <li>Catalog System - SQLite database with FTS5 search (<code>catalog refresh</code>, <code>search</code> command)</li> <li>Session Persistence - Login once with <code>auth login</code>, session saved to <code>~/.cis-bench/session.cookies</code></li> <li>Search and Discovery - <code>search</code> command with platform filtering</li> <li>Get Command - Unified <code>get</code> command (search + download + export in one)</li> <li>Interactive Mode - questionary-based selection in <code>get</code> command</li> <li>Database Caching - Downloaded benchmarks cached in catalog.db</li> <li>Output Formats - JSON/CSV/YAML on all query commands</li> <li>Progress Bars - Rich progress bars on downloads and catalog refresh</li> <li>Platform Taxonomy - Two-field system (platform_type + platform)</li> <li>Parallel Scraping - Catalog refresh in ~2 min (was ~10 min)</li> </ul>"},{"location":"about/FUTURE_FEATURES/#future-features-v11","title":"Future Features (v1.1+)","text":""},{"location":"about/FUTURE_FEATURES/#1-offline-mode","title":"1. Offline Mode","text":"<p>Problem: Users may want to work without network access once they have catalog/benchmarks cached.</p> <p>Solution: <code>--offline</code> flag that fails fast if network is required:</p> <pre><code># Work from cache only\ncis-bench search \"ubuntu\" --offline\ncis-bench export 23598 --format xccdf --offline # OK if cached\ncis-bench download 23598 --offline # ERROR: requires network\n</code></pre> <p>Implementation:</p> <ul> <li>Add <code>--offline</code> global flag</li> <li>Check network requirements before operations</li> <li>Clear error messages when network needed</li> <li>Works with cached catalog and downloaded benchmarks</li> </ul> <p>Priority: Medium (v1.1)</p>"},{"location":"about/FUTURE_FEATURES/#2-background-catalog-refresh","title":"2. Background Catalog Refresh","text":"<p>Problem: Catalog refresh takes ~2 minutes, blocks user</p> <p>Solution: Optional background refresh with notifications:</p> <pre><code># Start background refresh\ncis-bench catalog refresh --background\n\n# Check status\ncis-bench catalog status\n# Output: Refreshing catalog... 45/66 pages (2 min remaining)\n\n# Use catalog while refreshing (uses last complete refresh)\ncis-bench search \"ubuntu\" # Works immediately\n</code></pre> <p>Implementation:</p> <ul> <li>Use multiprocessing for true background</li> <li>Store PID in ~/.cis-bench/refresh.pid</li> <li>Show progress when user checks status</li> <li>Atomic database updates (don't corrupt active catalog)</li> </ul> <p>Priority: Low (v1.2)</p>"},{"location":"about/FUTURE_FEATURES/#3-batch-export-operations","title":"3. Batch Export Operations","text":"<p>Problem: Exporting multiple benchmarks to same format is manual</p> <p>Solution: Batch export from list or query:</p> <pre><code># Export all cached benchmarks\ncis-bench export --all --format xccdf --output-dir ./xccdf/\n\n# Export from search\ncis-bench search --platform-type cloud --output-format json | \\\ncis-bench export --batch --format xccdf\n\n# Export specific IDs\ncis-bench export 23598 24008 22162 --format xccdf\n</code></pre> <p>Implementation:</p> <ul> <li>Accept multiple IDs as arguments</li> <li><code>--all</code> flag for all downloaded</li> <li><code>--batch</code> flag to read IDs from stdin</li> <li>Parallel export with progress bar</li> </ul> <p>Priority: Medium (v1.2)</p>"},{"location":"about/FUTURE_FEATURES/#4-enhanced-cache-management","title":"4. Enhanced Cache Management","text":"<p>Problem: Users can't inspect/manage cache</p> <p>Solution: Cache management commands:</p> <pre><code># Show cache info\ncis-bench cache info\n# Output:\n# Catalog: 1,302 benchmarks (last refresh: 2 hours ago)\n# Downloaded: 45 benchmarks (2.3 GB)\n# Oldest: AlmaLinux 8 v3.0.0 (downloaded 30 days ago)\n\n# Clean old downloads\ncis-bench cache clean --older-than 30d\n\n# Clear catalog (force refresh on next use)\ncis-bench cache clear --catalog\n\n# Clear all\ncis-bench cache clear --all\n</code></pre> <p>Implementation:</p> <ul> <li>Track download timestamps</li> <li>Calculate cache sizes</li> <li>Age-based cleanup</li> <li>Confirm before destructive operations</li> </ul> <p>Priority: Low (v1.2)</p>"},{"location":"about/FUTURE_FEATURES/#5-benchmark-comparison","title":"5. Benchmark Comparison","text":"<p>Problem: Users want to see what changed between versions</p> <p>Solution: Diff command:</p> <pre><code># Compare two benchmark files\ncis-bench diff benchmark_v1.json benchmark_v2.json\n\n# Compare by ID (auto-fetch if needed)\ncis-bench diff 23598 24008\n\n# Output:\n# 145 unchanged recommendations\n# + 12 new recommendations\n# - 3 removed recommendations\n# ~ 8 modified recommendations\n</code></pre> <p>Implementation:</p> <ul> <li>Recommendation-level diff</li> <li>Smart matching (by ref/title)</li> <li>Colored output (green/red/yellow)</li> <li>Export diff to JSON/CSV</li> </ul> <p>Priority: Low (v1.3)</p>"},{"location":"about/FUTURE_FEATURES/#6-recommendation-search","title":"6. Recommendation Search","text":"<p>Problem: Users want to find specific recommendations across benchmarks</p> <p>Solution: Search within downloaded benchmarks:</p> <pre><code># Search recommendation content\ncis-bench find \"SSH\" --in-recommendations\n\n# Search by CIS Control\ncis-bench find --cis-control 4.8\n\n# Output:\n# Found in 3 benchmarks:\n# AlmaLinux 10: 2.2.1 Configure SSH\n# Ubuntu 22.04: 5.3.4 Ensure SSH is configured\n# RHEL 9: 4.2.1 SSH hardening\n</code></pre> <p>Implementation:</p> <ul> <li>FTS5 index on recommendation content</li> <li>Query across all downloaded benchmarks</li> <li>Group results by benchmark</li> <li>Jump to specific recommendation</li> </ul> <p>Priority: Low (v1.3)</p>"},{"location":"about/FUTURE_FEATURES/#7-web-ui","title":"7. Web UI","text":"<p>Problem: Some users prefer GUIs</p> <p>Solution: Optional web interface:</p> <pre><code># Start local web UI\ncis-bench ui\n\n# Output: Server running at http://localhost:5000\n</code></pre> <p>Features:</p> <ul> <li>Browse catalog</li> <li>Search and filter</li> <li>Download with progress</li> <li>View recommendations</li> <li>Export benchmarks</li> </ul> <p>Implementation:</p> <ul> <li>FastAPI + HTMX (lightweight)</li> <li>Reuse existing CLI logic</li> <li>Optional dependency (don't require for CLI)</li> </ul> <p>Priority: Low (v2.0) - Only if users request</p>"},{"location":"about/FUTURE_FEATURES/#not-planned","title":"Not Planned","text":"<p>Features we explicitly decided NOT to implement:</p> <ul> <li>Compliance Scanning - Out of scope, use InSpec/SCAP tools</li> <li>Benchmark Authoring - Use CIS WorkBench directly</li> <li>Remediation Scripts - Security risk, use Ansible/Chef</li> <li>Cloud Integration - Too many platforms, use native tools</li> </ul>"},{"location":"about/FUTURE_FEATURES/#contributing-ideas","title":"Contributing Ideas","text":"<p>Have a feature idea? Open an issue at: https://github.com/mitre/cis-bench/issues</p> <p>Include:</p> <ul> <li>Use case description</li> <li>Why current features don't solve it</li> <li>Proposed command syntax (if applicable)</li> <li>Expected behavior</li> </ul>"},{"location":"about/USE_CASES/","title":"CIS Benchmark CLI - Use Cases and Workflows","text":""},{"location":"about/USE_CASES/#core-workflows-v10","title":"Core Workflows (v1.0)","text":""},{"location":"about/USE_CASES/#1-security-auditor-compliance-assessment","title":"1. Security Auditor - Compliance Assessment","text":"<p>Goal: Get benchmark in XCCDF for scanning tools</p> <pre><code>cis-bench get \"AlmaLinux 8\" --format xccdf --browser chrome\n# Use with OpenSCAP, SCC, Nessus\n</code></pre>"},{"location":"about/USE_CASES/#2-documentation-team-create-runbooks","title":"2. Documentation Team - Create Runbooks","text":"<p>Goal: Generate readable documentation</p> <pre><code>cis-bench get 23598 --format markdown --browser chrome\n# Publish as internal wiki/confluence\n</code></pre>"},{"location":"about/USE_CASES/#3-compliance-manager-spreadsheet-analysis","title":"3. Compliance Manager - Spreadsheet Analysis","text":"<p>Goal: Analyze controls in Excel</p> <pre><code>cis-bench get \"Windows Server 2022\" --format csv --browser chrome\n# Import to Excel, filter by CIS Controls v8 IG2\n</code></pre>"},{"location":"about/USE_CASES/#advanced-workflows-v11","title":"Advanced Workflows (v1.1+)","text":""},{"location":"about/USE_CASES/#4-benchmark-comparison-track-changes","title":"4. Benchmark Comparison - Track Changes","text":"<p>Goal: See what changed between versions</p> <pre><code>cis-bench diff almalinux_v3.json almalinux_v4.json\n\nOutput:\nAdded: 45 new recommendations\nRemoved: 12 deprecated recommendations\nModified: 23 updated recommendations\n\nCIS Controls changes:\n\n- 15 recommendations now map to CIS v8\n- 8 MITRE techniques added\n</code></pre>"},{"location":"about/USE_CASES/#5-framework-mapping-compliance-crosswalk","title":"5. Framework Mapping - Compliance Crosswalk","text":"<p>Goal: See all NIST 800-53 controls covered</p> <pre><code>cis-bench analyze benchmark.json --show-mappings\n\nNIST 800-53 Coverage:\nAU-2: 15 recommendations\nSI-3: 8 recommendations\nCM-7: 23 recommendations\n\nMITRE ATT&amp;CK Coverage:\nT1068: 5 recommendations\nT1565: 12 recommendations\n</code></pre>"},{"location":"about/USE_CASES/#6-baseline-creation-tailored-profiles","title":"6. Baseline Creation - Tailored Profiles","text":"<p>Goal: Create custom baseline (only Level 1, only specific sections)</p> <pre><code>cis-bench tailor benchmark.json \\\n--profiles \"Level 1 - Server\" \\\n--sections \"1,2,3\" \\\n--exclude \"1.1.5,2.3.4\" \\\n--output custom_baseline.json\n\n# Then export to XCCDF\ncis-bench export custom_baseline.json --format xccdf\n</code></pre>"},{"location":"about/USE_CASES/#7-bulk-download-entire-product-family","title":"7. Bulk Download - Entire Product Family","text":"<p>Goal: Get all versions of a platform</p> <pre><code>cis-bench bulk-download --platform almalinux --all-versions\n\nDownloads:\nAlmaLinux OS 8 v1.0.0\nAlmaLinux OS 8 v2.0.0\nAlmaLinux OS 8 v3.0.0\nAlmaLinux OS 8 v4.0.0\nAlmaLinux OS 9 v1.0.0\n</code></pre>"},{"location":"about/USE_CASES/#8-update-checker-stay-current","title":"8. Update Checker - Stay Current","text":"<p>Goal: Know when benchmarks are updated</p> <pre><code>cis-bench check-updates\n\nUpdates available:\nAmazon EKS: v1.7.0 v1.8.0 available\nAlmaLinux OS 8: v4.0.0 (current)\n\ncis-bench update-all --browser chrome\n</code></pre>"},{"location":"about/USE_CASES/#9-inspecansible-generation-create-compliance-code","title":"9. InSpec/Ansible Generation - Create Compliance Code","text":"<p>Goal: Generate scanning profiles</p> <pre><code># Future integration\ncis-bench export benchmark.json --format inspec --output controls/\n\n# Generates InSpec controls\n# controls/\n# 6.1.1.rb\n# 6.1.2.rb\n# ...\n\n# Or Ansible playbook\ncis-bench export benchmark.json --format ansible --output playbook.yml\n</code></pre>"},{"location":"about/USE_CASES/#10-compliance-dashboard-generate-reports","title":"10. Compliance Dashboard - Generate Reports","text":"<p>Goal: HTML dashboard with coverage</p> <pre><code>cis-bench report benchmark.json --format html\n\nGenerates:\n\n- Coverage by CIS Controls v8 Implementation Groups\n- MITRE ATT&amp;CK heatmap\n- NIST 800-53 control mapping\n- Automated vs Manual assessment breakdown\n</code></pre>"},{"location":"about/USE_CASES/#11-cicd-integration-automated-benchmark-updates","title":"11. CI/CD Integration - Automated Benchmark Updates","text":"<p>Goal: Keep benchmarks current in pipeline</p> <pre><code># .github/workflows/update-benchmarks.yml\n\n- name: Update CIS Benchmarks\nrun: |\ncis-bench check-updates\ncis-bench update-all --format xccdf\ncis-bench export *.json --format inspec\ngit commit -m \"Updated benchmarks\"\n</code></pre>"},{"location":"about/USE_CASES/#12-offline-mode-work-without-network","title":"12. Offline Mode - Work Without Network","text":"<p>Goal: Use in air-gapped environments</p> <pre><code># Export catalog + benchmarks to bundle\ncis-bench export-bundle --platform almalinux --output cis_bundle.tar.gz\n\n# On air-gapped system\ncis-bench import-bundle cis_bundle.tar.gz\ncis-bench list-available --offline # Works from bundle\ncis-bench export benchmark.json --format xccdf # No network needed\n</code></pre>"},{"location":"about/USE_CASES/#13-compliance-tracking-gap-analysis","title":"13. Compliance Tracking - Gap Analysis","text":"<p>Goal: Track what's implemented</p> <pre><code># Import scan results\ncis-bench import-scan-results openscap_results.xml\n\n# Show gaps\ncis-bench gaps benchmark.json --scan-results openscap_results.xml\n\nCompliance Status:\nPassed: 245 / 322 (76%)\nFailed: 45 / 322 (14%)\nWARNING: Manual: 32 / 322 (10%)\n\nTop gaps by CIS Control:\n\n- CIS v8 3.14 (IG3): 12 failures\n- CIS v8 4.8 (IG2): 8 failures\n</code></pre>"},{"location":"about/USE_CASES/#14-benchmark-merge-multi-platform","title":"14. Benchmark Merge - Multi-Platform","text":"<p>Goal: Combine benchmarks for hybrid environments</p> <pre><code>cis-bench merge \\\nalmalinux8.json \\\ndocker.json \\\nkubernetes.json \\\n--output hybrid_baseline.json \\\n--deduplicate \\\n--resolve-conflicts interactive\n\n# Creates unified benchmark for Docker on AlmaLinux with K8s\n</code></pre>"},{"location":"about/USE_CASES/#15-custom-export-templates","title":"15. Custom Export Templates","text":"<p>Goal: Organization-specific formats</p> <pre><code># Custom Jinja2 template\ncis-bench export benchmark.json \\\n--template templates/corporate_policy.j2 \\\n--format pdf\n\n# Generates PDF with corporate branding\n</code></pre>"},{"location":"about/USE_CASES/#feature-priority-matrix","title":"Feature Priority Matrix","text":""},{"location":"about/USE_CASES/#high-value-easy-v11","title":"High Value + Easy (v1.1)","text":"<ul> <li>Catalog scraper with caching</li> <li>list-available with filtering</li> <li>requests-cache integration</li> <li>--no-cache flag</li> </ul>"},{"location":"about/USE_CASES/#high-value-medium-v12","title":"High Value + Medium (v1.2)","text":"<ul> <li>Interactive multi-select</li> <li><code>get</code> command with fuzzy matching</li> <li>Benchmark diff/comparison</li> <li>Framework mapping analysis</li> </ul>"},{"location":"about/USE_CASES/#high-value-hard-v13","title":"High Value + Hard (v1.3+)","text":"<ul> <li>InSpec/Ansible export</li> <li>Scan results integration</li> <li>Compliance gap analysis</li> <li>HTML dashboards</li> </ul>"},{"location":"about/USE_CASES/#future-research","title":"Future Research","text":"<ul> <li>Benchmark tailoring/customization</li> <li>Offline bundles</li> <li>CI/CD integration examples</li> <li>Benchmark merging for hybrid environments</li> </ul>"},{"location":"about/USE_CASES/#technical-considerations","title":"Technical Considerations","text":""},{"location":"about/USE_CASES/#caching-strategy","title":"Caching Strategy","text":"<pre><code># Three-tier cache:\n1. Catalog cache (~1 MB, 24 hour TTL)\n2. HTTP cache (SQLite, 7 day TTL)\n3. Downloaded benchmarks (permanent, user manages)\n\nCache locations:\n~/.cis-bench/cache/catalog.json\n~/.cis-bench/cache/http_cache.sqlite\n~/.cis-bench/cache/benchmark_metadata.json\n</code></pre>"},{"location":"about/USE_CASES/#platform-detection","title":"Platform Detection","text":"<pre><code># Extract platform from titles:\n\"CIS Amazon Elastic Kubernetes Service\" platform: \"aws\", product: \"eks\"\n\"CIS AlmaLinux OS 8 Benchmark\" platform: \"almalinux\", version: \"8\"\n\"CIS Microsoft Windows Server 2022\" platform: \"windows\", product: \"server-2022\"\n\n# Use regex patterns + fuzzy matching\n</code></pre>"},{"location":"about/USE_CASES/#searchfilter-performance","title":"Search/Filter Performance","text":"<pre><code># Build searchable index on catalog load\n{\n\"platforms\": {\"aws\": [id1, id2], \"alma\": [id3]},\n\"versions\": {\"8\": [id3], \"9\": [id4]},\n\"keywords\": {\"kubernetes\": [id1, id2]}\n}\n\n# O(1) lookups instead of linear search\n</code></pre>"},{"location":"about/USE_CASES/#user-stories","title":"User Stories","text":""},{"location":"about/USE_CASES/#story-1-new-security-engineer","title":"Story 1: New Security Engineer","text":"<p>\"I'm new to CIS benchmarks. I want to see what's available for our AWS environment and download the latest EKS benchmark.\"</p> <pre><code>cis-bench list-available --platform aws\ncis-bench get \"EKS\" --format xccdf --browser chrome\n</code></pre>"},{"location":"about/USE_CASES/#story-2-compliance-analyst","title":"Story 2: Compliance Analyst","text":"<p>\"I need to create a compliance matrix showing which NIST controls are covered by our AlmaLinux baseline.\"</p> <pre><code>cis-bench get \"AlmaLinux 8\" --browser chrome\ncis-bench analyze almalinux8.json --show-nist-mapping --format xlsx\n</code></pre>"},{"location":"about/USE_CASES/#story-3-devops-engineer","title":"Story 3: DevOps Engineer","text":"<p>\"I want to generate InSpec profiles from CIS benchmarks for automated testing.\"</p> <pre><code>cis-bench get 23598 --browser chrome\ncis-bench export almalinux8.json --format inspec --output ./controls/\nkitchen test # Uses generated InSpec controls\n</code></pre>"},{"location":"about/USE_CASES/#story-4-security-manager","title":"Story 4: Security Manager","text":"<p>\"I need to track which benchmarks have been updated and download the latest versions quarterly.\"</p> <pre><code>cis-bench check-updates\ncis-bench update-all --format xccdf --format csv\n# Email: \"3 benchmarks updated - reports attached\"\n</code></pre>"},{"location":"about/USE_CASES/#story-5-consultant","title":"Story 5: Consultant","text":"<p>\"I work with multiple clients. I need offline bundles of benchmarks to work in air-gapped environments.\"</p> <pre><code># Online system\ncis-bench export-bundle --platform all --output cis_bundle_2025_q4.tar.gz\n\n# Air-gapped system\ncis-bench import-bundle cis_bundle_2025_q4.tar.gz\ncis-bench list-available --offline\ncis-bench get 23598 --offline --format xccdf\n</code></pre>"},{"location":"about/design-philosophy/","title":"Design Philosophy","text":"<p>Why we built CIS Benchmark CLI the way we did</p> <p>This document explains our architectural choices and design philosophy to help contributors understand the framework and build on it effectively.</p>"},{"location":"about/design-philosophy/#core-principles","title":"Core Principles","text":""},{"location":"about/design-philosophy/#1-config-driven-over-hard-coded","title":"1. Config-Driven Over Hard-Coded","text":"<p>Decision: XCCDF field mappings defined in YAML configuration files, not Python code.</p> <p>Rationale:</p> <ul> <li>Adding new XCCDF styles doesn't require code changes</li> <li>Field mappings can be tested independently</li> <li>Non-developers can create custom export formats</li> <li>Clear separation between data (YAML) and logic (Python)</li> </ul> <p>See: MappingEngine User Guide</p>"},{"location":"about/design-philosophy/#2-enhanced-xccdf-format-preserving-all-available-data","title":"2. Enhanced XCCDF Format - Preserving All Available Data","text":"<p>What we do: CIS-style XCCDF exports include MITRE ATT&amp;CK and NIST mappings in addition to standard CIS Controls.</p> <p>Why: CIS WorkBench contains valuable compliance data (MITRE ATT&amp;CK, NIST SP 800-53) that official CIS XCCDF exports don't include yet. We preserve this data using XCCDF's extensibility mechanism.</p> <p>How it works:</p> <p>1. Data Source</p> <p>The MITRE and NIST mappings are official CIS data - they exist on the WorkBench website. We extract and preserve this data in our XCCDF exports.</p> <p>2. Standards Compliance</p> <p>From NIST SP 800-126 Rev. 3 (XCCDF Specification):</p> <p>\"XCCDF was designed to be extended through the use of XML namespaces. Benchmark authors may add elements from other namespaces to extend XCCDF documents with additional metadata or functionality.\"</p> <p>Best Practice: Use separate namespaces for extensions so:</p> <ul> <li>Standard parsers can validate core XCCDF</li> <li>Tools can ignore unknown elements gracefully</li> <li>Extensions don't break compatibility</li> </ul> <p>3. Industry Precedent</p> <p>XCCDF extensions are standard practice in the industry:</p> <ul> <li>DISA STIGs: Add <code>&lt;VulnDiscussion&gt;</code> and CCI mappings (not in base XCCDF)</li> <li>CIS themselves: Add custom <code>controls:cis_controls</code> namespace</li> <li>Red Hat: Adds CPE applicability extensions</li> <li>SCAP tools: Add tool-specific metadata blocks</li> </ul> <p>4. Implementation Approach</p> <p>We follow XML/XCCDF best practices for extensions:</p> <p>Use proper namespaces for extensions <pre><code>xmlns:enhanced=\"http://cisecurity.org/xccdf/enhanced/1.0\"\n</code></pre></p> <p>Keep core XCCDF valid - Base structure follows spec <pre><code>&lt;xccdf:Benchmark xmlns:xccdf=\"http://checklists.nist.gov/xccdf/1.2\"&gt;\n&lt;!-- Standard XCCDF elements --&gt;\n&lt;/xccdf:Benchmark&gt;\n</code></pre></p> <p>Document extensions - Clear schema and namespace <pre><code>&lt;!-- Enhanced metadata in separate namespace --&gt;\n&lt;xccdf:metadata&gt;\n&lt;controls:cis_controls&gt;...&lt;/controls:cis_controls&gt; &lt;!-- CIS official --&gt;\n&lt;enhanced:mitre&gt;...&lt;/enhanced:mitre&gt; &lt;!-- Our extension --&gt;\n&lt;/xccdf:metadata&gt;\n</code></pre></p> <p>Graceful degradation - Tools that don't understand extensions ignore them</p> <ul> <li>CIS-CAT: Reads CIS Controls, ignores MITRE</li> <li>OpenSCAP: Reads XCCDF structure, ignores custom metadata</li> <li>SCC: Processes rules, ignores unknown elements</li> </ul> <p>5. What Users Get</p> <p>Our enhanced format provides more comprehensive data:</p> Feature CIS Official Our Enhanced CIS Controls v7/v8 XCCDF 1.2 structure CIS Profiles MITRE ATT&amp;CK NIST SP 800-53 (mostly) DoD RMF compatible Works with CIS-CAT <p>We're more comprehensive without breaking compatibility.</p>"},{"location":"about/design-philosophy/#how-we-implemented-it","title":"How We Implemented It","text":""},{"location":"about/design-philosophy/#namespace-design","title":"Namespace Design","text":"<pre><code>&lt;xccdf:Benchmark\nxmlns:xccdf=\"http://checklists.nist.gov/xccdf/1.2\"\nxmlns:xhtml=\"http://www.w3.org/1999/xhtml\"\nxmlns:controls=\"http://cisecurity.org/controls\"\nxmlns:cc6=\"http://cisecurity.org/20-cc/v6.1\"\nxmlns:cc7=\"http://cisecurity.org/20-cc/v7.0\"\nxmlns:cc8=\"http://cisecurity.org/20-cc/v8.0\"\nxmlns:dc=\"http://purl.org/dc/elements/1.1/\"\nxmlns:enhanced=\"http://cisecurity.org/xccdf/enhanced/1.0\"&gt;\n</code></pre> <p>Breakdown:</p> <ul> <li><code>xccdf</code>, <code>xhtml</code> - Standard NIST namespaces (required)</li> <li><code>controls</code>, <code>cc6</code>, <code>cc7</code>, <code>cc8</code> - CIS official namespaces</li> <li><code>dc</code> - Dublin Core for NIST references (W3C standard)</li> <li><code>enhanced</code> - Our extension namespace for MITRE/custom metadata</li> </ul>"},{"location":"about/design-philosophy/#structure","title":"Structure","text":"<pre><code>&lt;xccdf:Rule id=\"...\"&gt;\n&lt;xccdf:title&gt;...&lt;/xccdf:title&gt;\n&lt;xccdf:description&gt;...&lt;/xccdf:description&gt;\n\n&lt;!-- NIST references (using standard Dublin Core) --&gt;\n&lt;xccdf:reference href=\"https://csrc.nist.gov/...\"&gt;\n&lt;dc:title&gt;NIST SP 800-53&lt;/dc:title&gt;\n&lt;dc:identifier&gt;AU-2&lt;/dc:identifier&gt;\n&lt;/xccdf:reference&gt;\n\n&lt;xccdf:metadata&gt;\n&lt;!-- CIS official structure (100% compatible) --&gt;\n&lt;controls:cis_controls xmlns:controls=\"http://cisecurity.org/controls\"&gt;\n&lt;controls:framework urn=\"urn:cisecurity.org:controls:8.0\"&gt;\n&lt;controls:safeguard title=\"...\" urn=\"...\"&gt;\n&lt;controls:implementation_groups ig1=\"true\" ig2=\"true\" ig3=\"true\"/&gt;\n&lt;controls:asset_type&gt;Users&lt;/controls:asset_type&gt;\n&lt;controls:security_function&gt;Protect&lt;/controls:security_function&gt;\n&lt;/controls:safeguard&gt;\n&lt;/controls:framework&gt;\n&lt;/controls:cis_controls&gt;\n\n&lt;!-- OUR EXTENSIONS (clearly marked) --&gt;\n&lt;enhanced:mitre xmlns:enhanced=\"http://cisecurity.org/xccdf/enhanced/1.0\"&gt;\n&lt;enhanced:technique id=\"T1565.001\"&gt;Data Manipulation&lt;/enhanced:technique&gt;\n&lt;enhanced:tactic id=\"TA0040\"&gt;Impact&lt;/enhanced:tactic&gt;\n&lt;enhanced:mitigation id=\"M1022\"&gt;Restrict File and Directory Permissions&lt;/enhanced:mitigation&gt;\n&lt;/enhanced:mitre&gt;\n\n&lt;!-- CIS Profiles (our extension - CIS uses &lt;Profile&gt; elements instead) --&gt;\n&lt;enhanced:profiles&gt;\n&lt;enhanced:profile&gt;Level 1 - Server&lt;/enhanced:profile&gt;\n&lt;enhanced:profile&gt;Level 1 - Workstation&lt;/enhanced:profile&gt;\n&lt;/enhanced:profiles&gt;\n&lt;/xccdf:metadata&gt;\n\n&lt;!-- CIS Controls ident elements (CIS official pattern) --&gt;\n&lt;xccdf:ident cc8:controlURI=\"http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/14\"\nsystem=\"http://cisecurity.org/20-cc/v8.0\"/&gt;\n&lt;xccdf:ident cc7:controlURI=\"http://cisecurity.org/20-cc/v7.0/control/14/subcontrol/9\"\nsystem=\"http://cisecurity.org/20-cc/v7.0\"/&gt;\n\n&lt;xccdf:rationale&gt;...&lt;/xccdf:rationale&gt;\n&lt;xccdf:fixtext&gt;...&lt;/xccdf:fixtext&gt;\n&lt;/xccdf:Rule&gt;\n</code></pre>"},{"location":"about/design-philosophy/#compatibility-testing","title":"Compatibility Testing","text":"<p>Tools to test against: 1. xmllint: Validate XML structure 2. OpenSCAP: Validate XCCDF 1.2 schema 3. CIS-CAT: Import and assess (if available) 4. SCAP Validator: NIST validation tool 5. SCC (SCAP Compliance Checker): DoD tool</p> <p>Expected results:</p> <ul> <li>Core XCCDF validates</li> <li>CIS Controls structure recognized</li> <li>Unknown elements ignored gracefully</li> <li>No validation errors</li> </ul>"},{"location":"about/design-philosophy/#standards-references","title":"Standards References","text":""},{"location":"about/design-philosophy/#xccdf-specification-nist-sp-800-126-rev-3","title":"XCCDF Specification (NIST SP 800-126 Rev. 3)","text":"<p>Section 6.1: Extensibility</p> <p>\"XCCDF supports extensibility through several mechanisms: - Use of foreign namespaces in metadata blocks - Custom elements from other namespaces - Custom attributes on existing elements</p> <p>Tools should ignore elements and attributes they do not understand.\"</p> <p>Section 6.2.5: metadata Element</p> <p>\"The metadata element is a general-purpose container for additional information about a benchmark or rule. It may contain any number of elements from any namespace.\"</p>"},{"location":"about/design-philosophy/#xml-namespaces-best-practices-w3c","title":"XML Namespaces Best Practices (W3C)","text":"<p>Use URIs that you control <pre><code>xmlns:enhanced=\"http://cisecurity.org/xccdf/enhanced/1.0\"\n</code></pre> (We're positioning this as a CIS-aligned extension)</p> <p>Document your schema Create <code>enhanced-metadata.xsd</code> defining our extensions</p> <p>Version your namespace <code>/1.0</code> allows for future evolution</p>"},{"location":"about/design-philosophy/#dublin-core-for-references-rfc-5013","title":"Dublin Core for References (RFC 5013)","text":"<p>Standard metadata vocabulary for references <pre><code>&lt;dc:title&gt;NIST SP 800-53&lt;/dc:title&gt;\n&lt;dc:identifier&gt;AU-2&lt;/dc:identifier&gt;\n&lt;dc:publisher&gt;NIST&lt;/dc:publisher&gt;\n</code></pre></p> <p>Current Implementation:</p> <ul> <li><code>enhanced:</code> namespace for MITRE/custom metadata</li> <li>CIS Controls in official <code>controls:</code> structure</li> <li>Dublin Core for NIST references</li> <li>318 CIS Controls metadata blocks</li> <li>296 MITRE ATT&amp;CK blocks</li> <li>Tested with OpenSCAP, SCC</li> </ul> <p>Result: More comprehensive than CIS official while maintaining full compatibility.</p>"},{"location":"about/design-philosophy/#3-strategy-pattern-for-html-adaptation","title":"3. Strategy Pattern for HTML Adaptation","text":"<p>What we built: Pluggable HTML parsing strategies that adapt to CIS WorkBench HTML changes without modifying core code.</p> <p>Why: CIS WorkBench updates their HTML structure periodically. Hard-coding the parser would break when HTML changes.</p> <p>How it works:</p> <ul> <li>Abstract interface (<code>ScraperStrategy</code>)</li> <li>Versioned implementations (<code>v1_current.py</code>, <code>v2_january2026.py</code>, etc.)</li> <li>Auto-detection selects correct strategy</li> <li>Old benchmarks still work with old strategies</li> </ul> <p>Benefit: HTML changes don't break existing functionality.</p> <p>See: Data Flow Pipeline - Stage 1</p>"},{"location":"about/design-philosophy/#4-factory-pattern-for-exporters","title":"4. Factory Pattern for Exporters","text":"<p>What we built: Factory Pattern for runtime exporter selection.</p> <p>Why:</p> <ul> <li>Easy to add new export formats</li> <li>Consistent interface (BaseExporter)</li> <li>Runtime format selection</li> <li>Testable in isolation</li> </ul> <p>Implementation: <pre><code>exporter = ExporterFactory.create('xccdf', style='disa')\nexporter.export(benchmark, output_path)\n</code></pre></p> <p>Benefit: Add CSV, JSON, Markdown, XCCDF without modifying core code.</p>"},{"location":"about/design-philosophy/#5-session-based-authentication","title":"5. Session-Based Authentication","text":"<p>What we built: One-time login with persistent session cookies.</p> <p>Why:</p> <ul> <li>UX improvement (no <code>--browser</code> on every command)</li> <li>Faster (no repeated cookie extraction)</li> <li>More reliable (validates session before use)</li> </ul> <p>Implementation:</p> <ul> <li><code>cis-bench auth login</code> saves to <code>~/.cis-bench/session.cookies</code></li> <li>All commands auto-load saved session</li> <li>Validates on use, prompts to re-auth if expired</li> </ul> <p>Benefit: Better user experience, fewer failures.</p> <p>See: Workflows - Scenario 1</p>"},{"location":"about/design-philosophy/#6-database-caching-for-instant-re-export","title":"6. Database Caching for Instant Re-Export","text":"<p>What we built: SQLite database that caches downloaded benchmarks for instant re-export.</p> <p>Why:</p> <ul> <li>Export to multiple formats without re-downloading</li> <li>Instant re-export (2 seconds vs 2 minutes)</li> <li>Track what's downloaded</li> <li>Support export by ID (<code>cis-bench export 23598 --format xccdf</code>)</li> </ul> <p>Implementation:</p> <ul> <li>SQLite database at <code>~/.cis-bench/catalog.db</code></li> <li><code>downloaded_benchmarks</code> table with full JSON</li> <li>Export command checks database first</li> </ul> <p>Benefit: Dramatically faster workflow for multi-format exports.</p>"},{"location":"about/design-philosophy/#7-parallel-processing-where-it-matters","title":"7. Parallel Processing Where It Matters","text":"<p>What we built: Threaded catalog scraping with sequential exports.</p> <p>Why:</p> <ul> <li>Catalog scraping is network-bound (66 pages, ~10 min sequential)</li> <li>Threading reduces time to ~2 min (5x faster)</li> <li>Exports are CPU-bound and fast enough (~2 sec/benchmark)</li> <li>No need to complicate with threading overhead</li> </ul> <p>Implementation:</p> <ul> <li>10 pages per batch</li> <li>5 concurrent threads</li> <li>Retry logic with exponential backoff</li> <li>Failure threshold (abort if &gt;10% fail)</li> </ul> <p>Benefit: Catalog refresh is fast, code stays simple.</p>"},{"location":"about/design-philosophy/#8-validation-at-multiple-layers","title":"8. Validation at Multiple Layers","text":"<p>What we built: Five-layer validation pipeline.</p> <p>Validation layers: 1. HTML parsing - Strategy validates structure 2. Pydantic models - Field validation and type checking 3. xsdata models - XCCDF structure compliance 4. XML schema - Optional xmllint validation 5. DISA conventions - STIG requirement checking</p> <p>Rationale:</p> <ul> <li>Catch errors early (fail fast)</li> <li>Clear error messages (which stage failed)</li> <li>Confidence in output quality</li> <li>Easier debugging</li> </ul> <p>Benefit: Invalid data never reaches output.</p>"},{"location":"about/design-philosophy/#extensibility-framework","title":"Extensibility Framework","text":"<p>The system is designed for extension without modification:</p> <p>Adding Features:</p> <ul> <li>New export format Create exporter class, register with factory</li> <li>New XCCDF style Create YAML config file only</li> <li>New transformation Register in base_style.yaml</li> <li>New HTML version Create strategy class</li> <li>New field Add to Pydantic model + YAML config</li> </ul> <p>NOT needed:</p> <ul> <li>Modify core exporter code</li> <li>Change MappingEngine logic</li> <li>Update WorkbenchScraper</li> <li>Rewrite tests</li> </ul> <p>See: MappingEngine User Guide for how-to guides</p>"},{"location":"about/design-philosophy/#testing-philosophy","title":"Testing Philosophy","text":"<p>Principle: Test behavior, not implementation.</p> <p>Approach:</p> <ul> <li>Unit tests: Isolated functions</li> <li>Integration tests: Component interactions</li> <li>E2E tests: Complete workflows</li> <li>Architecture tests: Validate patterns (no hard-coded fields, etc.)</li> </ul> <p>Coverage: 512 tests, all passing</p> <p>See: Testing Guide</p>"},{"location":"about/design-philosophy/#summary","title":"Summary","text":"<p>The CIS Benchmark CLI is built on these principles:</p> <ol> <li>Config-Driven - Behavior defined in YAML, not code</li> <li>Standards-Compliant - XCCDF, Dublin Core, XML namespaces</li> <li>Extensible - Add features without modifying core</li> <li>Validated - Multiple validation layers</li> <li>User-Focused - Session persistence, caching, progress bars</li> <li>Maintainable - Clear patterns, comprehensive tests</li> <li>Enhanced - Include all available data (MITRE, NIST)</li> </ol> <p>These decisions create a professional, maintainable, extensible system that provides more value than alternatives while maintaining compatibility with standard tools.</p>"},{"location":"about/design-philosophy/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture Overview - System design</li> <li>Data Flow Pipeline - Complete transformation process</li> <li>MappingEngine User Guide - Config-driven exports</li> <li>Contributing - How to extend the system</li> </ul>"},{"location":"about/glossary/","title":"Glossary","text":"<p>Comprehensive terminology reference for CIS Benchmark CLI</p>"},{"location":"about/glossary/#cis-benchmark-terminology","title":"CIS Benchmark Terminology","text":""},{"location":"about/glossary/#benchmark","title":"Benchmark","text":"<p>A complete set of security configuration recommendations for a specific platform (e.g., \"CIS AlmaLinux OS 10 Benchmark\").</p> <p>Examples:</p> <ul> <li>CIS Ubuntu 22.04 LTS Benchmark</li> <li>CIS Oracle Cloud Infrastructure Foundations Benchmark</li> <li>CIS Kubernetes Benchmark</li> </ul> <p>Not to be confused with: XCCDF Benchmark (XML element)</p>"},{"location":"about/glossary/#recommendation","title":"Recommendation","text":"<p>A single security control within a CIS Benchmark (e.g., \"1.1.1 Ensure mounting of cramfs filesystems is disabled\").</p> <p>Also called: Control, Check, Security recommendation</p> <p>Contains: Description, rationale, audit procedure, remediation steps, compliance mappings</p>"},{"location":"about/glossary/#profile","title":"Profile","text":"<p>A subset of recommendations grouped by implementation difficulty or environment type.</p> <p>Examples:</p> <ul> <li>Level 1 - Server</li> <li>Level 2 - Workstation</li> <li>Level 1 - Baseline</li> </ul> <p>Usage: Systems can implement Level 1 for basic security, Level 2 for enhanced security</p>"},{"location":"about/glossary/#assessment-status","title":"Assessment Status","text":"<p>Whether a recommendation can be checked automatically or requires manual verification.</p> <p>Values:</p> <ul> <li>Automated - Can be verified with scripts</li> <li>Manual - Requires human judgment</li> </ul>"},{"location":"about/glossary/#xccdf-terminology","title":"XCCDF Terminology","text":""},{"location":"about/glossary/#xccdf","title":"XCCDF","text":"<p>eXtensible Configuration Checklist Description Format - NIST standard for security checklists.</p> <p>Specifications:</p> <ul> <li>XCCDF 1.1.4 - Used by DISA STIGs</li> <li>XCCDF 1.2 - Latest standard, used by CIS</li> </ul> <p>Purpose: Standardized format for compliance tools (OpenSCAP, SCC, Nessus)</p>"},{"location":"about/glossary/#xccdf-benchmark","title":"XCCDF Benchmark","text":"<p>The root XML element containing all groups, rules, and profiles.</p> <p>Not to be confused with: CIS Benchmark (the source content)</p> <p>Structure: <pre><code>&lt;Benchmark id=\"xccdf_benchmark_23598\"&gt;\n&lt;title&gt;CIS AlmaLinux 10 Benchmark&lt;/title&gt;\n&lt;Group&gt;...&lt;/Group&gt;\n&lt;Profile&gt;...&lt;/Profile&gt;\n&lt;/Benchmark&gt;\n</code></pre></p>"},{"location":"about/glossary/#rule","title":"Rule","text":"<p>An XCCDF element representing a single security check (maps to CIS Recommendation).</p> <p>Structure: <pre><code>&lt;Rule id=\"xccdf_rule_1_1_1\" severity=\"medium\"&gt;\n&lt;title&gt;...&lt;/title&gt;\n&lt;description&gt;...&lt;/description&gt;\n&lt;ident&gt;...&lt;/ident&gt;\n&lt;fix&gt;...&lt;/fix&gt;\n&lt;check&gt;...&lt;/check&gt;\n&lt;/Rule&gt;\n</code></pre></p>"},{"location":"about/glossary/#group","title":"Group","text":"<p>An XCCDF element for organizing related rules.</p> <p>Examples:</p> <ul> <li>Initial Setup</li> <li>Services</li> <li>Network Configuration</li> </ul> <p>Structure: <pre><code>&lt;Group id=\"xccdf_group_1\"&gt;\n&lt;title&gt;Initial Setup&lt;/title&gt;\n&lt;Rule&gt;...&lt;/Rule&gt;\n&lt;Rule&gt;...&lt;/Rule&gt;\n&lt;/Group&gt;\n</code></pre></p>"},{"location":"about/glossary/#ident","title":"Ident","text":"<p>An XCCDF element linking rules to external control frameworks (like CCIs, CIS Controls).</p> <p>Examples: <pre><code>&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000381&lt;/ident&gt;\n&lt;ident system=\"http://cisecurity.org/20-cc/v8.0\" cc8:controlURI=\"...\"&gt;4.8&lt;/ident&gt;\n</code></pre></p>"},{"location":"about/glossary/#profile-xccdf","title":"Profile (XCCDF)","text":"<p>An XCCDF element defining a compliance profile (which rules are selected).</p> <p>Not to be confused with: CIS Profile (Level 1/2)</p> <p>Example: <pre><code>&lt;Profile id=\"xccdf_profile_level_1\"&gt;\n&lt;title&gt;Level 1 - Server&lt;/title&gt;\n&lt;select idref=\"xccdf_rule_1_1_1\" selected=\"true\"/&gt;\n&lt;/Profile&gt;\n</code></pre></p>"},{"location":"about/glossary/#compliance-and-standards-terminology","title":"Compliance and Standards Terminology","text":""},{"location":"about/glossary/#cci","title":"CCI","text":"<p>Control Correlation Identifier - DoD standard for mapping NIST 800-53 controls to actionable checks.</p> <p>Format: CCI-XXXXXX (6 digits)</p> <p>Examples:</p> <ul> <li>CCI-000381 - CM-7.1 (Configure for essential capabilities only)</li> <li>CCI-000389 - CM-8.1 (Inventory management)</li> </ul> <p>Usage: Required for DISA STIG format, maps CIS recommendations to NIST controls</p>"},{"location":"about/glossary/#nist-sp-800-53","title":"NIST SP 800-53","text":"<p>National Institute of Standards and Technology Special Publication 800-53 - Security and Privacy Controls catalog.</p> <p>Examples:</p> <ul> <li>CM-7 - Least Functionality</li> <li>AC-2 - Account Management</li> <li>SI-4 - System Monitoring</li> </ul> <p>Relationship: CIS Controls NIST 800-53 CCIs</p>"},{"location":"about/glossary/#cis-controls-v8","title":"CIS Controls v8","text":"<p>Framework of 18 top-level security controls published by Center for Internet Security.</p> <p>Examples:</p> <ul> <li>4.1 - Establish and Maintain Secure Configuration Process</li> <li>4.8 - Uninstall or Disable Unnecessary Services</li> </ul> <p>Implementation Groups:</p> <ul> <li>IG1 - Basic cyber hygiene (essential)</li> <li>IG2 - Helps enterprises manage sensitive data</li> <li>IG3 - Advanced security for critical infrastructure</li> </ul>"},{"location":"about/glossary/#mitre-attck","title":"MITRE ATT&amp;CK","text":"<p>Knowledge base of adversary tactics, techniques, and mitigations.</p> <p>Components:</p> <ul> <li>Tactics - \"What\" adversaries want (e.g., Persistence, Privilege Escalation)</li> <li>Techniques - \"How\" they achieve it (e.g., T1078 - Valid Accounts)</li> <li>Mitigations - How to prevent techniques (e.g., M1026 - Privileged Account Management)</li> </ul> <p>Usage: CIS recommendations mapped to MITRE techniques they help prevent</p>"},{"location":"about/glossary/#scap","title":"SCAP","text":"<p>Security Content Automation Protocol - Suite of standards for automated security compliance.</p> <p>Components:</p> <ul> <li>XCCDF - Checklists</li> <li>OVAL - Technical checks</li> <li>CPE - Platform naming</li> <li>CCE - Configuration enumeration</li> </ul> <p>Tools: OpenSCAP, DISA SCC, Nessus</p>"},{"location":"about/glossary/#stig","title":"STIG","text":"<p>Security Technical Implementation Guide - DoD security configuration standard.</p> <p>Format: XCCDF 1.1.4 with specific conventions (VulnDiscussion, CCIs, etc.)</p> <p>Publisher: DISA (Defense Information Systems Agency)</p>"},{"location":"about/glossary/#cis-benchmark-cli-system-components","title":"CIS Benchmark CLI System Components","text":""},{"location":"about/glossary/#workbenchscraper","title":"WorkbenchScraper","text":"<p>Component that fetches and parses CIS Benchmark HTML from CIS WorkBench.</p> <p>Location: <code>src/cis_bench/fetcher/workbench.py</code></p> <p>Purpose: Extract 19 fields per recommendation from HTML</p> <p>Uses: Strategy pattern for HTML adaptation</p>"},{"location":"about/glossary/#strategy","title":"Strategy","text":"<p>A parsing approach for extracting data from CIS WorkBench HTML.</p> <p>Current: <code>v1_current.py</code></p> <p>Purpose: Adapts to HTML structure changes without modifying core scraper</p> <p>When to add new strategy: CIS WorkBench updates HTML structure</p>"},{"location":"about/glossary/#mappingengine","title":"MappingEngine","text":"<p>Configuration-driven transformation system that converts Pydantic models to xsdata XCCDF models.</p> <p>Location: <code>src/cis_bench/exporters/mapping_engine.py</code></p> <p>Purpose: Read YAML configs and apply field mappings</p> <p>Key Feature: Change XCCDF structure by editing YAML, not code</p>"},{"location":"about/glossary/#style","title":"Style","text":"<p>A specific XCCDF output format configuration.</p> <p>Available:</p> <ul> <li>disa - DISA STIG-compatible (XCCDF 1.1.4, CCIs, VulnDiscussion)</li> <li>cis - CIS native (XCCDF 1.2, full metadata)</li> </ul> <p>Defined in: YAML files in <code>src/cis_bench/exporters/configs/</code></p> <p>Not to be confused with: Format (yaml, csv, etc.)</p>"},{"location":"about/glossary/#format","title":"Format","text":"<p>Output file type for exports.</p> <p>Available:</p> <ul> <li>json - Machine-readable structured data</li> <li>yaml - Human-readable structured data</li> <li>csv - Spreadsheet compatible</li> <li>markdown - Documentation</li> <li>xccdf - NIST XCCDF XML (requires --style)</li> </ul> <p>Usage: <code>cis-bench export 23598 --format xccdf --style disa</code></p>"},{"location":"about/glossary/#catalog","title":"Catalog","text":"<p>Local SQLite database containing metadata for 1,300+ CIS benchmarks from CIS WorkBench.</p> <p>Location: <code>~/.cis-bench/catalog.db</code></p> <p>Features:</p> <ul> <li>FTS5 full-text search</li> <li>Platform taxonomy</li> <li>Download tracking</li> <li>Update detection</li> </ul> <p>Built with: <code>cis-bench catalog refresh</code></p>"},{"location":"about/glossary/#platform-type","title":"Platform Type","text":"<p>High-level category for grouping benchmarks.</p> <p>Values:</p> <ul> <li>cloud</li> <li>os</li> <li>database</li> <li>container</li> <li>application</li> </ul> <p>Example: \"CIS Oracle Cloud\" has platform_type=\"cloud\"</p>"},{"location":"about/glossary/#platform","title":"Platform","text":"<p>Specific technology platform.</p> <p>Examples:</p> <ul> <li>aws, azure, google-cloud, oracle-cloud (cloud platforms)</li> <li>ubuntu, almalinux, rhel, windows-server (operating systems)</li> <li>mysql, postgresql, oracle-database (databases)</li> <li>kubernetes, docker (containers)</li> </ul> <p>Inferred automatically from benchmark title</p>"},{"location":"about/glossary/#data-model-terminology","title":"Data Model Terminology","text":""},{"location":"about/glossary/#pydantic-model","title":"Pydantic Model","text":"<p>Python class with type validation and serialization.</p> <p>Used for:</p> <ul> <li><code>Benchmark</code> - Complete CIS Benchmark</li> <li><code>Recommendation</code> - Single security control</li> </ul> <p>Purpose: Validate scraped data, provide type safety</p>"},{"location":"about/glossary/#xsdata-model","title":"xsdata Model","text":"<p>Python class auto-generated from XSD schema.</p> <p>Used for: XCCDF elements (Benchmark, Rule, Group, etc.)</p> <p>Generated from: NIST XCCDF schema files</p> <p>Purpose: Ensure XCCDF structure compliance</p>"},{"location":"about/glossary/#field-mapping","title":"Field Mapping","text":"<p>Configuration defining how a Pydantic field maps to an XCCDF element.</p> <p>Example: <pre><code>title:\ntarget_element: \"title\" # XCCDF element name\nsource_field: \"title\" # Pydantic field name\ntransform: \"strip_html\" # Transformation to apply\n</code></pre></p>"},{"location":"about/glossary/#transformation","title":"Transformation","text":"<p>A function that modifies field values during export.</p> <p>Available:</p> <ul> <li><code>strip_html</code> - Remove all HTML tags</li> <li><code>strip_html_keep_code</code> - Remove HTML but preserve code blocks</li> <li><code>html_to_markdown</code> - Convert HTML to Markdown</li> <li><code>none</code> - Pass through unchanged</li> </ul> <p>Defined in: <code>base_style.yaml</code> transformations section</p>"},{"location":"about/glossary/#authentication-and-session-terminology","title":"Authentication and Session Terminology","text":""},{"location":"about/glossary/#session","title":"Session","text":"<p>Authenticated connection to CIS WorkBench using cookies.</p> <p>Storage: <code>~/.cis-bench/session.cookies</code> (MozillaCookieJar format)</p> <p>Created by: <code>cis-bench auth login --browser chrome</code></p> <p>Used by: All commands that access CIS WorkBench</p>"},{"location":"about/glossary/#browser-cookie-extraction","title":"Browser Cookie Extraction","text":"<p>Process of reading authentication cookies from your browser's cookie store.</p> <p>Library: browser-cookie3</p> <p>Supported: Chrome, Firefox, Edge, Safari</p> <p>Requirement: You must be logged into workbench.cisecurity.org in browser</p>"},{"location":"about/glossary/#session-validation","title":"Session Validation","text":"<p>Testing if saved cookies still work with CIS WorkBench.</p> <p>Checks: 1. Cookies exist 2. Request to /benchmarks doesn't redirect to login 3. Response is not the login page HTML</p> <p>Happens: Automatically before catalog operations</p>"},{"location":"about/glossary/#cli-terminology","title":"CLI Terminology","text":""},{"location":"about/glossary/#command","title":"Command","text":"<p>A CLI action (download, export, search, etc.).</p> <p>Syntax: <code>cis-bench &lt;command&gt; [options] [arguments]</code></p> <p>Top-level commands:</p> <ul> <li>auth, download, export, get, list, info, search, catalog</li> </ul>"},{"location":"about/glossary/#subcommand","title":"Subcommand","text":"<p>A command nested under another command.</p> <p>Example: <code>catalog</code> has subcommands (refresh, update, search, platforms, stats)</p> <p>Syntax: <code>cis-bench catalog refresh</code></p>"},{"location":"about/glossary/#flag","title":"Flag","text":"<p>An optional command-line parameter.</p> <p>Types:</p> <ul> <li>Boolean flags: <code>--force</code>, <code>--verbose</code>, <code>--latest</code></li> <li>Value flags: <code>--format xccdf</code>, <code>--style disa</code>, <code>--browser chrome</code></li> </ul>"},{"location":"about/glossary/#output-format","title":"Output Format","text":"<p>How data is displayed to the user.</p> <p>For query commands:</p> <ul> <li>table (default) - Human-readable table</li> <li>json - Machine-readable JSON</li> <li>csv - Spreadsheet-compatible CSV</li> <li>yaml - YAML format</li> </ul> <p>Usage: <code>--output-format json</code></p> <p>Not to be confused with: Export format (for benchmarks)</p>"},{"location":"about/glossary/#database-and-storage-terminology","title":"Database and Storage Terminology","text":""},{"location":"about/glossary/#catalog-database","title":"Catalog Database","text":"<p>SQLite database storing benchmark metadata.</p> <p>Location: <code>~/.cis-bench/catalog.db</code></p> <p>Tables:</p> <ul> <li>catalog_benchmarks - Metadata for 1,300+ benchmarks</li> <li>downloaded_benchmarks - Cached benchmark JSON</li> <li>platforms, communities, owners - Lookup tables</li> <li>benchmarks_fts - FTS5 full-text search index</li> </ul>"},{"location":"about/glossary/#fts5","title":"FTS5","text":"<p>SQLite Full-Text Search version 5 - Fast text search engine.</p> <p>Usage: Powers catalog search with fuzzy matching</p> <p>Example: <code>cis-bench search \"oracle cloud\"</code> uses FTS5 to find matches</p>"},{"location":"about/glossary/#downloaded-benchmarks-table","title":"Downloaded Benchmarks Table","text":"<p>Database table storing complete benchmark JSON after download.</p> <p>Purpose: Cache benchmarks for instant re-export</p> <p>Benefit: Export to different formats without re-downloading</p>"},{"location":"about/glossary/#technical-implementation-terminology","title":"Technical Implementation Terminology","text":""},{"location":"about/glossary/#strategy-pattern","title":"Strategy Pattern","text":"<p>Design pattern allowing different HTML parsing implementations to coexist.</p> <p>Purpose: Adapt to CIS WorkBench HTML changes without modifying core code</p> <p>Components:</p> <ul> <li><code>ScraperStrategy</code> (base class)</li> <li><code>v1_current.py</code> (current implementation)</li> <li><code>StrategyDetector</code> (auto-selection)</li> </ul>"},{"location":"about/glossary/#factory-pattern","title":"Factory Pattern","text":"<p>Design pattern for creating objects without specifying exact class.</p> <p>Used in: <code>ExporterFactory</code></p> <p>Purpose: Create exporters by name (\"yaml\", \"csv\", \"xccdf\")</p> <p>Benefit: Add new exporters by registration, not code modification</p>"},{"location":"about/glossary/#config-driven","title":"Config-Driven","text":"<p>Architecture where behavior is defined in configuration files (YAML), not code.</p> <p>Applied to: XCCDF export via MappingEngine</p> <p>Benefit: Change XCCDF structure by editing YAML config</p>"},{"location":"about/glossary/#loop-driven-architecture","title":"Loop-Driven Architecture","text":"<p>Processing fields by iterating through configuration, not hard-coded lists.</p> <p>Example: <pre><code># Loop-driven (GOOD)\nfor field_name, mapping in config['field_mappings'].items():\nvalue = apply_mapping(recommendation, mapping)\n\n# Hard-coded (BAD)\ntitle = recommendation.title\ndescription = recommendation.description\n# ... manually list 50 fields\n</code></pre></p> <p>Benefit: Add/remove fields in config automatically updates export</p>"},{"location":"about/glossary/#compliance-tool-terminology","title":"Compliance Tool Terminology","text":""},{"location":"about/glossary/#openscap","title":"OpenSCAP","text":"<p>Open Source SCAP scanner for Linux/Unix systems.</p> <p>Usage: <code>oscap xccdf eval --profile Level_1 benchmark.xml</code></p> <p>Input: XCCDF XML files</p> <p>Output: Compliance scan results (HTML reports, XML results)</p>"},{"location":"about/glossary/#scc","title":"SCC","text":"<p>SCAP Compliance Checker - DISA's official SCAP validation tool.</p> <p>Purpose: Validate XCCDF structure and run compliance scans</p> <p>Requirement: XCCDF must follow DISA STIG conventions</p> <p>Input: XCCDF 1.1.4 with CCIs and VulnDiscussion</p>"},{"location":"about/glossary/#stig-viewer","title":"STIG Viewer","text":"<p>DISA tool for viewing and managing STIG checklists.</p> <p>Format: XCCDF or CKL (checklist) files</p> <p>Usage: Review STIG compliance results</p>"},{"location":"about/glossary/#inspec","title":"InSpec","text":"<p>Chef's compliance testing framework using Ruby DSL.</p> <p>Relationship to this CLI: 1. Export CIS Benchmark to XCCDF 2. Convert XCCDF to InSpec using SAF CLI 3. Run InSpec scans with generated profile</p> <p>Example: See Workflows - Scenario 4</p>"},{"location":"about/glossary/#xml-and-schema-terminology","title":"XML and Schema Terminology","text":""},{"location":"about/glossary/#xsdata","title":"xsdata","text":"<p>Python library that generates dataclasses from XSD schemas.</p> <p>Usage: Generate Python classes for XCCDF elements</p> <p>Command: <code>xsdata schemas/xccdf_1.2.xsd --package models.xccdf</code></p> <p>Result: Typed Python classes matching XCCDF schema</p>"},{"location":"about/glossary/#xsd","title":"XSD","text":"<p>XML Schema Definition - Defines structure and rules for XML documents.</p> <p>XCCDF schemas:</p> <ul> <li><code>xccdf-1.1.4.xsd</code> - DISA STIG version</li> <li><code>xccdf-1.2.xsd</code> - Latest XCCDF version</li> </ul> <p>Used for: Generating xsdata models, validating XML output</p>"},{"location":"about/glossary/#namespace","title":"Namespace","text":"<p>XML namespace - Identifies a set of element names to avoid conflicts.</p> <p>XCCDF namespaces:</p> <ul> <li><code>http://checklists.nist.gov/xccdf/1.2</code> - Core XCCDF</li> <li><code>http://purl.org/dc/elements/1.1/</code> - Dublin Core metadata</li> <li><code>http://cisecurity.org/controls</code> - CIS Controls</li> <li><code>http://cisecurity.org/20-cc/v8.0</code> - CIS Controls v8</li> </ul>"},{"location":"about/glossary/#embedded-xml-tags","title":"Embedded XML Tags","text":"<p>XML elements inside another element's text content (DISA STIG pattern).</p> <p>Example: <pre><code>&lt;description&gt;\n&lt;VulnDiscussion&gt;Discussion text...&lt;/VulnDiscussion&gt;\n&lt;FalsePositives&gt;None&lt;/FalsePositives&gt;\n&lt;/description&gt;\n</code></pre></p> <p>Not standard XCCDF - DISA convention for backward compatibility</p>"},{"location":"about/glossary/#export-terminology","title":"Export Terminology","text":""},{"location":"about/glossary/#export-style","title":"Export Style","text":"<p>Specific XCCDF format configuration (DISA vs CIS).</p> <p>See: Style (above)</p>"},{"location":"about/glossary/#export-format","title":"Export Format","text":"<p>Output file type (yaml, csv, markdown, xccdf, json).</p> <p>See: Format (above)</p>"},{"location":"about/glossary/#field-mapping_1","title":"Field Mapping","text":"<p>How Pydantic model fields map to XCCDF elements.</p> <p>Defined in: YAML config files</p> <p>Types:</p> <ul> <li>Simple (1:1 mapping)</li> <li>Composite (multiple sources one target)</li> <li>Embedded XML (nested tags)</li> <li>List (one source multiple elements)</li> </ul>"},{"location":"about/glossary/#transformation_1","title":"Transformation","text":"<p>Function applied to field values during export.</p> <p>See: Transformation (above)</p>"},{"location":"about/glossary/#variable-substitution","title":"Variable Substitution","text":"<p>Replacing placeholders like <code>{ref}</code> with actual values.</p> <p>Examples:</p> <ul> <li><code>{ref}</code> \"1.1.1\"</li> <li><code>{ref_normalized}</code> \"1_1_1\"</li> <li><code>{benchmark.title}</code> \"CIS AlmaLinux 10 Benchmark\"</li> </ul> <p>Usage: Dynamic attributes in YAML configs</p>"},{"location":"about/glossary/#cli-workflow-terminology","title":"CLI Workflow Terminology","text":""},{"location":"about/glossary/#unified-get-command","title":"Unified Get Command","text":"<p>Single command that searches, downloads, and exports in one step.</p> <p>Syntax: <code>cis-bench get \"query\" --format xccdf --style cis</code></p> <p>Steps: 1. Search catalog for query 2. Interactive selection (if multiple matches) 3. Download benchmark (or use cache) 4. Export to requested format 5. Return file path</p>"},{"location":"about/glossary/#interactive-mode","title":"Interactive Mode","text":"<p>CLI presents a menu for user selection (uses questionary library).</p> <p>Example: When <code>get</code> command finds multiple benchmarks</p> <p>Disable with: <code>--non-interactive</code> flag</p>"},{"location":"about/glossary/#cache","title":"Cache","text":"<p>Stored data to avoid re-downloading or re-processing.</p> <p>Types: 1. Session cache - Saved authentication cookies 2. Catalog cache - Benchmark metadata database 3. Download cache - Full benchmark JSON in database</p>"},{"location":"about/glossary/#force-flag","title":"Force Flag","text":"<p>Override cache and re-download/re-process.</p> <p>Usage: <code>cis-bench download 23598 --force</code></p> <p>Purpose: Get latest version even if already cached</p>"},{"location":"about/glossary/#platform-and-discovery-terminology","title":"Platform and Discovery Terminology","text":""},{"location":"about/glossary/#platform-taxonomy","title":"Platform Taxonomy","text":"<p>Two-level system for categorizing benchmarks.</p> <p>Level 1: platform_type (category)</p> <ul> <li>cloud, os, database, container, application</li> </ul> <p>Level 2: platform (specific)</p> <ul> <li>aws, ubuntu, mysql, kubernetes, nginx</li> </ul> <p>Inferred from: Benchmark title using pattern matching</p>"},{"location":"about/glossary/#full-text-search-fts5","title":"Full-Text Search (FTS5)","text":"<p>SQLite feature enabling fast fuzzy text search.</p> <p>Usage: Catalog search uses FTS5 on benchmark titles</p> <p>Example: Search \"oracl\" finds \"Oracle Cloud Infrastructure\"</p>"},{"location":"about/glossary/#file-and-directory-terminology","title":"File and Directory Terminology","text":""},{"location":"about/glossary/#data-directory","title":"Data Directory","text":"<p>Where CIS Benchmark CLI stores its data.</p> <p>Locations:</p> <ul> <li>Production: <code>~/.cis-bench/</code></li> <li>Development: <code>~/.cis-bench-dev/</code></li> <li>Test: <code>/tmp/cis-bench-test/</code></li> </ul> <p>Controlled by: <code>CIS_BENCH_ENV</code> environment variable</p>"},{"location":"about/glossary/#session-file","title":"Session File","text":"<p>MozillaCookieJar file containing authentication cookies.</p> <p>Location: <code>~/.cis-bench/session.cookies</code></p> <p>Created by: <code>cis-bench auth login</code></p> <p>Format: Netscape HTTP Cookie File</p>"},{"location":"about/glossary/#benchmark-json","title":"Benchmark JSON","text":"<p>Downloaded benchmark in JSON format with all 19 fields.</p> <p>Example: <code>almalinux10-v1.0.0-23598.json</code></p> <p>Contains: Complete Pydantic Benchmark model serialized to JSON</p> <p>Stored: 1. File in output directory 2. JSON in catalog database (downloaded_benchmarks table)</p>"},{"location":"about/glossary/#development-terminology","title":"Development Terminology","text":""},{"location":"about/glossary/#fixture","title":"Fixture","text":"<p>Test data file used in automated tests.</p> <p>Location: <code>tests/fixtures/</code></p> <p>Types:</p> <ul> <li>HTML fixtures (sample catalog pages, login page)</li> <li>Benchmark JSON (sample CIS benchmarks)</li> <li>XCCDF XML (reference outputs)</li> </ul>"},{"location":"about/glossary/#unit-test","title":"Unit Test","text":"<p>Test of a single function/method in isolation.</p> <p>Location: <code>tests/unit/</code></p> <p>Example: Testing that <code>strip_html()</code> removes HTML tags</p>"},{"location":"about/glossary/#integration-test","title":"Integration Test","text":"<p>Test of multiple components working together.</p> <p>Location: <code>tests/integration/</code></p> <p>Example: Testing complete XCCDF export pipeline</p>"},{"location":"about/glossary/#e2e-test","title":"E2E Test","text":"<p>End-to-end test of complete CLI workflow.</p> <p>Location: <code>tests/e2e/</code></p> <p>Example: Testing <code>cis-bench download 23598 &amp;&amp; cis-bench export 23598 --format xccdf</code></p>"},{"location":"about/glossary/#acronyms","title":"Acronyms","text":"Acronym Full Name Description CIS Center for Internet Security Publisher of security benchmarks DISA Defense Information Systems Agency DoD cybersecurity agency DoD Department of Defense U.S. military department NIST National Institute of Standards and Technology U.S. standards agency SCAP Security Content Automation Protocol Suite of security standards XCCDF eXtensible Configuration Checklist Description Format SCAP checklist format OVAL Open Vulnerability and Assessment Language SCAP technical checks CPE Common Platform Enumeration Platform naming standard CCE Common Configuration Enumeration Configuration naming CCI Control Correlation Identifier DoD/NIST control mapping STIG Security Technical Implementation Guide DoD security standard SCC SCAP Compliance Checker DISA validation tool IG Implementation Group CIS Controls grouping (IG1/IG2/IG3) ATT&amp;CK Adversarial Tactics, Techniques, and Common Knowledge MITRE threat framework FTS Full-Text Search SQLite search feature CLI Command-Line Interface Terminal-based interface XSD XML Schema Definition XML structure definition YAML YAML Ain't Markup Language Human-readable config format"},{"location":"about/glossary/#common-confusions","title":"Common Confusions","text":""},{"location":"about/glossary/#benchmark-vs-benchmark","title":"Benchmark vs Benchmark","text":"<ul> <li>CIS Benchmark - The source content from CIS WorkBench</li> <li>XCCDF Benchmark - The XML root element in XCCDF output</li> </ul> <p>Context matters!</p>"},{"location":"about/glossary/#rule-vs-recommendation","title":"Rule vs Recommendation","text":"<ul> <li>Recommendation - CIS terminology (input)</li> <li>Rule - XCCDF terminology (output)</li> <li>They map 1:1 - Each recommendation becomes one rule</li> </ul>"},{"location":"about/glossary/#style-vs-format","title":"Style vs Format","text":"<ul> <li>Format - File type (yaml, csv, xccdf)</li> <li>Style - XCCDF variant (disa, cis) - only applies to xccdf format</li> </ul> <p>Usage: <code>--format xccdf --style disa</code></p>"},{"location":"about/glossary/#profile-vs-profile","title":"Profile vs Profile","text":"<ul> <li>CIS Profile - Level 1/2, Server/Workstation (input)</li> <li>XCCDF Profile - Checklist configuration (output)</li> </ul> <p>Related but different!</p>"},{"location":"about/glossary/#catalog-vs-database","title":"Catalog vs Database","text":"<ul> <li>Catalog - Logical concept (searchable list of benchmarks)</li> <li>Database - Physical implementation (catalog.db SQLite file)</li> </ul> <p>Often used interchangeably in docs</p>"},{"location":"about/glossary/#related-documentation","title":"Related Documentation","text":"<ul> <li>Data Flow Pipeline - How data transforms through the system</li> <li>MappingEngine Guide - Configuration-driven transformations</li> <li>Data Model - Pydantic model definitions</li> <li>XCCDF Styles - DISA vs CIS comparison</li> <li>Commands Reference - Complete CLI syntax</li> </ul>"},{"location":"about/glossary/#contributing-to-glossary","title":"Contributing to Glossary","text":"<p>Found a term that's unclear? Submit a PR adding it to this glossary, or open an issue requesting clarification.</p> <p>Guidelines:</p> <ul> <li>Keep definitions concise (1-3 sentences)</li> <li>Include examples when helpful</li> <li>Link to related terms</li> <li>Note common confusions</li> </ul>"},{"location":"about/licensing/","title":"Licensing","text":"<p>Navigation</p> <p>You are in: About Licensing  See also: Design Philosophy | Glossary</p>"},{"location":"about/licensing/#license","title":"License","text":"<p>CIS Benchmark CLI is licensed under Apache License 2.0.</p> <pre><code>Copyright \u00a9 2025 The MITRE Corporation\n\nApproved for Public Release; Distribution Unlimited. Case Number 18-3678.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n http://www.apache.org/licenses/LICENSE-2.0\n</code></pre> <p>See the full LICENSE file for complete terms.</p>"},{"location":"about/licensing/#licensing-approach","title":"Licensing Approach","text":""},{"location":"about/licensing/#tool-vs-content","title":"Tool vs. Content","text":"<p>This software provides format conversion functionality - transforming CIS Benchmark data from HTML to standardized XCCDF XML format.</p> <p>Under established copyright law, format conversion tools constitute independent works:</p> <ul> <li>Tool Copyright: The parsing methodology, transformation logic, and software architecture</li> <li>Content Copyright: CIS Benchmark content remains under CIS's CC BY-NC-SA 4.0 license</li> <li>Legal Basis: Feist Publications v. Rural Telephone, 499 U.S. 340 (1991); 17 U.S.C. \u00a7 102(b)</li> </ul> <p>Format conversion utilities (document converters, media transcoders, data export tools) are routinely licensed independently from the content they process. This tool follows that established pattern.</p>"},{"location":"about/licensing/#content-attribution-and-compliance","title":"Content Attribution and Compliance","text":"<p>Users of this tool who access CIS Benchmarks content remain subject to CIS's terms of use.</p> <p>This tool:</p> <ul> <li>Requires users to authenticate with CIS WorkBench</li> <li>Does not redistribute CIS content</li> <li>Provides proper attribution to CIS</li> <li>Transforms data format only (no content modification)</li> <li>Links users to CIS terms of use</li> </ul> <p>See NOTICE.md for complete third-party acknowledgments.</p>"},{"location":"about/licensing/#third-party-content","title":"Third-Party Content","text":""},{"location":"about/licensing/#cis-benchmarks","title":"CIS Benchmarks","text":"<p>CIS Benchmarks are copyright \u00a9 Center for Internet Security, Inc. and licensed under CC BY-NC-SA 4.0.</p> <p>Terms of Use: https://workbench.cisecurity.org/terms-of-use</p>"},{"location":"about/licensing/#nist-and-disa-content","title":"NIST and DISA Content","text":"<p>NIST SP 800-53 security controls and DISA Security Technical Implementation Guides are U.S. Government works in the public domain.</p> <p>NIST: https://csrc.nist.gov DISA: https://public.cyber.mil/stigs/downloads</p>"},{"location":"about/licensing/#references","title":"References","text":"<ul> <li>Apache License 2.0: https://www.apache.org/licenses/LICENSE-2.0</li> <li>CIS Terms of Use: https://workbench.cisecurity.org/terms-of-use</li> <li>Feist Publications v. Rural Telephone, 499 U.S. 340 (1991)</li> <li>17 U.S.C. \u00a7 102(b) (Copyright protection does not extend to procedures, processes, systems, methods of operation)</li> </ul>"},{"location":"about/release-process/","title":"Release Process","text":"<p>This document describes the automated release process for CIS Benchmark CLI using Python Semantic Release.</p>"},{"location":"about/release-process/#overview","title":"Overview","text":"<p>The project uses python-semantic-release for fully automated releases, similar to Google's Release Please. Releases are triggered automatically when commits are merged to the main branch.</p>"},{"location":"about/release-process/#conventional-commits","title":"Conventional Commits","text":"<p>All commits must follow the Conventional Commits specification:</p> <pre><code>&lt;type&gt;: &lt;description&gt;\n\n[optional body]\n\n[optional footer]\n</code></pre>"},{"location":"about/release-process/#commit-types","title":"Commit Types","text":"<p>Version-bumping types:</p> <ul> <li><code>feat:</code> - New feature (triggers minor version bump: 1.0.0 \u2192 1.1.0)</li> <li><code>fix:</code> - Bug fix (triggers patch version bump: 1.0.0 \u2192 1.0.1)</li> <li><code>BREAKING CHANGE:</code> - Breaking change in footer (triggers major version bump: 1.0.0 \u2192 2.0.0)</li> </ul> <p>Non-version-bumping types:</p> <ul> <li><code>docs:</code> - Documentation changes</li> <li><code>chore:</code> - Maintenance tasks</li> <li><code>refactor:</code> - Code refactoring</li> <li><code>test:</code> - Test changes</li> <li><code>ci:</code> - CI/CD changes</li> </ul>"},{"location":"about/release-process/#examples","title":"Examples","text":"<pre><code># Patch release (1.0.0 \u2192 1.0.1)\ngit commit -m \"fix: resolve XCCDF namespace validation error\"\n\n# Minor release (1.0.0 \u2192 1.1.0)\ngit commit -m \"feat: add support for XCCDF 1.3 schema\"\n\n# Major release (1.0.0 \u2192 2.0.0)\ngit commit -m \"feat: redesign CLI command structure\n\nBREAKING CHANGE: removed --format flag, use subcommands instead\"\n\n# No release\ngit commit -m \"docs: update installation instructions\"\n</code></pre>"},{"location":"about/release-process/#automated-release-workflow","title":"Automated Release Workflow","text":"<p>When commits are pushed to <code>main</code>:</p> <ol> <li>Analyze Commits - python-semantic-release reads commit history since last release</li> <li>Determine Version - Calculates next version based on commit types</li> <li>Update Version - Updates <code>version</code> field in <code>pyproject.toml</code></li> <li>Generate Changelog - Creates/updates <code>CHANGELOG.md</code> with release notes</li> <li>Create Git Tag - Tags commit with version (e.g., <code>v1.0.0</code>)</li> <li>GitHub Release - Creates GitHub release with changelog</li> <li>Build Package - Builds wheel and sdist</li> <li>Publish to PyPI - Uploads to PyPI via trusted publisher (if release created)</li> </ol> <p>All of this happens automatically on merge to main.</p>"},{"location":"about/release-process/#release-types","title":"Release Types","text":""},{"location":"about/release-process/#patch-release-100-101","title":"Patch Release (1.0.0 \u2192 1.0.1)","text":"<p>Triggered by commits with types: <code>fix:</code>, <code>docs:</code>, <code>chore:</code>, <code>refactor:</code>, <code>test:</code>, <code>ci:</code></p> <pre><code>git commit -m \"fix: handle missing CIS Controls gracefully\"\ngit push origin main\n# Auto-releases v1.0.1\n</code></pre>"},{"location":"about/release-process/#minor-release-100-110","title":"Minor Release (1.0.0 \u2192 1.1.0)","text":"<p>Triggered by commits with type: <code>feat:</code></p> <pre><code>git commit -m \"feat: add catalog search by platform\"\ngit push origin main\n# Auto-releases v1.1.0\n</code></pre>"},{"location":"about/release-process/#major-release-100-200","title":"Major Release (1.0.0 \u2192 2.0.0)","text":"<p>Triggered by commits with <code>BREAKING CHANGE:</code> in footer:</p> <pre><code>git commit -m \"feat: restructure export command\n\nBREAKING CHANGE: --style flag now required for XCCDF exports\"\ngit push origin main\n# Auto-releases v2.0.0\n</code></pre>"},{"location":"about/release-process/#manual-release-emergency","title":"Manual Release (Emergency)","text":"<p>If automation fails or manual release is needed:</p> <pre><code># Install semantic-release\npip install python-semantic-release\n\n# Dry run (see what would happen)\nsemantic-release version --noop\n\n# Create release\nsemantic-release version\n\n# Publish to PyPI\nsemantic-release publish\n</code></pre>"},{"location":"about/release-process/#cicd-workflows","title":"CI/CD Workflows","text":""},{"location":"about/release-process/#ci-workflow-githubworkflowsciyml","title":"CI Workflow (.github/workflows/ci.yml)","text":"<p>Runs on every push and pull request:</p> <ul> <li>Test - Run pytest across Python 3.8-3.12</li> <li>Lint - Check code style (black, ruff)</li> <li>Security - Scan with bandit</li> </ul>"},{"location":"about/release-process/#documentation-workflow-githubworkflowsdocsyml","title":"Documentation Workflow (.github/workflows/docs.yml)","text":"<p>Deploys documentation to GitHub Pages:</p> <ul> <li>Triggered on changes to <code>docs/</code> or <code>mkdocs.yml</code></li> <li>Builds MkDocs site</li> <li>Publishes to gh-pages branch</li> </ul>"},{"location":"about/release-process/#release-workflow-githubworkflowsreleaseyml","title":"Release Workflow (.github/workflows/release.yml)","text":"<p>Automated releases on main branch:</p> <ul> <li>Analyzes commits since last release</li> <li>Bumps version if needed</li> <li>Creates GitHub release</li> <li>Publishes to PyPI via trusted publisher</li> </ul>"},{"location":"about/release-process/#pypi-trusted-publisher-setup","title":"PyPI Trusted Publisher Setup","text":"<p>One-time setup after creating the GitHub repository:</p> <ol> <li>Go to PyPI Publishing</li> <li>Add new pending publisher:</li> <li>PyPI Project Name: <code>cis-bench</code></li> <li>Owner: <code>mitre</code></li> <li>Repository: <code>cis-bench</code></li> <li>Workflow: <code>release.yml</code></li> <li>Environment: (leave blank)</li> <li>Save</li> </ol> <p>The workflow will automatically publish to PyPI using OIDC (no API tokens needed).</p>"},{"location":"about/release-process/#version-number-format","title":"Version Number Format","text":"<p>Versions follow Semantic Versioning:</p> <pre><code>MAJOR.MINOR.PATCH\n\n1.0.0 \u2192 Initial release\n1.0.1 \u2192 Patch (bug fixes)\n1.1.0 \u2192 Minor (new features, backward compatible)\n2.0.0 \u2192 Major (breaking changes)\n</code></pre>"},{"location":"about/release-process/#checking-current-version","title":"Checking Current Version","text":"<pre><code># In code\ncis-bench --version\n\n# From git\ngit describe --tags\n\n# From PyPI\npip show cis-bench\n</code></pre>"},{"location":"about/release-process/#troubleshooting","title":"Troubleshooting","text":"<p>No release created after merge:</p> <p>Check if commits use conventional format:</p> <pre><code>git log --oneline -10\n</code></pre> <p>Commits must start with <code>feat:</code>, <code>fix:</code>, etc.</p> <p>Release failed:</p> <ol> <li>Check workflow runs</li> <li>Verify PyPI trusted publisher is configured</li> <li>Check commit permissions in workflow</li> </ol> <p>Need to skip release:</p> <p>Use commit types that don't trigger releases:</p> <pre><code>git commit -m \"docs: update README\"  # Won't release\ngit commit -m \"chore: update dependencies\"  # Won't release\n</code></pre>"},{"location":"developer-guide/TESTING/","title":"Testing Guide","text":"<p>Documentation Path</p> <p>You are here: Developer Guide &gt; Testing</p> <ul> <li>For contributing: See Contributing Guide</li> <li>For architecture: See Architecture Overview</li> </ul>"},{"location":"developer-guide/TESTING/#test-environment-isolation","title":"Test Environment Isolation","text":"<p>This project uses environment-based configuration to ensure tests never pollute production or development data.</p>"},{"location":"developer-guide/TESTING/#environments","title":"Environments","text":"<p>Production (default): <pre><code># No environment variable set\ncis-bench catalog refresh\n# Uses: ~/.cis-bench/catalog.db\n</code></pre></p> <p>Development: <pre><code>export CIS_BENCH_ENV=dev\ncis-bench catalog refresh\n# Uses: ~/.cis-bench-dev/catalog.db\n</code></pre></p> <p>Test (automatic in pytest): <pre><code># Set automatically by pytest fixture\npytest tests/\n# Uses: /tmp/cis-bench-test/catalog.db\n</code></pre></p>"},{"location":"developer-guide/TESTING/#how-it-works","title":"How It Works","text":"<p>Config Module:</p> <ul> <li><code>src/cis_bench/config.py</code> provides environment-aware paths</li> <li>Checks <code>CIS_BENCH_ENV</code> environment variable</li> <li>Returns appropriate paths based on environment</li> </ul> <p>Pytest Fixture:</p> <ul> <li><code>tests/conftest.py</code> has <code>test_environment</code> fixture</li> <li><code>autouse=True</code> - applies to all tests automatically</li> <li><code>scope=\"session\"</code> - sets once at start</li> <li>Sets <code>CIS_BENCH_ENV=test</code> for entire test run</li> </ul> <p>Result:</p> <ul> <li>Tests use <code>/tmp/cis-bench-test/</code> (ephemeral)</li> <li>Dev work uses <code>~/.cis-bench-dev/</code> (isolated)</li> <li>Production uses <code>~/.cis-bench/</code> (safe)</li> </ul>"},{"location":"developer-guide/TESTING/#running-tests","title":"Running Tests","text":""},{"location":"developer-guide/TESTING/#full-test-suite","title":"Full Test Suite","text":"<pre><code>pytest tests/\n# 405 tests, uses test database automatically\n</code></pre>"},{"location":"developer-guide/TESTING/#specific-test-modules","title":"Specific Test Modules","text":"<pre><code>pytest tests/unit/test_catalog_database.py # Unit tests\npytest tests/integration/ # Integration tests\npytest tests/e2e/ # End-to-end CLI tests\n</code></pre>"},{"location":"developer-guide/TESTING/#with-coverage","title":"With Coverage","text":"<pre><code>pytest tests/ --cov=src/cis_bench --cov-report=html\nopen htmlcov/index.html\n</code></pre>"},{"location":"developer-guide/TESTING/#verbose-output","title":"Verbose Output","text":"<pre><code>pytest tests/ -v # Verbose test names\npytest tests/ -vv # Very verbose\npytest tests/ -s # Show print statements\n</code></pre>"},{"location":"developer-guide/TESTING/#test-organization","title":"Test Organization","text":""},{"location":"developer-guide/TESTING/#unit-tests-testsunit","title":"Unit Tests (<code>tests/unit/</code>)","text":"<ul> <li>Test individual functions/classes in isolation</li> <li>Use mocks for external dependencies</li> <li>Fast (run in &lt; 1 second each)</li> <li>Use <code>tmp_path</code> fixtures for temporary files/databases</li> </ul>"},{"location":"developer-guide/TESTING/#integration-tests-testsintegration","title":"Integration Tests (<code>tests/integration/</code>)","text":"<ul> <li>Test components working together</li> <li>May use real files/databases (in temp locations)</li> <li>Test exporters, fetchers, validators</li> </ul>"},{"location":"developer-guide/TESTING/#e2e-tests-testse2e","title":"E2E Tests (<code>tests/e2e/</code>)","text":"<ul> <li>Test complete workflows via CLI</li> <li>Use <code>CliRunner</code> to invoke commands</li> <li>Test user-facing behavior</li> <li>Still isolated (test environment)</li> </ul>"},{"location":"developer-guide/TESTING/#database-testing","title":"Database Testing","text":""},{"location":"developer-guide/TESTING/#temporary-databases","title":"Temporary Databases","text":"<p>Unit tests: <pre><code>@pytest.fixture\ndef temp_db(tmp_path):\n\"\"\"Create temporary catalog database.\"\"\"\ndb = CatalogDatabase(tmp_path / \"test.db\")\ndb.initialize_schema()\nreturn db\n</code></pre></p> <p>E2E tests:</p> <ul> <li>Automatically use <code>/tmp/cis-bench-test/catalog.db</code></li> <li>No manual setup needed</li> <li>Cleaned between test runs</li> </ul>"},{"location":"developer-guide/TESTING/#test-data-factories","title":"Test Data Factories","text":"<p>We use pytest fixtures (not factory_boy) for test data:</p> <pre><code>@pytest.fixture\ndef sample_benchmark_data():\nreturn {\n\"benchmark_id\": \"23598\",\n\"title\": \"CIS Ubuntu Linux 20.04\",\n# ...\n}\n</code></pre>"},{"location":"developer-guide/TESTING/#best-practices","title":"Best Practices","text":"<ol> <li>Never hardcode paths - Use fixtures or Config</li> <li>Use tmp_path - Pytest's built-in temp directory fixture</li> <li>Mock external APIs - Do not hit real CIS WorkBench in tests</li> <li>Test isolation - Each test independent</li> <li>Proper cleanup - Use fixtures with yield/cleanup</li> </ol>"},{"location":"developer-guide/TESTING/#writing-new-tests","title":"Writing New Tests","text":""},{"location":"developer-guide/TESTING/#example-unit-test","title":"Example Unit Test","text":"<pre><code>def test_database_operation(tmp_path):\n\"\"\"Test with isolated database.\"\"\"\ndb = CatalogDatabase(tmp_path / \"test.db\")\ndb.initialize_schema()\n\n# Test operation\ndb.insert_benchmark({...})\n\n# Verify\nresult = db.get_benchmark(\"123\")\nassert result is not None\n</code></pre>"},{"location":"developer-guide/TESTING/#example-e2e-test","title":"Example E2E Test","text":"<pre><code>def test_cli_command(runner):\n\"\"\"Test CLI command.\"\"\"\n# Environment already set to test\nresult = runner.invoke(cli, [\"catalog\", \"list\"])\n\n# Verify\nassert result.exit_code == 0\n</code></pre>"},{"location":"developer-guide/TESTING/#continuous-integration","title":"Continuous Integration","text":"<p>Tests run automatically on commit via pre-commit hooks:</p> <ul> <li><code>ruff</code> - Linting</li> <li><code>ruff-format</code> - Code formatting</li> <li><code>bandit</code> - Security checks</li> </ul> <p>Full test suite runs in CI/CD (when set up): <pre><code># .github/workflows/test.yml\n\n- name: Run tests\nrun: pytest tests/ --cov\n</code></pre></p>"},{"location":"developer-guide/TESTING/#test-coverage","title":"Test Coverage","text":"<p>Current coverage: 405 tests across:</p> <ul> <li>285 original tests (exporters, fetchers, models)</li> <li>41 catalog database tests</li> <li>12 catalog parser tests</li> <li>16 catalog scraper tests</li> <li>21 catalog search tests</li> <li>15 catalog downloader tests</li> <li>15 catalog e2e tests</li> </ul> <p>All tests pass with proper isolation.</p>"},{"location":"developer-guide/architecture/","title":"Architecture","text":"<p>Documentation Path</p> <p>You are here: Developer Guide &gt; Architecture Overview</p> <ul> <li>For detailed pipeline: See Data Flow Pipeline</li> <li>For MappingEngine: See MappingEngine User Guide</li> <li>For practical examples: See Workflows</li> </ul>"},{"location":"developer-guide/architecture/#system-overview","title":"System Overview","text":"<pre><code>graph TD\nA[User] --&gt;|CLI Commands| B[Click CLI]\nB --&gt; C[Download Command]\nB --&gt; D[Export Command]\nB --&gt; E[Catalog Command]\n\nC --&gt; F[WorkbenchScraper]\nF --&gt; G[CIS WorkBench]\nF --&gt; H[Pydantic Models]\nH --&gt; I[JSON Storage]\n\nI --&gt; D\nD --&gt; J[ExporterFactory]\nJ --&gt; K[Unified XCCDF Exporter]\nJ --&gt; L[CSV/JSON/YAML Exporters]\n\nK --&gt; M[MappingEngine]\nM --&gt; N[YAML Config]\nN --&gt; O[disa_style.yaml]\nN --&gt; P[cis_style.yaml]\n\nE --&gt; Q[Catalog Database]\nE --&gt; R[Catalog Scraper]\nR --&gt; G\nQ --&gt; S[SQLite + FTS5]</code></pre>"},{"location":"developer-guide/architecture/#core-components","title":"Core Components","text":""},{"location":"developer-guide/architecture/#cli-layer","title":"CLI Layer","text":"<p>Framework: Click Entry Point: <code>src/cis_bench/cli/app.py</code></p> <pre><code>graph LR\nA[cis-bench] --&gt; B[download]\nA --&gt; C[export]\nA --&gt; D[list]\nA --&gt; E[info]\nA --&gt; F[catalog]\n\nF --&gt; F1[refresh]\nF --&gt; F2[search]\nF --&gt; F3[download]\nF --&gt; F4[update]</code></pre> <p>Commands:</p> <ul> <li><code>download</code> - Fetch benchmarks from WorkBench</li> <li><code>export</code> - Convert to formats (JSON, YAML, CSV, MD, XCCDF)</li> <li><code>list</code> - Show downloaded benchmarks</li> <li><code>info</code> - Display benchmark details</li> <li><code>catalog</code> - Manage catalog (8 subcommands)</li> </ul>"},{"location":"developer-guide/architecture/#fetcher-layer","title":"Fetcher Layer","text":"<p>Purpose: Download and parse benchmarks from CIS WorkBench</p> <pre><code>graph TD\nA[WorkbenchScraper] --&gt; B[AuthManager]\nB --&gt; C[Browser Cookies]\nB --&gt; D[Cookie File]\n\nA --&gt; E[Strategy Pattern]\nE --&gt; F[v1_current Strategy]\nE --&gt; G[Future Strategies]\n\nA --&gt; H[HTMLParser]\nH --&gt; I[BeautifulSoup]\n\nA --&gt; J[Pydantic Models]\nJ --&gt; K[Benchmark]\nJ --&gt; L[Recommendation]</code></pre> <p>Components:</p> <ul> <li><code>WorkbenchScraper</code> - Main scraper class</li> <li><code>AuthManager</code> - Cookie extraction</li> <li><code>Strategy Pattern</code> - Adapts to HTML changes</li> <li><code>HTMLParser</code> - Extract data from HTML</li> </ul> <p>Output: Validated Pydantic models (19 fields per recommendation)</p>"},{"location":"developer-guide/architecture/#export-layer-config-driven-architecture","title":"Export Layer - Config-Driven Architecture","text":"<p>Key Innovation: ONE exporter class, multiple styles via YAML config</p> <pre><code>graph TD\nA[ExporterFactory] --&gt;|style=disa| B[XCCDFExporter]\nA --&gt;|style=cis| B\nA --&gt; C[JSONExporter]\nA --&gt; D[YAMLExporter]\nA --&gt; E[CSVExporter]\nA --&gt; F[MarkdownExporter]\n\nB --&gt; G[MappingEngine]\nG --&gt; H[disa_style.yaml]\nG --&gt; I[cis_style.yaml]\n\nG --&gt; J[Loop-Driven Mapping]\nJ --&gt; K[map_benchmark]\nJ --&gt; L[map_group]\nJ --&gt; M[map_rule]\n\nM --&gt; N[xsdata Models]\nN --&gt; O[XCCDF XML]</code></pre> <p>Factory Pattern: <pre><code># Create exporter with style parameter\nexporter = ExporterFactory.create(\"xccdf\", style=\"cis\")\n\n# Adding new style: just create YAML config\n# pci_dss_style.yaml -&gt; ExporterFactory.create(\"xccdf\", style=\"pci-dss\")\n</code></pre></p>"},{"location":"developer-guide/architecture/#mappingengine-the-heart-of-xccdf-export","title":"MappingEngine - The Heart of XCCDF Export","text":"<p>Config-Driven Transformation:</p> <pre><code>graph LR\nA[Pydantic Model] --&gt; B[MappingEngine]\nB --&gt; C[Load YAML Config]\nC --&gt; D[Field Mappings]\nC --&gt; E[Transformations]\nC --&gt; F[Type Specs]\n\nB --&gt; G[Loop Through Config]\nG --&gt; H[Apply Transforms]\nH --&gt; I[Build xsdata Objects]\n\nI --&gt; J[XCCDF XML]</code></pre> <p>Key Principle: Changes happen in YAML, not code</p> <p>Example - Adding a new field:</p> <pre><code># In cis_style.yaml\nfield_mappings:\nnew_field:\ntarget_element: \"custom-element\"\nsource_field: \"my_data\"\ntransform: \"html_to_markdown\"\n</code></pre> <p>No Python code changes needed!</p> <p>Loop-Driven Methods:</p> <ul> <li><code>map_rule()</code> - Loops through <code>field_mappings</code> config</li> <li><code>map_group()</code> - Loops through <code>group_elements</code> config</li> <li><code>map_benchmark()</code> - Loops through <code>benchmark</code> config</li> </ul>"},{"location":"developer-guide/architecture/#catalog-system","title":"Catalog System","text":"<p>Purpose: Browse and discover 1300+ CIS benchmarks</p> <pre><code>graph TD\nA[Catalog CLI] --&gt; B[CatalogSearch]\nA --&gt; C[CatalogScraper]\nA --&gt; D[CatalogDownloader]\n\nC --&gt; E[WorkBench HTML]\nC --&gt; F[CatalogParser]\nF --&gt; G[Extract Metadata]\n\nG --&gt; H[CatalogDatabase]\nH --&gt; I[SQLite]\nI --&gt; J[8 Tables - 3NF]\nI --&gt; K[FTS5 Search]\n\nB --&gt; H\nD --&gt; H\nD --&gt; L[WorkbenchScraper]\nL --&gt; M[Download Benchmark]\nM --&gt; H</code></pre> <p>Database Schema (3NF):</p> <ul> <li><code>platforms</code> - Operating System, Cloud, Database</li> <li><code>benchmark_statuses</code> - Published, Draft, Archived</li> <li><code>communities</code> - Development communities</li> <li><code>collections</code> - Categories/tags</li> <li><code>owners</code> - Authors</li> <li><code>catalog_benchmarks</code> - Main table with FKs</li> <li><code>downloaded_benchmarks</code> - Cached content</li> <li><code>scrape_metadata</code> - Tracking</li> </ul> <p>FTS5 Search:</p> <ul> <li>Fuzzy matching (\"ubunt\" finds \"ubuntu\")</li> <li>Multi-word search</li> <li>Ranked results (BM25)</li> <li>Fast (&lt;1ms for 1000+ records)</li> </ul>"},{"location":"developer-guide/architecture/#data-flow","title":"Data Flow","text":""},{"location":"developer-guide/architecture/#download-workflow","title":"Download Workflow","text":"<pre><code>sequenceDiagram\nUser-&gt;&gt;CLI: cis-bench download 23598\nCLI-&gt;&gt;AuthManager: Get cookies\nAuthManager-&gt;&gt;Browser: Extract cookies\nBrowser--&gt;&gt;AuthManager: Session cookies\nCLI-&gt;&gt;WorkbenchScraper: Fetch benchmark\nWorkbenchScraper-&gt;&gt;WorkBench: HTTP GET (authenticated)\nWorkBench--&gt;&gt;WorkbenchScraper: HTML\nWorkbenchScraper-&gt;&gt;HTMLParser: Parse HTML\nHTMLParser-&gt;&gt;Strategy: Extract fields\nStrategy--&gt;&gt;WorkbenchScraper: Data dict\nWorkbenchScraper-&gt;&gt;Pydantic: Validate\nPydantic--&gt;&gt;CLI: Benchmark object\nCLI-&gt;&gt;File: Save JSON</code></pre>"},{"location":"developer-guide/architecture/#export-workflow","title":"Export Workflow","text":"<pre><code>sequenceDiagram\nUser-&gt;&gt;CLI: cis-bench export --format xccdf --style cis\nCLI-&gt;&gt;ExporterFactory: create(\"xccdf\", style=\"cis\")\nExporterFactory--&gt;&gt;CLI: XCCDFExporter(cis)\nCLI-&gt;&gt;XCCDFExporter: export(benchmark)\nXCCDFExporter-&gt;&gt;MappingEngine: Load cis_style.yaml\nMappingEngine-&gt;&gt;Config: Read field_mappings\nMappingEngine-&gt;&gt;Loop: For each field in config\nLoop-&gt;&gt;Transform: Apply transformation\nTransform-&gt;&gt;xsdata: Build typed objects\nxsdata-&gt;&gt;XML: Serialize\nXCCDFExporter-&gt;&gt;PostProcessor: Inject metadata\nPostProcessor--&gt;&gt;XCCDFExporter: Final XML\nXCCDFExporter-&gt;&gt;File: Write XCCDF</code></pre>"},{"location":"developer-guide/architecture/#catalog-workflow","title":"Catalog Workflow","text":"<pre><code>sequenceDiagram\nUser-&gt;&gt;CLI: cis-bench catalog refresh\nCLI-&gt;&gt;CatalogScraper: scrape_full_catalog()\nCatalogScraper-&gt;&gt;WorkBench: GET page 1\nWorkBench--&gt;&gt;CatalogScraper: HTML\nCatalogScraper-&gt;&gt;Parser: parse_catalog_page()\nParser--&gt;&gt;CatalogScraper: List[benchmark_data]\nCatalogScraper-&gt;&gt;Database: insert_benchmark()\nDatabase-&gt;&gt;SQLite: INSERT + FTS5 update\nNote over CatalogScraper,SQLite: Repeat for 68 pages\nCatalogScraper--&gt;&gt;CLI: Stats\n\nUser-&gt;&gt;CLI: cis-bench catalog search \"ubuntu\"\nCLI-&gt;&gt;CatalogSearch: search()\nCatalogSearch-&gt;&gt;Database: FTS5 query\nDatabase-&gt;&gt;SQLite: SELECT with MATCH\nSQLite--&gt;&gt;Database: Ranked results\nDatabase--&gt;&gt;CLI: Benchmark list</code></pre>"},{"location":"developer-guide/architecture/#design-patterns","title":"Design Patterns","text":""},{"location":"developer-guide/architecture/#strategy-pattern-fetcher","title":"Strategy Pattern (Fetcher)","text":"<p>Problem: CIS WorkBench HTML changes over time</p> <p>Solution: Version-specific strategies</p> <pre><code>class StrategyDetector:\nstrategies = [\nv1_2025_10, # Current\nv1_2024_06, # Older\n]\n\ndef detect(html):\nfor strategy in strategies:\nif strategy.can_handle(html):\nreturn strategy\n</code></pre> <p>Adding new HTML format: 1. Create new strategy class 2. Register with detector 3. Old benchmarks still work</p>"},{"location":"developer-guide/architecture/#factory-pattern-exporters","title":"Factory Pattern (Exporters)","text":"<p>Problem: Multiple export formats</p> <p>Solution: Pluggable exporters</p> <pre><code>ExporterFactory.register(\"xccdf\", XCCDFExporter)\nExporterFactory.register(\"csv\", CSVExporter)\n\n# Create exporter\nexporter = ExporterFactory.create(\"xccdf\", style=\"cis\")\n</code></pre> <p>Adding new format: 1. Create exporter class 2. Register with factory 3. Available in CLI</p>"},{"location":"developer-guide/architecture/#config-driven-mapping-xccdf","title":"Config-Driven Mapping (XCCDF)","text":"<p>Problem: Multiple XCCDF styles with different structures</p> <p>Solution: YAML-based configuration</p> <pre><code># cis_style.yaml\nfield_mappings:\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\n\ncis_controls_metadata:\nstructure: \"official_cis_controls\"\nsource_logic: \"build_cis_controls\"\n</code></pre> <p>Adding new XCCDF style: 1. Create <code>style_name_style.yaml</code> 2. Define field mappings 3. Use: <code>--format xccdf --style style_name</code></p> <p>No code changes!</p>"},{"location":"developer-guide/architecture/#technology-stack","title":"Technology Stack","text":"<p>Core:</p> <ul> <li>Python 3.8+</li> <li>Click (CLI framework)</li> <li>Pydantic (data validation)</li> <li>SQLModel (database ORM)</li> </ul> <p>Scraping:</p> <ul> <li>requests (HTTP)</li> <li>BeautifulSoup4 (HTML parsing)</li> <li>browser-cookie3 (authentication)</li> </ul> <p>Export:</p> <ul> <li>xsdata (XCCDF models from XSD)</li> <li>lxml (XML processing)</li> <li>PyYAML (config files)</li> </ul> <p>Database:</p> <ul> <li>SQLite (catalog storage)</li> <li>SQLAlchemy (via SQLModel)</li> <li>FTS5 (full-text search)</li> </ul> <p>CLI/UX:</p> <ul> <li>Rich (formatting, progress bars)</li> <li>questionary (interactive prompts)</li> </ul> <p>Development:</p> <ul> <li>pytest (testing)</li> <li>ruff (linting/formatting)</li> <li>bandit (security)</li> <li>pre-commit (hooks)</li> <li>mkdocs-material (documentation)</li> </ul>"},{"location":"developer-guide/architecture/#file-organization","title":"File Organization","text":"<pre><code>src/cis_bench/\n\u251c\u2500\u2500 cli/ # Click commands\n\u2502 \u251c\u2500\u2500 app.py # Main CLI\n\u2502 \u2514\u2500\u2500 commands/ # Command modules\n\u251c\u2500\u2500 fetcher/ # WorkBench scraper\n\u2502 \u251c\u2500\u2500 workbench.py # Main scraper\n\u2502 \u251c\u2500\u2500 auth.py # Authentication\n\u2502 \u2514\u2500\u2500 strategies/ # HTML strategies\n\u251c\u2500\u2500 exporters/ # Format exporters\n\u2502 \u251c\u2500\u2500 base.py # Factory\n\u2502 \u251c\u2500\u2500 xccdf_unified_exporter.py # Config-driven XCCDF\n\u2502 \u251c\u2500\u2500 mapping_engine.py # YAML XCCDF\n\u2502 \u251c\u2500\u2500 configs/ # YAML configs\n\u2502 \u2514\u2500\u2500 [format]_exporter.py\n\u251c\u2500\u2500 catalog/ # Catalog system\n\u2502 \u251c\u2500\u2500 database.py # SQLModel database\n\u2502 \u251c\u2500\u2500 models.py # Database models\n\u2502 \u251c\u2500\u2500 scraper.py # Multi-page scraper\n\u2502 \u251c\u2500\u2500 parser.py # HTML parser\n\u2502 \u251c\u2500\u2500 search.py # Search/filter\n\u2502 \u2514\u2500\u2500 downloader.py # Smart download\n\u251c\u2500\u2500 models/ # Data models\n\u2502 \u251c\u2500\u2500 benchmark.py # Pydantic models\n\u2502 \u251c\u2500\u2500 cis_controls_official.py\n\u2502 \u251c\u2500\u2500 enhanced_metadata.py\n\u2502 \u2514\u2500\u2500 xccdf/ # xsdata generated\n\u251c\u2500\u2500 utils/ # Utilities\n\u2502 \u251c\u2500\u2500 xml_utils.py # XCCDF processing\n\u2502 \u251c\u2500\u2500 html_parser.py # HTML cleaning\n\u2502 \u251c\u2500\u2500 logging_config.py # Logging setup\n\u2502 \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 validators/ # XCCDF validators\n\u2514\u2500\u2500 config.py # Environment config\n</code></pre>"},{"location":"developer-guide/architecture/#configuration-system","title":"Configuration System","text":""},{"location":"developer-guide/architecture/#environment-based-config","title":"Environment-Based Config","text":"<pre><code>graph TD\nA[Config.py] --&gt; B{Environment?}\nB --&gt;|test| C[/tmp/cis-bench-test/]\nB --&gt;|dev| D[~/.cis-bench-dev/]\nB --&gt;|production| E[~/.cis-bench/]\n\nF[pytest] --&gt; G[Set CIS_BENCH_ENV=test]\nH[Developer] --&gt; I[export CIS_BENCH_ENV=dev]\nJ[User] --&gt; K[Default production]</code></pre> <p>Environment variable: <code>CIS_BENCH_ENV</code></p> <ul> <li><code>test</code> - Pytest (automatic)</li> <li><code>dev</code> - Development work</li> <li><code>production</code> - Default</li> </ul> <p>Optional .env file: <pre><code># ~/.cis-bench/.env\nCIS_BENCH_ENV=dev\nCIS_BENCH_SSL_VERIFY=false\n</code></pre></p> <p>Loaded automatically via python-dotenv.</p>"},{"location":"developer-guide/architecture/#yaml-mapping-system","title":"YAML Mapping System","text":""},{"location":"developer-guide/architecture/#how-styles-work","title":"How Styles Work","text":"<pre><code>graph LR\nA[Benchmark JSON] --&gt; B[MappingEngine]\nB --&gt; C{Load Config}\nC --&gt; D[disa_style.yaml]\nC --&gt; E[cis_style.yaml]\n\nD --&gt; F[Field Mappings]\nE --&gt; F\n\nF --&gt; G[Loop-Driven]\nG --&gt; H[For each field in config]\nH --&gt; I[Apply transform]\nI --&gt; J[Build xsdata object]\n\nJ --&gt; K[XCCDF XML]</code></pre>"},{"location":"developer-guide/architecture/#yaml-structure","title":"YAML Structure","text":"<pre><code># Style metadata\nmetadata:\nstyle_name: \"cis\"\nxccdf_version: \"1.2\"\n\n# Field mappings (loop-driven)\nfield_mappings:\n\n# Simple field\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\n\n# Complex nested structure\ncis_controls_metadata:\ntarget_element: \"metadata\"\nstructure: \"official_cis_controls\"\nsource_logic: \"build_cis_controls\"\n\n# Multiple values\nreference:\ntarget_element: \"reference\"\nmultiple: true\nstructure: \"dublin_core\"\nsource_field: \"nist_controls\"\n\n# Transformations\ntransformations:\nstrip_html:\nfunction: \"HTMLCleaner.strip_html\"\n\nhtml_to_markdown:\nfunction: \"HTMLCleaner.html_to_markdown\"\n</code></pre>"},{"location":"developer-guide/architecture/#structure-types","title":"Structure Types","text":"<p>Supported structures:</p> <ul> <li><code>simple</code> - Direct field mapping</li> <li><code>nested</code> - Parent with child elements</li> <li><code>dublin_core</code> - Reference with DC metadata</li> <li><code>official_cis_controls</code> - CIS Controls hierarchy</li> <li><code>enhanced_namespace</code> - Custom namespace metadata</li> <li><code>embedded_xml_tags</code> - VulnDiscussion style</li> </ul> <p>Adding new structure: 1. Define in YAML with <code>structure: \"new_type\"</code> 2. Add handler in MappingEngine 3. OR use existing structure types</p>"},{"location":"developer-guide/architecture/#database-schema","title":"Database Schema","text":""},{"location":"developer-guide/architecture/#catalog-database-sqlite","title":"Catalog Database (SQLite)","text":"<pre><code>erDiagram\ncatalog_benchmarks ||--o{ downloaded_benchmarks : has\ncatalog_benchmarks }o--|| platforms : belongs_to\ncatalog_benchmarks }o--|| benchmark_statuses : has\ncatalog_benchmarks }o--|| communities : belongs_to\ncatalog_benchmarks }o--|| owners : owned_by\ncatalog_benchmarks }o--o{ collections : has\n\ncatalog_benchmarks {\nstring benchmark_id PK\nstring title\nstring version\nint status_id FK\nint platform_id FK\nint community_id FK\nint owner_id FK\ndate published_date\nbool is_latest\n}\n\ndownloaded_benchmarks {\nstring benchmark_id PK\ntext content_json\nstring content_hash\nint recommendation_count\ndatetime downloaded_at\n}\n\nplatforms {\nint platform_id PK\nstring name\n}\n\nbenchmark_statuses {\nint status_id PK\nstring name\nbool is_active\n}</code></pre> <p>3NF Normalization:</p> <ul> <li>No data duplication</li> <li>Referential integrity via FKs</li> <li>Fast queries with indexes</li> </ul> <p>FTS5 Virtual Table: <pre><code>CREATE VIRTUAL TABLE benchmarks_fts USING fts5(\nbenchmark_id UNINDEXED,\ntitle,\nplatform,\ncommunity,\ndescription,\ntokenize='porter unicode61'\n);\n</code></pre></p> <p>Provides fuzzy full-text search.</p>"},{"location":"developer-guide/architecture/#extensibility-points","title":"Extensibility Points","text":""},{"location":"developer-guide/architecture/#adding-new-export-format","title":"Adding New Export Format","text":"<ol> <li> <p>Create exporter class: <pre><code>class NewFormatExporter(BaseExporter):\ndef export(self, benchmark, output_path):\n# Convert and write\npass\n</code></pre></p> </li> <li> <p>Register: <pre><code>ExporterFactory.register(\"newformat\", NewFormatExporter)\n</code></pre></p> </li> <li> <p>Use: <pre><code>cis-bench export benchmark.json --format newformat\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/architecture/#adding-new-xccdf-style","title":"Adding New XCCDF Style","text":"<ol> <li> <p>Create YAML config: <pre><code># custom_style.yaml\nmetadata:\nstyle_name: \"custom\"\nxccdf_version: \"1.2\"\n\nfield_mappings:\n# Define mappings\n</code></pre></p> </li> <li> <p>Use: <pre><code>cis-bench export benchmark.json --format xccdf --style custom\n</code></pre></p> </li> </ol> <p>No code changes needed!</p>"},{"location":"developer-guide/architecture/#adding-new-scraper-strategy","title":"Adding New Scraper Strategy","text":"<ol> <li> <p>Create strategy class: <pre><code>class V2Strategy(BaseStrategy):\ndef can_handle(self, html):\n# Detection logic\npass\n\ndef extract_fields(self, html):\n# Extraction logic\npass\n</code></pre></p> </li> <li> <p>Register with detector</p> </li> <li> <p>Automatically selected when HTML changes</p> </li> </ol>"},{"location":"developer-guide/architecture/#testing-architecture","title":"Testing Architecture","text":""},{"location":"developer-guide/architecture/#test-organization","title":"Test Organization","text":"<pre><code>tests/\n\u251c\u2500\u2500 unit/ # Fast, isolated tests\n\u251c\u2500\u2500 integration/ # Component integration tests\n\u2514\u2500\u2500 e2e/ # CLI command tests\n</code></pre>"},{"location":"developer-guide/architecture/#test-isolation","title":"Test Isolation","text":"<pre><code>graph TD\nA[pytest] --&gt; B[test_environment fixture]\nB --&gt; C[Set CIS_BENCH_ENV=test]\nC --&gt; D[Config.get_data_dir]\nD --&gt; E[/tmp/cis-bench-test/]\n\nF[Developer] --&gt; G[export CIS_BENCH_ENV=dev]\nG --&gt; D\nD --&gt; H[~/.cis-bench-dev/]\n\nI[Production] --&gt; J[No env var]\nJ --&gt; D\nD --&gt; K[~/.cis-bench/]</code></pre> <p>Automatic isolation:</p> <ul> <li>pytest sets <code>CIS_BENCH_ENV=test</code></li> <li>All tests use <code>/tmp/cis-bench-test/</code></li> <li>Production data never touched</li> </ul> <p>405 tests across all layers, all properly isolated.</p>"},{"location":"developer-guide/architecture/#see-also","title":"See Also","text":"<ul> <li>Mapping Engine Design - Detailed config system</li> <li>YAML Config Reference - Complete YAML syntax</li> <li>Data Model - Pydantic models</li> <li>Testing Guide - Testing best practices</li> </ul>"},{"location":"developer-guide/contributing/","title":"Contributing","text":"<p>Thank you for contributing to CIS Benchmark CLI!</p> <p>Documentation Path</p> <p>You are here: Developer Guide &gt; Contributing</p> <ul> <li>For architecture: See Architecture Overview</li> <li>For testing: See Testing Guide</li> <li>For data flow: See Data Flow Pipeline</li> </ul>"},{"location":"developer-guide/contributing/#development-setup","title":"Development Setup","text":""},{"location":"developer-guide/contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.8 or higher</li> <li>Git</li> </ul>"},{"location":"developer-guide/contributing/#setup","title":"Setup","text":"<pre><code># Clone repository\ngit clone https://github.com/mitre/cis-bench.git\ncd cis-benchmark-cli\n\n# Create virtual environment\npython3 -m venv venv\nsource venv/bin/activate\n\n# Install with dev dependencies\npip install -e \".[dev]\"\n\n# Install pre-commit hooks\npre-commit install\n\n# Verify setup\npytest tests/\n</code></pre>"},{"location":"developer-guide/contributing/#code-quality-standards","title":"Code Quality Standards","text":""},{"location":"developer-guide/contributing/#we-do-not-commit-broken-code","title":"WE DO NOT COMMIT BROKEN CODE","text":"<p>Before ANY commit:</p> <ul> <li>All tests must pass</li> <li>All linting must pass</li> <li>No ruff errors</li> <li>No bandit security issues</li> </ul> <pre><code># Run before committing\npytest tests/\nruff check --fix .\nruff format .\n</code></pre> <p>Pre-commit hooks enforce this automatically.</p>"},{"location":"developer-guide/contributing/#testing-requirements","title":"Testing Requirements","text":""},{"location":"developer-guide/contributing/#write-tests-for-all-code","title":"Write Tests for ALL Code","text":"<p>Coverage required:</p> <ul> <li>Unit tests for functions/classes</li> <li>Integration tests for components</li> <li>E2E tests for CLI commands</li> </ul> <p>Test file naming: <pre><code>src/cis_bench/catalog/database.py\ntests/unit/test_catalog_database.py\n</code></pre></p>"},{"location":"developer-guide/contributing/#test-isolation","title":"Test Isolation","text":"<p>All tests must use isolated databases:</p> <ul> <li>Unit tests: <code>tmp_path</code> fixtures</li> <li>E2E tests: <code>CIS_BENCH_ENV=test</code> (automatic)</li> <li>NO touching production data</li> </ul> <p>See: Testing Guide</p>"},{"location":"developer-guide/contributing/#architecture-principles","title":"Architecture Principles","text":""},{"location":"developer-guide/contributing/#1-config-driven-not-hardcoded","title":"1. Config-Driven, Not Hardcoded","text":"<p>DO: <pre><code># In YAML config\nfield_mappings:\nnew_field:\ntarget_element: \"element\"\nsource_field: \"field\"\n</code></pre></p> <p>DON'T: <pre><code># Hardcoded field list\nif field_name == \"new_field\":\n...\n</code></pre></p>"},{"location":"developer-guide/contributing/#2-loop-through-config","title":"2. Loop Through Config","text":"<p>DO: <pre><code>for field_name, mapping in config.field_mappings.items():\n# Process field\n</code></pre></p> <p>DON'T: <pre><code># Manually list fields\nprocess_field(\"title\")\nprocess_field(\"description\")\n...\n</code></pre></p>"},{"location":"developer-guide/contributing/#3-no-direct-xccdf-imports","title":"3. No Direct XCCDF Imports","text":"<p>DO: <pre><code>FieldType = self.get_xccdf_class(\"IdentType\")\n</code></pre></p> <p>DON'T: <pre><code>from cis_bench.models.xccdf.xccdf_1_2 import IdentType\n</code></pre></p> <p>Why: Version-agnostic (supports XCCDF 1.1.4 and 1.2).</p>"},{"location":"developer-guide/contributing/#adding-features","title":"Adding Features","text":""},{"location":"developer-guide/contributing/#adding-new-export-format","title":"Adding New Export Format","text":"<p>Example: Add PDF export</p> <ol> <li> <p>Create exporter: <pre><code># src/cis_bench/exporters/pdf_exporter.py\nclass PDFExporter(BaseExporter):\ndef export(self, benchmark, output_path):\n# Generate PDF\npass\n\ndef format_name(self):\nreturn \"PDF\"\n\ndef get_file_extension(self):\nreturn \"pdf\"\n\nExporterFactory.register(\"pdf\", PDFExporter)\n</code></pre></p> </li> <li> <p>Add to <code>__init__.py</code>: <pre><code>from . import pdf_exporter\n</code></pre></p> </li> <li> <p>Write tests: <pre><code># tests/unit/test_pdf_exporter.py\ndef test_pdf_export():\nexporter = ExporterFactory.create(\"pdf\")\nexporter.export(benchmark, \"output.pdf\")\nassert Path(\"output.pdf\").exists()\n</code></pre></p> </li> <li> <p>Use: <pre><code>cis-bench export benchmark.json --format pdf\n</code></pre></p> </li> </ol>"},{"location":"developer-guide/contributing/#adding-new-xccdf-style","title":"Adding New XCCDF Style","text":"<p>See: How to Add XCCDF Style</p> <p>Summary: 1. Create <code>{style}_style.yaml</code> in configs/ 2. Define field mappings 3. No code changes needed!</p>"},{"location":"developer-guide/contributing/#coding-standards","title":"Coding Standards","text":""},{"location":"developer-guide/contributing/#python-style","title":"Python Style","text":"<ul> <li>PEP 8 compliance (enforced by ruff)</li> <li>Type hints where helpful</li> <li>Docstrings for all public functions/classes</li> <li>Descriptive names (no abbreviations)</li> </ul>"},{"location":"developer-guide/contributing/#documentation","title":"Documentation","text":"<ul> <li>Docstrings: Google style</li> <li>Comments: Explain WHY, not WHAT</li> <li>TODOs: Include issue number</li> </ul>"},{"location":"developer-guide/contributing/#commit-messages","title":"Commit Messages","text":"<p>Format: <pre><code>type: Short description\n\nLonger explanation if needed.\n\n- Bullet points for changes\n- Reference issues: #123\n\nAuthored by: Your Name &lt;email@example.com&gt;\n</code></pre></p> <p>Types:</p> <ul> <li><code>feat:</code> New feature</li> <li><code>fix:</code> Bug fix</li> <li><code>docs:</code> Documentation</li> <li><code>test:</code> Tests</li> <li><code>refactor:</code> Code restructuring</li> <li><code>chore:</code> Maintenance</li> </ul>"},{"location":"developer-guide/contributing/#git-workflow","title":"Git Workflow","text":""},{"location":"developer-guide/contributing/#branch-strategy","title":"Branch Strategy","text":"<ul> <li><code>main</code> - Production-ready code</li> <li>Feature branches for new work</li> </ul>"},{"location":"developer-guide/contributing/#commit-rules","title":"Commit Rules","text":"<p>ONE CHANGE PER COMMIT:</p> <ul> <li>Do not mix features</li> <li>Separate logical changes</li> <li>Each commit should build</li> </ul> <p>NEVER:</p> <ul> <li><code>git add .</code> or <code>git add -A</code></li> <li>Commit without testing</li> <li>Commit broken code</li> </ul> <p>ALWAYS: <pre><code># Add files specifically\ngit add file1.py file2.py\n\n# Run tests first\npytest tests/\n\n# Then commit\ngit commit -m \"feat: Add specific feature\"\n</code></pre></p>"},{"location":"developer-guide/contributing/#code-review","title":"Code Review","text":""},{"location":"developer-guide/contributing/#before-submitting-pr","title":"Before Submitting PR","text":"<ul> <li>[ ] All tests pass (405+)</li> <li>[ ] Ruff linting passes</li> <li>[ ] Bandit security scan passes</li> <li>[ ] Documentation updated</li> <li>[ ] Commit messages clear</li> <li>[ ] No debug code left</li> <li>[ ] Reviewed own changes</li> </ul>"},{"location":"developer-guide/contributing/#pr-description","title":"PR Description","text":"<p>Include:</p> <ul> <li>What changed</li> <li>Why it changed</li> <li>How to test</li> <li>Related issues</li> </ul>"},{"location":"developer-guide/contributing/#architecture-compliance","title":"Architecture Compliance","text":""},{"location":"developer-guide/contributing/#tests-enforce-architecture","title":"Tests Enforce Architecture","text":"<p>Architecture compliance tests will FAIL if you:</p> <ul> <li>Hardcode field lists instead of looping config</li> <li>Import XCCDF models directly</li> <li>Add hardcoded field checks (<code>if field_name == \"title\"</code>)</li> </ul> <p>See: <code>tests/unit/test_architecture_compliance.py</code></p>"},{"location":"developer-guide/contributing/#design-documents","title":"Design Documents","text":"<p>Follow the design:</p> <ul> <li>Read design docs before implementing</li> <li>Do not improvise or \"improve\"</li> <li>If design is wrong, update design FIRST, then code</li> </ul>"},{"location":"developer-guide/contributing/#development-environment","title":"Development Environment","text":""},{"location":"developer-guide/contributing/#recommended-setup","title":"Recommended Setup","text":"<pre><code># Use dev environment\nexport CIS_BENCH_ENV=dev\n\n# Your work goes to ~/.cis-bench-dev/\n# Production stays clean\n</code></pre>"},{"location":"developer-guide/contributing/#running-tests","title":"Running Tests","text":"<pre><code># All tests\npytest tests/\n\n# Specific module\npytest tests/unit/test_catalog_database.py\n\n# With coverage\npytest tests/ --cov=src/cis_bench\n\n# Verbose\npytest tests/ -v\n</code></pre>"},{"location":"developer-guide/contributing/#release-process","title":"Release Process","text":"<p>(When maintainer releases):</p> <ol> <li>Update version in <code>pyproject.toml</code></li> <li>Update CHANGELOG.md</li> <li>Run full test suite</li> <li>Tag release: <code>git tag v1.0.0</code></li> <li>Build: <code>python -m build</code></li> <li>Publish: <code>twine upload dist/*</code></li> </ol>"},{"location":"developer-guide/contributing/#getting-help","title":"Getting Help","text":""},{"location":"developer-guide/contributing/#documentation_1","title":"Documentation","text":"<ul> <li>Read existing docs in <code>docs/</code></li> <li>Check architecture diagrams</li> <li>Review YAML config reference</li> </ul>"},{"location":"developer-guide/contributing/#ask-questions","title":"Ask Questions","text":"<ul> <li>GitHub Discussions</li> <li>Issues (for bugs)</li> </ul>"},{"location":"developer-guide/contributing/#code-of-conduct","title":"Code of Conduct","text":"<p>Be professional, respectful, and collaborative.</p>"},{"location":"developer-guide/contributing/#see-also","title":"See Also","text":"<ul> <li>Architecture - System design</li> <li>Testing Guide - Test practices</li> <li>How to Add XCCDF Style - Extension guide</li> </ul>"},{"location":"developer-guide/data-flow-pipeline/","title":"Data Flow Pipeline","text":"<p>Complete transformation pipeline from CIS WorkBench HTML to NIST XCCDF XML</p> <p>New to these terms?</p> <p>See the Glossary for definitions of technical terms used in this guide (Strategy, Pydantic, xsdata, MappingEngine, etc.)</p>"},{"location":"developer-guide/data-flow-pipeline/#overview","title":"Overview","text":"<p>This document explains the complete end-to-end data transformation that happens when you run:</p> <pre><code>cis-bench download 23598\ncis-bench export 23598 --format xccdf --style cis\n</code></pre> <p>The Journey: <pre><code>graph LR\nA[CIS WorkBench&lt;br/&gt;HTML] --&gt; B[WorkbenchScraper&lt;br/&gt;+ Strategy]\nB --&gt; C[Pydantic Models&lt;br/&gt;19 fields]\nC --&gt; D[MappingEngine&lt;br/&gt;+ YAML Config]\nD --&gt; E[xsdata Models&lt;br/&gt;XCCDF objects]\nE --&gt; F[XML Serialization]\nF --&gt; G[NIST XCCDF&lt;br/&gt;Output]\n\nstyle A fill:#f9f,stroke:#333\nstyle G fill:#9f9,stroke:#333\nstyle D fill:#ff9,stroke:#333</code></pre></p> <p>Each stage performs specific transformations, validates data, and handles errors. Let's trace through each step with real data.</p>"},{"location":"developer-guide/data-flow-pipeline/#stage-1-html-extraction","title":"Stage 1: HTML Extraction","text":"<p>Input: CIS WorkBench benchmark page HTML Component: <code>WorkbenchScraper</code> + <code>ScraperStrategy</code> Output: Python dictionaries with extracted data</p>"},{"location":"developer-guide/data-flow-pipeline/#how-it-works","title":"How It Works","text":"<p>When you run <code>cis-bench download 23598</code>, the system:</p> <ol> <li>Authenticates using saved session from <code>~/.cis-bench/session.cookies</code></li> <li>Fetches HTML from <code>https://workbench.cisecurity.org/benchmarks/23598</code></li> <li>Detects HTML version using <code>StrategyDetector</code></li> <li>Applies strategy (currently <code>v1_current.py</code>) to parse HTML</li> <li>Extracts 19 fields per recommendation</li> </ol>"},{"location":"developer-guide/data-flow-pipeline/#strategy-pattern","title":"Strategy Pattern","text":"<pre><code># src/cis_bench/fetcher/strategies/v1_current.py\n\nclass V1CurrentStrategy(ScraperStrategy):\ndef extract_recommendation(self, html_section):\n\"\"\"Extract single recommendation from HTML.\"\"\"\nreturn {\n'ref': self._extract_ref(html_section),\n'title': self._extract_title(html_section),\n'description': self._extract_description(html_section),\n'rationale': self._extract_rationale(html_section),\n# ... 15 more fields\n}\n</code></pre> <p>Why Strategy Pattern? CIS WorkBench updates HTML structure periodically. When this happens: 1. Create new strategy class (e.g., <code>v2_january2026.py</code>) 2. Detector auto-selects based on HTML structure 3. Old benchmarks still work with old strategy 4. No changes to core scraper code</p>"},{"location":"developer-guide/data-flow-pipeline/#example-extracting-cis-controls","title":"Example: Extracting CIS Controls","text":"<p>HTML Input: <pre><code>&lt;div class=\"cis-controls\"&gt;\n&lt;strong&gt;CIS Controls v8:&lt;/strong&gt;\n&lt;ul&gt;\n&lt;li&gt;4.1 - Establish and Maintain a Secure Configuration Process (IG1)&lt;/li&gt;\n&lt;li&gt;4.8 - Uninstall or Disable Unnecessary Services (IG2)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n</code></pre></p> <p>Extraction Logic: <pre><code>def _extract_cis_controls(self, section):\ncontrols_div = section.find('div', class_='cis-controls')\ncontrols = []\nfor li in controls_div.find_all('li'):\ntext = li.get_text()\n# Parse: \"4.1 - Title (IG1)\" {id: \"4.1\", title: \"...\", ig: \"IG1\"}\ncontrols.append(parse_control(text))\nreturn controls\n</code></pre></p> <p>Python Output: <pre><code>{\n'cis_controls': [\n{'id': '4.1', 'title': '...', 'ig': 'IG1'},\n{'id': '4.8', 'title': '...', 'ig': 'IG2'}\n]\n}\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#all-19-extracted-fields","title":"All 19 Extracted Fields","text":"Field Source Transformation ref Title heading Extract number title Title heading Strip HTML, clean url Recommendation URL Construct from ID description Description section Parse HTML, preserve structure rationale Rationale section Parse HTML impact Impact statement Parse HTML audit Audit procedure Parse code blocks remediation Remediation section Parse code blocks default_value Default value section Parse text additional_info Additional info Parse HTML references External references Extract links assessment_status Assessment badge Extract text (Automated/Manual) profiles Profile tags Parse badges (Level 1/2, Server/Workstation) cis_controls CIS Controls v8 section Parse list structured data mitre_mapping MITRE section Parse techniques, tactics, mitigations nist_controls NIST section Parse control IDs artifacts Audit scripts Extract code blocks scored Scoring badge Boolean tags Metadata tags Extract keywords"},{"location":"developer-guide/data-flow-pipeline/#stage-2-pydantic-validation","title":"Stage 2: Pydantic Validation","text":"<p>Input: Python dictionaries from scraper Component: <code>Benchmark</code> and <code>Recommendation</code> Pydantic models Output: Validated, typed Python objects</p>"},{"location":"developer-guide/data-flow-pipeline/#validation-layer","title":"Validation Layer","text":"<pre><code># src/cis_bench/models/benchmark.py\n\nclass Recommendation(BaseModel):\n\"\"\"Single CIS recommendation with validation.\"\"\"\n\nref: str = Field(..., description=\"Recommendation number (e.g., 1.1.1)\")\ntitle: str = Field(..., min_length=1, description=\"Title\")\nurl: HttpUrl = Field(..., description=\"WorkBench URL\")\nassessment_status: Optional[str] = Field(None, pattern=\"^(Automated|Manual)$\")\nprofiles: List[str] = Field(default_factory=list)\n\n# Content fields\ndescription: Optional[str] = None\nrationale: Optional[str] = None\naudit: Optional[str] = None\nremediation: Optional[str] = None\n\n# Compliance mappings (structured)\ncis_controls: List[Dict[str, Any]] = Field(default_factory=list)\nmitre_mapping: Optional[Dict[str, Any]] = None\nnist_controls: List[str] = Field(default_factory=list)\n\n@field_validator('ref')\n@classmethod\ndef validate_ref_format(cls, v):\n\"\"\"Ensure ref matches CIS numbering (e.g., 1.1.1).\"\"\"\nif not re.match(r'^\\d+(\\.\\d+)*$', v):\nraise ValueError(f\"Invalid ref format: {v}\")\nreturn v\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#what-validation-catches","title":"What Validation Catches","text":"<p>Before Pydantic: <pre><code>{\n'ref': '1.1.1 (extra text)', # Invalid format\n'title': '', # Empty\n'url': 'not-a-url', # Invalid URL\n'assessment_status': 'Auto' # Should be \"Automated\"\n}\n</code></pre></p> <p>After Pydantic (validated): <pre><code>Recommendation(\nref='1.1.1', # Validated format\ntitle='Ensure mounting of cramfs...', # Required, non-empty\nurl=HttpUrl('https://...'), # Validated URL\nassessment_status='Automated', # Enum validated\nprofiles=['Level 1 - Server'], # Structured list\ncis_controls=[{...}], # Structured data\nmitre_mapping={...} # Validated dict\n)\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#why-pydantic","title":"Why Pydantic?","text":"<ol> <li>Type safety - Catch data quality issues early</li> <li>Validation - Ensures fields meet requirements</li> <li>Serialization - Easy JSON export</li> <li>Documentation - Schema auto-generated</li> <li>IDE support - Autocomplete, type hints</li> </ol>"},{"location":"developer-guide/data-flow-pipeline/#stage-3-configuration-driven-mapping","title":"Stage 3: Configuration-Driven Mapping","text":"<p>Input: Pydantic <code>Recommendation</code> objects Component: <code>MappingEngine</code> + YAML configuration files Output: xsdata XCCDF objects (not yet serialized)</p>"},{"location":"developer-guide/data-flow-pipeline/#the-mappingengine","title":"The MappingEngine","text":"<pre><code>graph TD\nA[Pydantic Recommendation] --&gt; B[MappingEngine]\nC[YAML Config&lt;br/&gt;disa_style.yaml] --&gt; B\nB --&gt; D[Loop through&lt;br/&gt;field_mappings]\nD --&gt; E{Field Type?}\nE --&gt;|simple| F[Simple Field&lt;br/&gt;Strategy]\nE --&gt;|composite| G[Composite Field&lt;br/&gt;Strategy]\nE --&gt;|list| H[List Field&lt;br/&gt;Strategy]\nF --&gt; I[xsdata Rule object]\nG --&gt; I\nH --&gt; I\nI --&gt; J[Return Rule]\n\nstyle B fill:#ff9,stroke:#333\nstyle C fill:#9ff,stroke:#333</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#how-configuration-works","title":"How Configuration Works","text":"<p>YAML Configuration (disa_style.yaml): <pre><code>field_mappings:\n# Simple field mapping\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\nxccdf_type: \"TextType\"\n\n# Composite field mapping\ndescription:\ntarget_element: \"description\"\nstructure: \"embedded_xml_tags\"\ncomponents:\n\n- tag: \"VulnDiscussion\"\nsources:\n\n- field: \"description\"\ntransform: \"strip_html\"\n\n- field: \"rationale\"\ntransform: \"strip_html\"\nseparator: \"\\n\\n\"\n\n- tag: \"FalsePositives\"\nsources:\n\n- field: \"additional_info\"\ntransform: \"strip_html\"\nxccdf_type: \"HtmlTextWithSubType\"\n\n# List field with CCI lookup\nident:\ntarget_element: \"ident\"\nstructure: \"list\"\ncci_lookup:\nsource_field: \"nist_controls\"\nextract: \"primary\" # or \"all\"\nsystem_uri: \"http://cyber.mil/cci\"\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#mapping-process-step-by-step","title":"Mapping Process (Step-by-Step)","text":"<p>Step 1: Load Configuration <pre><code>config = load_yaml_config('disa_style.yaml')\nengine = MappingEngine(config)\n</code></pre></p> <p>Step 2: Loop Through Field Mappings <pre><code>for field_name, field_config in config['field_mappings'].items():\nstrategy = FieldMappingStrategy.create(field_config)\nvalue = strategy.apply(recommendation, field_config)\nxccdf_rule[field_name] = value\n</code></pre></p> <p>Step 3: Apply Transformations <pre><code># Transform: \"strip_html\"\ninput: \"&lt;p&gt;Disable &lt;code&gt;cramfs&lt;/code&gt; filesystem&lt;/p&gt;\"\noutput: \"Disable cramfs filesystem\"\n\n# Transform: \"strip_html_keep_code\"\ninput: \"&lt;p&gt;Run: &lt;code&gt;modprobe -n -v cramfs&lt;/code&gt;&lt;/p&gt;\"\noutput: \"Run: `modprobe -n -v cramfs`\"\n\n# Transform: \"safe_field\"\ninput: recommendation.get('rationale') # Might be None\noutput: \"\" if None else cleaned_value\n</code></pre></p> <p>Step 4: Build xsdata Objects <pre><code>from cis_bench.models.xccdf_v1_1 import Rule, IdentType, FixText\n\nrule = Rule(\nid=f\"xccdf_rule_{recommendation.ref}\",\ntitle=TextType(value=title_value),\ndescription=HtmlTextWithSubType(value=description_html),\nident=[\nIdentType(value=\"CCI-000001\", system=\"http://cyber.mil/cci\"),\nIdentType(value=\"CCI-000002\", system=\"http://cyber.mil/cci\")\n],\nfix=FixText(value=remediation_text, fixref=f\"F-{ref}\")\n)\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#real-example-mapping-recommendation-111","title":"Real Example: Mapping Recommendation 1.1.1","text":"<p>Input (Pydantic): <pre><code>Recommendation(\nref=\"1.1.1\",\ntitle=\"Ensure mounting of cramfs filesystems is disabled\",\ndescription=\"&lt;p&gt;The &lt;code&gt;cramfs&lt;/code&gt; filesystem type is...&lt;/p&gt;\",\nrationale=\"&lt;p&gt;Removing support for unneeded filesystem types...&lt;/p&gt;\",\nremediation=\"&lt;pre&gt;modprobe -n -v cramfs&lt;/pre&gt;\",\nnist_controls=[\"CM-7\", \"CM-7(1)\"],\ncis_controls=[\n{\"id\": \"4.8\", \"title\": \"Uninstall or Disable...\", \"ig\": \"IG2\"}\n]\n)\n</code></pre></p> <p>YAML Config: <pre><code>description:\nstructure: \"embedded_xml_tags\"\ncomponents:\n\n- tag: \"VulnDiscussion\"\nsources:\n\n- field: \"description\"\n- field: \"rationale\"\n</code></pre></p> <p>MappingEngine Process: <pre><code># 1. Find 'description' mapping in config\nconfig = field_mappings['description']\n\n# 2. Determine structure type\nstructure = config['structure'] # \"embedded_xml_tags\"\n\n# 3. Apply CompositeFieldStrategy\nstrategy = CompositeFieldStrategy()\n\n# 4. Build components\nfor component in config['components']:\ntag = component['tag'] # \"VulnDiscussion\"\ncontent_parts = []\n\nfor source in component['sources']:\nfield = source['field'] # \"description\"\nvalue = getattr(recommendation, field)\ntransformed = apply_transform(value, source.get('transform'))\ncontent_parts.append(transformed)\n\ncontent = separator.join(content_parts)\nxml_content += f\"&lt;{tag}&gt;{content}&lt;/{tag}&gt;\"\n\n# 5. Create xsdata object\ndescription = HtmlTextWithSubType(value=xml_content)\n</code></pre></p> <p>Output (xsdata XCCDF): <pre><code>Rule(\ndescription=HtmlTextWithSubType(\nvalue=\"&lt;VulnDiscussion&gt;The cramfs filesystem type is a compressed \"\n\"read-only Linux filesystem...\\n\\n\"\n\"Removing support for unneeded filesystem types reduces \"\n\"the attack surface...&lt;/VulnDiscussion&gt;\"\n)\n)\n</code></pre></p> <p>Final XML: <pre><code>&lt;Rule id=\"xccdf_rule_1_1_1\"&gt;\n&lt;title&gt;Ensure mounting of cramfs filesystems is disabled&lt;/title&gt;\n&lt;description&gt;\n&lt;VulnDiscussion&gt;The cramfs filesystem type is a compressed read-only Linux filesystem...\n\nRemoving support for unneeded filesystem types reduces the attack surface...&lt;/VulnDiscussion&gt;\n&lt;/description&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000366&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000778&lt;/ident&gt;\n&lt;fix fixref=\"F-1_1_1\"&gt;modprobe -n -v cramfs&lt;/fix&gt;\n&lt;/Rule&gt;\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#stage-4-cci-lookup-and-deduplication","title":"Stage 4: CCI Lookup and Deduplication","text":"<p>Input: NIST control IDs (e.g., [\"CM-7\", \"CM-7(1)\"]) Component: <code>CCILookupService</code> Output: Deduplicated CCI identifiers</p>"},{"location":"developer-guide/data-flow-pipeline/#cci-mapping","title":"CCI Mapping","text":"<p>CIS recommendations reference NIST controls (CM-7, AC-2, etc.). For DISA STIG compatibility, we need CCIs (Control Correlation Identifiers).</p> <p>Process: <pre><code># Input\nnist_controls = [\"CM-7\", \"CM-7(1)\"]\n\n# Lookup\ncci_service = CCILookupService()\nccis = cci_service.get_ccis_for_nist_controls(\nnist_controls,\nextract=\"primary\" # or \"all\"\n)\n\n# Output\nccis = [\n\"CCI-000381\", # CM-7.1 - Configure for essential capabilities\n\"CCI-000382\" # CM-7.3 - Prohibit unauthorized functions\n]\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#deduplication-logic","title":"Deduplication Logic","text":"<p>Problem: CM-7 and CM-7(1) might map to same CCIs</p> <p>Solution: <pre><code>def deduplicate_nist_controls(nist_controls, extract=\"all\"):\n\"\"\"Deduplicate CCIs across multiple NIST controls.\"\"\"\n\nall_ccis = []\nseen_ccis = set()\n\nfor nist_id in nist_controls:\nccis = lookup_ccis(nist_id, extract=extract)\nfor cci in ccis:\nif cci not in seen_ccis:\nall_ccis.append(cci)\nseen_ccis.add(cci)\n\nreturn all_ccis\n</code></pre></p> <p>Result:</p> <ul> <li>Input: [\"CM-7\", \"CM-7(1)\", \"CM-7(2)\"] 18 CCIs total</li> <li>After dedup: 3 primary CCIs (no duplicates)</li> </ul>"},{"location":"developer-guide/data-flow-pipeline/#primary-vs-supporting-ccis","title":"Primary vs Supporting CCIs","text":"<p>Configuration: <pre><code>ident:\ncci_lookup:\nextract: \"primary\" # Only primary CCI per NIST control\n</code></pre></p> <p>Result:</p> <ul> <li><code>extract: \"primary\"</code> 1-3 CCIs per recommendation (DISA preference)</li> <li><code>extract: \"all\"</code> 6-20 CCIs per recommendation (comprehensive)</li> </ul>"},{"location":"developer-guide/data-flow-pipeline/#stage-5-xsdata-model-generation","title":"Stage 5: xsdata Model Generation","text":"<p>Input: MappingEngine output (field values) Component: xsdata-generated Python classes Output: Typed XCCDF object graph</p>"},{"location":"developer-guide/data-flow-pipeline/#what-is-xsdata","title":"What is xsdata?","text":"<p>xsdata generates Python classes from XSD schemas. For XCCDF:</p> <pre><code># Generate models from NIST XCCDF schema\nxsdata schemas/xccdf_1.2.xsd --package models.xccdf\n</code></pre> <p>Result: <pre><code># src/cis_bench/models/xccdf/__init__.py (auto-generated)\n\nclass Benchmark:\nid: str\ntitle: TextType\ndescription: HtmlTextWithSubType\nversion: VersionType\nprofile: List[Profile]\ngroup: List[Group]\n# ... 20+ more fields\n\nclass Rule:\nid: str\ntitle: TextType\ndescription: HtmlTextWithSubType\nident: List[IdentType]\ncheck: Optional[Check]\nfix: Optional[FixText]\n# ... more fields\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#why-xsdata-models","title":"Why xsdata Models?","text":"<ol> <li>Schema compliance - Generated from official NIST XSD</li> <li>Type safety - Python types match XML schema types</li> <li>Validation - Invalid structure caught before serialization</li> <li>Autocomplete - IDE knows XCCDF structure</li> <li>Version management - Different models for XCCDF 1.1.4 vs 1.2</li> </ol>"},{"location":"developer-guide/data-flow-pipeline/#two-xccdf-versions","title":"Two XCCDF Versions","text":"<p>XCCDF 1.1.4 (DISA STIG): <pre><code>from cis_bench.models.xccdf_v1_1 import Benchmark, Rule\n# Older schema, STIG-compatible\n</code></pre></p> <p>XCCDF 1.2 (CIS Native): <pre><code>from cis_bench.models.xccdf import Benchmark, Rule\n# Latest schema, more features\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#object-graph-construction","title":"Object Graph Construction","text":"<p>MappingEngine builds complete object graph:</p> <pre><code>benchmark = Benchmark(\nid=\"xccdf_benchmark_23598\",\ntitle=TextType(value=\"CIS AlmaLinux OS 10 Benchmark\"),\nversion=VersionType(value=\"1.0.0\"),\ngroup=[\nGroup(\nid=\"xccdf_group_1\",\ntitle=TextType(value=\"Initial Setup\"),\nrule=[\nRule(id=\"xccdf_rule_1_1_1\", ...),\nRule(id=\"xccdf_rule_1_1_2\", ...)\n]\n),\nGroup(id=\"xccdf_group_2\", ...)\n]\n)\n</code></pre> <p>Graph Structure: <pre><code>Benchmark\n\u251c\u2500\u2500 Metadata (title, version, description)\n\u251c\u2500\u2500 Profile[] (Level 1, Level 2)\n\u251c\u2500\u2500 Group[] (sections)\n\u2502 \u251c\u2500\u2500 Group.title\n\u2502 \u2514\u2500\u2500 Group.rule[]\n\u2502 \u251c\u2500\u2500 Rule.id\n\u2502 \u251c\u2500\u2500 Rule.title\n\u2502 \u251c\u2500\u2500 Rule.description\n\u2502 \u251c\u2500\u2500 Rule.ident[] (CCIs)\n\u2502 \u251c\u2500\u2500 Rule.check\n\u2502 \u2514\u2500\u2500 Rule.fix\n\u2514\u2500\u2500 References\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#stage-6-xml-serialization","title":"Stage 6: XML Serialization","text":"<p>Input: xsdata <code>Benchmark</code> object Component: xsdata XML serializer Output: Valid NIST XCCDF XML</p>"},{"location":"developer-guide/data-flow-pipeline/#serialization-process","title":"Serialization Process","text":"<pre><code>from xsdata.formats.dataclass.serializers import XmlSerializer\nfrom xsdata.formats.dataclass.serializers.config import SerializerConfig\n\n# Configure serializer\nconfig = SerializerConfig(\npretty_print=True,\nxml_declaration=True,\nencoding=\"UTF-8\"\n)\n\nserializer = XmlSerializer(config=config)\n\n# Serialize Benchmark object to XML\nxml_string = serializer.render(\nbenchmark,\nns_map={\nNone: \"http://checklists.nist.gov/xccdf/1.2\",\n\"dc\": \"http://purl.org/dc/elements/1.1/\",\n\"xhtml\": \"http://www.w3.org/1999/xhtml\"\n}\n)\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#namespace-handling","title":"Namespace Handling","text":"<p>XCCDF requires multiple namespaces: <pre><code>&lt;Benchmark\nxmlns=\"http://checklists.nist.gov/xccdf/1.2\"\nxmlns:dc=\"http://purl.org/dc/elements/1.1/\"\nxmlns:xhtml=\"http://www.w3.org/1999/xhtml\"\nxmlns:controls=\"http://cisecurity.org/xccdf/controls/1.0\"\nxmlns:mitre=\"http://cisecurity.org/xccdf/mitre/1.0\"&gt;\n</code></pre></p> <p>Namespace Purpose:</p> <ul> <li><code>xccdf</code> (default) - Core XCCDF elements</li> <li><code>dc</code> - Dublin Core metadata (title, publisher, source)</li> <li><code>xhtml</code> - HTML content in descriptions</li> <li><code>controls</code> - CIS Controls v8 (custom namespace)</li> <li><code>mitre</code> - MITRE ATT&amp;CK (custom namespace)</li> </ul>"},{"location":"developer-guide/data-flow-pipeline/#post-processing","title":"Post-Processing","text":"<p>xsdata sometimes generates incorrect namespace prefixes. We fix this:</p> <pre><code># src/cis_bench/utils/xml_utils.py\n\ndef fix_xccdf_namespaces(xml_string):\n\"\"\"Fix namespace issues in xsdata output.\"\"\"\n\n# Problem: xsdata adds ns0: prefix to custom namespaces\n# &lt;ns0:cis_control&gt;4.8&lt;/ns0:cis_control&gt;\n\n# Fix: Replace with proper prefix\nxml_string = xml_string.replace('ns0:cis_', 'controls:')\nxml_string = xml_string.replace('ns0:mitre_', 'mitre:')\n\nreturn xml_string\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#complete-pipeline-example","title":"Complete Pipeline Example","text":"<p>Let's trace a single recommendation through the entire pipeline:</p>"},{"location":"developer-guide/data-flow-pipeline/#input-html-from-cis-workbench","title":"Input: HTML from CIS WorkBench","text":"<pre><code>&lt;div class=\"recommendation\" id=\"rec-1-1-1\"&gt;\n&lt;h3&gt;1.1.1 Ensure mounting of cramfs filesystems is disabled&lt;/h3&gt;\n&lt;div class=\"assessment-status\"&gt;\n&lt;span class=\"badge badge-success\"&gt;Automated&lt;/span&gt;\n&lt;/div&gt;\n&lt;div class=\"description\"&gt;\n&lt;p&gt;The &lt;code&gt;cramfs&lt;/code&gt; filesystem type is a compressed read-only\nLinux filesystem embedded in small footprint systems...&lt;/p&gt;\n&lt;/div&gt;\n&lt;div class=\"rationale\"&gt;\n&lt;p&gt;Removing support for unneeded filesystem types reduces the local\nattack surface of the system.&lt;/p&gt;\n&lt;/div&gt;\n&lt;div class=\"nist-controls\"&gt;\n&lt;strong&gt;NIST Controls:&lt;/strong&gt; CM-7, CM-7(1)\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#stage-1-output-python-dictionary","title":"Stage 1 Output: Python Dictionary","text":"<pre><code>{\n'ref': '1.1.1',\n'title': 'Ensure mounting of cramfs filesystems is disabled',\n'description': '&lt;p&gt;The &lt;code&gt;cramfs&lt;/code&gt; filesystem type is...&lt;/p&gt;',\n'rationale': '&lt;p&gt;Removing support for unneeded filesystem types...&lt;/p&gt;',\n'assessment_status': 'Automated',\n'nist_controls': ['CM-7', 'CM-7(1)']\n}\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#stage-2-output-pydantic-model","title":"Stage 2 Output: Pydantic Model","text":"<pre><code>Recommendation(\nref='1.1.1',\ntitle='Ensure mounting of cramfs filesystems is disabled',\ndescription='&lt;p&gt;The &lt;code&gt;cramfs&lt;/code&gt; filesystem type is...&lt;/p&gt;',\nrationale='&lt;p&gt;Removing support for unneeded filesystem types...&lt;/p&gt;',\nassessment_status='Automated',\nnist_controls=['CM-7', 'CM-7(1)']\n)\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#stage-3-output-mapped-values","title":"Stage 3 Output: Mapped Values","text":"<pre><code># MappingEngine applies transformations\ntitle_value = \"Ensure mounting of cramfs filesystems is disabled\" # strip_html\n\ndescription_html = \"\"\"&lt;VulnDiscussion&gt;The cramfs filesystem type is a compressed read-only Linux filesystem...\n\nRemoving support for unneeded filesystem types reduces the local attack surface...&lt;/VulnDiscussion&gt;\"\"\"\n\nccis = [\"CCI-000381\", \"CCI-000366\"] # From CM-7 lookup, deduplicated\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#stage-4-output-xsdata-objects","title":"Stage 4 Output: xsdata Objects","text":"<pre><code>Rule(\nid=\"xccdf_rule_1_1_1\",\ntitle=TextType(value=\"Ensure mounting of cramfs filesystems is disabled\"),\ndescription=HtmlTextWithSubType(\nvalue=\"&lt;VulnDiscussion&gt;The cramfs filesystem type is...&lt;/VulnDiscussion&gt;\"\n),\nident=[\nIdentType(value=\"CCI-000381\", system=\"http://cyber.mil/cci\"),\nIdentType(value=\"CCI-000366\", system=\"http://cyber.mil/cci\")\n],\nseverity=\"medium\",\nweight=Decimal(\"10.0\")\n)\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#stage-5-output-xml","title":"Stage 5 Output: XML","text":"<pre><code>&lt;Rule id=\"xccdf_rule_1_1_1\" severity=\"medium\" weight=\"10.0\"&gt;\n&lt;title&gt;Ensure mounting of cramfs filesystems is disabled&lt;/title&gt;\n&lt;description&gt;\n&lt;VulnDiscussion&gt;The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image.\n\nRemoving support for unneeded filesystem types reduces the local attack surface of the system.&lt;/VulnDiscussion&gt;\n&lt;/description&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000381&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000366&lt;/ident&gt;\n&lt;fix fixref=\"F-1_1_1\"&gt;\n&lt;xhtml:pre&gt;modprobe -n -v cramfs&lt;/xhtml:pre&gt;\n&lt;/fix&gt;\n&lt;/Rule&gt;\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#error-handling-at-each-stage","title":"Error Handling at Each Stage","text":""},{"location":"developer-guide/data-flow-pipeline/#stage-1-html-extraction_1","title":"Stage 1: HTML Extraction","text":"<p>Error: HTML structure changed <pre><code>StrategyDetector: No matching strategy found\n Raises ScraperError with HTML sample\n User creates new strategy or reports issue\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#stage-2-pydantic-validation_1","title":"Stage 2: Pydantic Validation","text":"<p>Error: Invalid data format <pre><code>ValidationError: ref='1.1.1 (extra)' doesn't match pattern\n Shows field, value, expected format\n Scraper strategy needs fix\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#stage-3-mapping-engine","title":"Stage 3: Mapping Engine","text":"<p>Error: Missing source field <pre><code>KeyError: 'rationale' not in recommendation\n Config references non-existent field\n Use safe_field transform or fix config\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#stage-4-xsdata-construction","title":"Stage 4: xsdata Construction","text":"<p>Error: Invalid XCCDF structure <pre><code>TypeError: Rule.title expects TextType, got str\n MappingEngine must wrap in proper type\n Check field_mappings xccdf_type\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#stage-5-xml-serialization","title":"Stage 5: XML Serialization","text":"<p>Error: Namespace issue <pre><code>Namespace prefix 'ns0' not declared\n Post-processing fixes namespace prefixes\n Check xml_utils.fix_xccdf_namespaces()\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#configuration-files-drive-everything","title":"Configuration Files Drive Everything","text":""},{"location":"developer-guide/data-flow-pipeline/#available-xccdf-styles","title":"Available XCCDF Styles","text":"<p>DISA STIG Style (<code>disa_style.yaml</code>):</p> <ul> <li>XCCDF 1.1.4</li> <li>VulnDiscussion embedded XML tags</li> <li>CCI ident elements</li> <li>Severity ratings</li> <li>Minimal metadata</li> </ul> <p>CIS Native Style (<code>cis_style.yaml</code>):</p> <ul> <li>XCCDF 1.2</li> <li>Full CIS Controls metadata</li> <li>MITRE ATT&amp;CK mappings</li> <li>Enhanced namespace fields</li> <li>Rich metadata</li> </ul> <p>Base Configuration (<code>base_style.yaml</code>):</p> <ul> <li>Common namespaces</li> <li>Shared transformations</li> <li>Reusable field mappings</li> <li>Both styles extend this</li> </ul>"},{"location":"developer-guide/data-flow-pipeline/#creating-a-new-style","title":"Creating a New Style","text":"<p>To create <code>custom_style.yaml</code>:</p> <pre><code># Inherit base\nextends: base_style.yaml\n\nmetadata:\nstyle_name: \"custom\"\nxccdf_version: \"1.2\"\n\n# Override field mappings\nfield_mappings:\ntitle:\nsource_field: \"title\"\ntransform: \"uppercase\" # Custom transform\nxccdf_type: \"TextType\"\n\n# Add custom metadata\nmetadata:\ntarget_element: \"metadata\"\ncustom_fields:\n\n- name: \"organization\"\nvalue: \"My Company\"\n\n- name: \"custom_id\"\nsource_field: \"ref\"\ntransform: \"prefix_org\"\n</code></pre> <p>Register in exporter: <pre><code># src/cis_bench/exporters/xccdf_unified_exporter.py\n\nSUPPORTED_STYLES = {\n'disa': 'configs/disa_style.yaml',\n'cis': 'configs/cis_style.yaml',\n'custom': 'configs/custom_style.yaml' # Add this\n}\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#performance-and-optimization","title":"Performance and Optimization","text":""},{"location":"developer-guide/data-flow-pipeline/#caching-at-each-stage","title":"Caching at Each Stage","text":"<p>Stage 1 (HTML):</p> <ul> <li>Benchmark HTML stored in database after download</li> <li>Re-export skips re-download</li> </ul> <p>Stage 2 (Pydantic):</p> <ul> <li>JSON stored in <code>downloaded_benchmarks</code> table</li> <li>Instant re-parse for different exports</li> </ul> <p>Stage 3-5 (Export):</p> <ul> <li>No caching (fast enough ~2 seconds per benchmark)</li> <li>MappingEngine + xsdata are in-memory operations</li> </ul>"},{"location":"developer-guide/data-flow-pipeline/#parallel-processing","title":"Parallel Processing","text":"<p>Only catalog scraping uses parallelism:</p> <ul> <li>10 pages per batch</li> <li>5 concurrent threads</li> <li>~2 minutes for 1,300+ benchmarks</li> </ul> <p>Individual benchmark processing is sequential (fast enough).</p>"},{"location":"developer-guide/data-flow-pipeline/#validation-and-quality-assurance","title":"Validation and Quality Assurance","text":""},{"location":"developer-guide/data-flow-pipeline/#validation-points","title":"Validation Points","text":"<ol> <li>HTML Structure - StrategyDetector validates</li> <li>Field Extraction - Pydantic validates</li> <li>XCCDF Structure - xsdata validates</li> <li>XML Schema - Optional xmllint validation</li> <li>DISA Conventions - DisaValidator checks STIG requirements</li> </ol>"},{"location":"developer-guide/data-flow-pipeline/#quality-checks","title":"Quality Checks","text":"<pre><code># After export, validate\ncis-bench export 23598 --format xccdf --style disa -o output.xml\n\n# Validate with xmllint (if installed)\nxmllint --schema schemas/xccdf-1.1.4.xsd output.xml\n\n# Check DISA conventions\npython -c \"from cis_bench.validators.disa_conventions import validate; validate('output.xml')\"\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#code-references","title":"Code References","text":"<p>Key Files:</p> Stage File Lines HTML Extraction <code>src/cis_bench/fetcher/workbench.py</code> 200+ Strategy <code>src/cis_bench/fetcher/strategies/v1_current.py</code> 180+ Pydantic Models <code>src/cis_bench/models/benchmark.py</code> 150+ Mapping Engine <code>src/cis_bench/exporters/mapping_engine.py</code> 400+ CCI Lookup <code>src/cis_bench/utils/cci_lookup.py</code> 200+ xsdata Models <code>src/cis_bench/models/xccdf/</code> Auto-generated XML Utils <code>src/cis_bench/utils/xml_utils.py</code> 100+ YAML Configs <code>src/cis_bench/exporters/configs/</code> 3 files"},{"location":"developer-guide/data-flow-pipeline/#testing-the-pipeline","title":"Testing the Pipeline","text":""},{"location":"developer-guide/data-flow-pipeline/#unit-tests","title":"Unit Tests","text":"<p>Each stage has isolated tests:</p> <pre><code># Stage 1: HTML parsing\npytest tests/unit/test_strategies.py\n\n# Stage 2: Pydantic validation\npytest tests/unit/test_models_and_validators.py\n\n# Stage 3: MappingEngine\npytest tests/unit/test_mapping_engine.py\n\n# Stage 4: CCI lookup\npytest tests/unit/test_cci_lookup.py\n\n# Stage 5: xsdata serialization\npytest tests/integration/test_xccdf_export.py\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#integration-tests","title":"Integration Tests","text":"<p>Complete pipeline tests:</p> <pre><code># DISA XCCDF export\npytest tests/integration/test_disa_xccdf.py\n\n# CIS XCCDF export\npytest tests/integration/test_cis_xccdf.py\n\n# Both styles\npytest tests/integration/ -k xccdf\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#end-to-end-tests","title":"End-to-End Tests","text":"<pre><code># Full CLI workflow\npytest tests/e2e/test_cli_commands.py::test_download_and_export_xccdf\n</code></pre>"},{"location":"developer-guide/data-flow-pipeline/#debugging-the-pipeline","title":"Debugging the Pipeline","text":""},{"location":"developer-guide/data-flow-pipeline/#enable-verbose-logging","title":"Enable Verbose Logging","text":"<pre><code>cis-bench --verbose export 23598 --format xccdf --style cis\n</code></pre> <p>Logs show: 1. Loading configuration 2. Applying field mappings 3. Transformation applied to each field 4. CCI lookups 5. xsdata object construction 6. XML serialization</p>"},{"location":"developer-guide/data-flow-pipeline/#common-debug-scenarios","title":"Common Debug Scenarios","text":"<p>\"Field not found in Pydantic model\" <pre><code>ERROR: KeyError: 'custom_field'\n Check: Does scraper extract this field?\n Check: Is it in Recommendation model?\n Fix: Add to scraper or remove from config\n</code></pre></p> <p>\"Invalid XCCDF structure\" <pre><code>ERROR: Rule.title expects TextType, got str\n Check: field_mappings xccdf_type\n Fix: Ensure MappingEngine wraps in correct type\n</code></pre></p> <p>\"Namespace prefix not found\" <pre><code>ERROR: Namespace prefix 'ns0' not declared\n Check: xml_utils.fix_xccdf_namespaces() ran?\n Fix: Update namespace fixing regex\n</code></pre></p>"},{"location":"developer-guide/data-flow-pipeline/#summary","title":"Summary","text":"<p>The CIS Benchmark CLI data pipeline is:</p> <ol> <li>Modular - Each stage independent, testable</li> <li>Config-driven - YAML defines transformations, not code</li> <li>Validated - Multiple validation layers</li> <li>Extensible - Strategy and Factory patterns</li> <li>Maintainable - Changes isolated to appropriate layer</li> </ol> <p>When HTML changes Update strategy (Stage 1) When XCCDF requirements change Update YAML config (Stage 3) When adding metadata Update Pydantic models (Stage 2) + config (Stage 3)</p> <p>The pipeline ensures separation of concerns - scraping, validation, transformation, and serialization are independent stages that can evolve separately.</p>"},{"location":"developer-guide/data-flow-pipeline/#related-documentation","title":"Related Documentation","text":"<ul> <li>Architecture Overview - System design patterns</li> <li>Mapping Engine Design - Detailed internals</li> <li>YAML Config Reference - Configuration syntax</li> <li>XCCDF Styles - DISA vs CIS comparison</li> <li>How to Add XCCDF Style - Step-by-step guide</li> </ul>"},{"location":"developer-guide/how-to-add-xccdf-style/","title":"How to Add a New XCCDF Style","text":"<p>Adding a new XCCDF style is 95% configuration, 5% code!</p> <p>Create YAML config \u2192 Add CLI option \u2192 Test \u2192 Validate \u2192 Done.</p> <p>Documentation Path</p> <p>You are here: Developer Guide &gt; How To Add XCCDF Style</p> <ul> <li>For MappingEngine: See MappingEngine User Guide</li> <li>For YAML syntax: See YAML Config Reference</li> <li>For examples: See Workflows</li> </ul>"},{"location":"developer-guide/how-to-add-xccdf-style/#overview","title":"Overview","text":"<p>The CIS WorkBench CLI uses a configuration-driven architecture for XCCDF exports. Adding a new style means creating a YAML file that tells the MappingEngine how to transform your Pydantic data models into XCCDF XML.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#what-you-get-for-free","title":"What You Get For Free","text":"<p>When you add a new XCCDF style:</p> <ul> <li>JSON export: Works automatically (raw Pydantic data)</li> <li>YAML export: Works automatically (raw Pydantic data)</li> <li>CSV export: Works automatically (raw Pydantic data)</li> <li>Markdown export: Works automatically (raw Pydantic data)</li> <li>XCCDF export: Uses your YAML configuration</li> </ul> <p>Only XCCDF uses style configs - other formats export the Pydantic models directly.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#whats-automated-vs-manual","title":"What's Automated vs Manual","text":"<p>The system handles automatically:</p> <ul> <li>Loading and parsing your YAML config</li> <li>Applying field mappings you define</li> <li>Executing transformations (strip_html, html_to_markdown, etc.)</li> <li>Generating XCCDF models using xsdata</li> <li>XML serialization with proper namespaces</li> </ul> <p>You provide:</p> <ul> <li>YAML configuration file with field mappings (main work)</li> <li>One line of CLI code to register the style option</li> <li>Tests for the new style</li> <li>Documentation</li> </ul>"},{"location":"developer-guide/how-to-add-xccdf-style/#step-1-create-yaml-configuration","title":"Step 1: Create YAML Configuration","text":"<p>Create <code>src/cis_bench/exporters/configs/pci_dss_style.yaml</code>:</p> <pre><code># PCI-DSS XCCDF Export Configuration\nmetadata:\n  style_name: \"pci-dss\"\n  description: \"PCI-DSS compliant XCCDF export\"\n  xccdf_version: \"1.2\"  # Use \"1.1.4\" for DISA/DoD compatibility\n  target_tools:\n    - \"PCI Compliance Tools\"\n    - \"OpenSCAP\"\n\n# Namespaces (required for XCCDF)\nnamespaces:\n  default: \"http://checklists.nist.gov/xccdf/1.2\"\n  xccdf: \"http://checklists.nist.gov/xccdf/1.2\"\n  dc: \"http://purl.org/dc/elements/1.1/\"\n  pci: \"http://pci-dss.org/xccdf/1.0\"  # Your custom namespace\n\n# Benchmark-level configuration\nbenchmark:\n  id_template: \"xccdf_pci_dss_{platform}\"\n  title:\n    source: \"title\"\n    transform: \"none\"\n  version:\n    source: \"version\"\n\n# Default values for Rule elements\nrule_defaults:\n  severity: \"high\"  # PCI-DSS is strict by default\n  weight: \"10.0\"\n  selected: \"true\"\n\n# Field mappings: YAML tells the engine what to do\nfield_mappings:\n  # Basic text fields\n  title:\n    target_element: \"title\"\n    source_field: \"title\"\n    transform: \"strip_html\"\n\n  description:\n    target_element: \"description\"\n    source_field: \"description\"\n    transform: \"html_to_markdown\"\n\n  # Reuse existing CIS Controls structure\n  cis_controls:\n    structure: \"official_cis_controls\"\n    namespace: \"http://cisecurity.org/controls\"\n    source_field: \"cis_controls\"\n</code></pre> <p>The configuration is the implementation. The MappingEngine reads this YAML and executes the transformations automatically.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#step-2-add-cli-option-one-line-of-code","title":"Step 2: Add CLI Option (One Line of Code)","text":"<p>Edit <code>src/cis_bench/cli/commands/export.py</code>:</p> <pre><code>@click.option(\n    \"--style\",\n    type=click.Choice([\"disa\", \"cis\", \"pci-dss\"]),  # Add your style here\n    default=\"disa\",\n    help=\"XCCDF export style (only for --format xccdf)\"\n)\n</code></pre> <p>That's the only Python code change needed.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#step-3-test-the-new-style","title":"Step 3: Test the New Style","text":""},{"location":"developer-guide/how-to-add-xccdf-style/#manual-testing","title":"Manual Testing","text":"<pre><code># Export using your new style\ncis-bench export benchmark.json --format xccdf --style pci-dss\n\n# Check the output exists\nls -lh output.xml\n</code></pre>"},{"location":"developer-guide/how-to-add-xccdf-style/#step-4-xsd-validation-critical","title":"Step 4: XSD Validation (CRITICAL)","text":"<p>Always validate your XCCDF output against the official NIST schema.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#for-xccdf-12-modern-standard","title":"For XCCDF 1.2 (Modern Standard)","text":"<pre><code># Validate against XCCDF 1.2 schema\nxmllint --schema schemas/xccdf_1.2.xsd --noout output.xml\n</code></pre> <p>Success looks like: <pre><code>output.xml validates\n</code></pre></p> <p>Failure looks like: <pre><code>output.xml:42: element description: Schemas validity error : Element\n'{http://checklists.nist.gov/xccdf/1.2}description': This element is\nnot expected. Expected is ( {http://checklists.nist.gov/xccdf/1.2}title ).\n</code></pre></p>"},{"location":"developer-guide/how-to-add-xccdf-style/#for-xccdf-114-disadod-compatibility","title":"For XCCDF 1.1.4 (DISA/DoD Compatibility)","text":"<pre><code># Validate against XCCDF 1.1.4 schema\nxmllint --schema schemas/xccdf-1.1.4.xsd --noout output.xml\n</code></pre>"},{"location":"developer-guide/how-to-add-xccdf-style/#when-to-use-which-schema","title":"When to Use Which Schema","text":"<ul> <li>XCCDF 1.2: Modern standard, supports more features</li> <li>Use for: CIS native, OpenSCAP, modern tools</li> <li> <p>Config: <code>xccdf_version: \"1.2\"</code></p> </li> <li> <p>XCCDF 1.1.4: Legacy standard, DISA STIG requirement</p> </li> <li>Use for: DoD/DISA compliance, STIG compatibility</li> <li>Config: <code>xccdf_version: \"1.1.4\"</code></li> </ul>"},{"location":"developer-guide/how-to-add-xccdf-style/#add-xsd-validation-to-tests","title":"Add XSD Validation to Tests","text":"<pre><code>import subprocess\n\ndef test_pci_dss_xsd_validation(sample_benchmark, tmp_path):\n    \"\"\"Verify output validates against XCCDF 1.2 schema.\"\"\"\n    output_file = tmp_path / \"pci_dss_validation.xml\"\n    exporter = ExporterFactory.create(\"xccdf\", style=\"pci-dss\")\n    exporter.export(sample_benchmark, output_file)\n\n    # Run xmllint validation\n    result = subprocess.run(\n        [\"xmllint\", \"--schema\", \"schemas/xccdf_1.2.xsd\", \"--noout\", str(output_file)],\n        capture_output=True,\n        text=True\n    )\n\n    assert result.returncode == 0, f\"XSD validation failed:\\n{result.stderr}\"\n</code></pre> <p>XSD validation is mandatory before releasing a new style.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#best-practices","title":"Best Practices","text":""},{"location":"developer-guide/how-to-add-xccdf-style/#1-copy-an-existing-style-first","title":"1. Copy an Existing Style First","text":"<p>Do not start from scratch. Copy a similar style:</p> <pre><code># For modern XCCDF 1.2\ncp src/cis_bench/exporters/configs/cis_style.yaml \\\n   src/cis_bench/exporters/configs/pci_dss_style.yaml\n\n# For DISA/DoD XCCDF 1.1.4\ncp src/cis_bench/exporters/configs/disa_style.yaml \\\n   src/cis_bench/exporters/configs/banking_style.yaml\n</code></pre> <p>Then modify incrementally.</p>"},{"location":"developer-guide/how-to-add-xccdf-style/#2-test-incrementally","title":"2. Test Incrementally","text":"<p>Add fields one at a time:</p> <pre><code># Add title field, test\ncis-bench export benchmark.json --format xccdf --style pci-dss\nxmllint --schema schemas/xccdf_1.2.xsd --noout output.xml\n\n# Add description, test again\n# Add metadata, test again\n</code></pre>"},{"location":"developer-guide/how-to-add-xccdf-style/#3-reuse-structures","title":"3. Reuse Structures","text":"<p>The system provides proven structures:</p> <pre><code>cis_controls:\n  structure: \"official_cis_controls\"  # Reuses proven structure\n  source_field: \"cis_controls\"\n</code></pre>"},{"location":"developer-guide/how-to-add-xccdf-style/#4-always-validate-output","title":"4. Always Validate Output","text":"<p>Before committing:</p> <pre><code># XSD validation (must pass)\nxmllint --schema schemas/xccdf_1.2.xsd --noout output.xml\n\n# Visual inspection\nxmllint --format output.xml | less\n\n# Test with target tool (if available)\noscap xccdf validate output.xml\n</code></pre>"},{"location":"developer-guide/how-to-add-xccdf-style/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/how-to-add-xccdf-style/#xsd-validation-errors","title":"XSD Validation Errors","text":"<p>Common issues:</p> <ul> <li>Wrong namespace URIs</li> <li>Elements in wrong order (XCCDF is order-sensitive)</li> <li>Missing required attributes</li> <li>XCCDF version mismatch (1.2 vs 1.1.4)</li> </ul> <p>Fix:</p> <ol> <li>Check namespace declarations match schema</li> <li>Verify element order in your config</li> <li>Use correct schema for your XCCDF version</li> <li>Compare with working style (disa_style.yaml or cis_style.yaml)</li> </ol>"},{"location":"developer-guide/how-to-add-xccdf-style/#missing-elements-in-output","title":"Missing Elements in Output","text":"<p>Cause: Field mapping not found or source field empty.</p> <p>Debug:</p> <pre><code>cis-bench export benchmark.json --format xccdf --style pci-dss --verbose\n</code></pre> <p>Check:</p> <ul> <li>Source field exists in Pydantic model</li> <li>Field mapping defined in YAML config</li> <li>Transform function exists</li> <li>Source field name spelled correctly (case-sensitive)</li> </ul>"},{"location":"developer-guide/how-to-add-xccdf-style/#summary-checklist","title":"Summary Checklist","text":"<p>Before considering your new style complete:</p> <ul> <li>[ ] YAML config created in <code>src/cis_bench/exporters/configs/</code></li> <li>[ ] Config follows naming convention: <code>{style}_style.yaml</code></li> <li>[ ] CLI option added to <code>export.py</code></li> <li>[ ] Manual test: <code>cis-bench export --format xccdf --style {name}</code></li> <li>[ ] XSD validation passes: <code>xmllint --schema schemas/xccdf_*.xsd --noout output.xml</code></li> <li>[ ] Unit tests written and passing</li> <li>[ ] XSD validation in automated tests</li> <li>[ ] Documentation added to <code>XCCDF_STYLES.md</code></li> <li>[ ] Config file has explanatory comments</li> <li>[ ] Reused existing structures where possible</li> </ul>"},{"location":"developer-guide/how-to-add-xccdf-style/#see-also","title":"See Also","text":"<ul> <li>YAML Config Reference - Complete YAML syntax</li> <li>Mapping Engine Design - How config-driven system works</li> <li>XCCDF Styles Comparison - All available styles</li> <li>MappingEngine User Guide - Using the mapping engine</li> </ul> <p>Remember: Configuration is code. The YAML file is your implementation. The system handles the rest automatically.</p>"},{"location":"developer-guide/mapping-engine-guide/","title":"MappingEngine User Guide","text":"<p>Practical guide to working with the configuration-driven XCCDF transformation system</p> <p>Documentation Path</p> <p>You are here: Developer Guide &gt; MappingEngine User Guide</p> <p>New to terms? See Glossary for definitions of MappingEngine, YAML, transformation, field mapping, xsdata, etc.</p>"},{"location":"developer-guide/mapping-engine-guide/#what-is-the-mappingengine","title":"What is the MappingEngine?","text":"<p>The MappingEngine is a config-driven transformation system that converts CIS Benchmark data (Pydantic models) into XCCDF XML format using YAML configuration files.</p> <p>Think of it as: A translator that reads instructions from a YAML file and transforms data from one format to another - without writing code.</p> <pre><code>graph LR\nA[Pydantic&lt;br/&gt;Recommendation] --&gt; B[MappingEngine]\nC[YAML Config&lt;br/&gt;disa_style.yaml] --&gt; B\nB --&gt; D[xsdata XCCDF&lt;br/&gt;Rule object]\n\nstyle B fill:#ff9,stroke:#333,stroke-width:3px\nstyle C fill:#9ff,stroke:#333</code></pre> <p>Key Benefit: Change XCCDF output structure by editing YAML, not Python code.</p>"},{"location":"developer-guide/mapping-engine-guide/#quick-example","title":"Quick Example","text":"<p>Problem: You want to change how the description field appears in XCCDF.</p> <p>Without MappingEngine (hard-coded): <pre><code># exporters/xccdf_disa_exporter.py (BAD - don't do this)\ndef map_description(recommendation):\ndesc = f\"&lt;VulnDiscussion&gt;{recommendation.description}&lt;/VulnDiscussion&gt;\"\ndesc += f\"&lt;FalsePositives&gt;&lt;/FalsePositives&gt;\"\n# ... 50 more lines of string manipulation\nreturn desc\n</code></pre></p> <p>With MappingEngine (config-driven): <pre><code># exporters/configs/disa_style.yaml (GOOD - do this)\ndescription:\nstructure: \"embedded_xml_tags\"\ncomponents:\n\n- tag: \"VulnDiscussion\"\nsources:\n\n- field: \"description\"\n- field: \"rationale\"\nseparator: \"\\n\\n\"\n\n- tag: \"FalsePositives\"\ncontent: \"\"\n</code></pre></p> <p>Result: Same output, but now you can:</p> <ul> <li>Change structure without touching code</li> <li>Support multiple XCCDF styles</li> <li>Test configurations independently</li> <li>Reuse transformations across styles</li> </ul>"},{"location":"developer-guide/mapping-engine-guide/#yaml-configuration-structure","title":"YAML Configuration Structure","text":""},{"location":"developer-guide/mapping-engine-guide/#complete-example-simplified","title":"Complete Example (Simplified)","text":"<pre><code># my_custom_style.yaml\n\n# Inherit base configuration\nextends: base_style.yaml\n\n# Style metadata\nmetadata:\nstyle_name: \"custom\"\nxccdf_version: \"1.2\"\ndescription: \"My custom XCCDF format\"\n\n# Benchmark-level settings\nbenchmark:\nid_template: \"xccdf_custom_benchmark_{benchmark_id}\"\ntitle:\nsource: \"title\"\ntransform: \"strip_html\"\n\n# Rule-level field mappings\nfield_mappings:\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\n\ndescription:\ntarget_element: \"description\"\nsource_field: \"description\"\ntransform: \"strip_html_keep_code\"\n\nident:\ntarget_element: \"ident\"\nmultiple: true\ncci_lookup:\nsource_field: \"cis_controls\"\nextract: \"primary\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#configuration-sections","title":"Configuration Sections","text":"Section Purpose Required <code>metadata</code> Style identification and XCCDF version Yes <code>benchmark</code> Benchmark-level elements and namespaces Yes <code>field_mappings</code> Rule-level field transformations Yes <code>rule_defaults</code> Default attributes for all rules No <code>transformations</code> Custom transformation definitions No <code>validation</code> Validation rules and constraints No"},{"location":"developer-guide/mapping-engine-guide/#field-mapping-types","title":"Field Mapping Types","text":"<p>The MappingEngine supports 4 field mapping strategies:</p>"},{"location":"developer-guide/mapping-engine-guide/#1-simple-field-mapping","title":"1. Simple Field Mapping","text":"<p>Use when: Direct 1:1 field mapping with optional transformation</p> <pre><code>title:\ntarget_element: \"title\" # XCCDF element name\nsource_field: \"title\" # Pydantic model field\ntransform: \"strip_html\" # Transformation to apply\nxccdf_type: \"TextType\" # xsdata type (optional)\n</code></pre> <p>Example: <pre><code># Input (Pydantic)\nrecommendation.title = \"&lt;p&gt;Ensure &lt;code&gt;cramfs&lt;/code&gt; is disabled&lt;/p&gt;\"\n\n# Config applies transform\ntransform = \"strip_html\"\n\n# Output (xsdata)\nRule.title = TextType(value=\"Ensure cramfs is disabled\")\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#2-composite-field-mapping","title":"2. Composite Field Mapping","text":"<p>Use when: Combine multiple source fields into one XCCDF element</p> <pre><code>description:\ntarget_element: \"description\"\nstructure: \"composite\"\nsources:\n\n- field: \"description\"\ntransform: \"strip_html\"\n\n- field: \"rationale\"\ntransform: \"strip_html\"\n\n- field: \"impact\"\ntransform: \"strip_html\"\nseparator: \"\\n\\n\" # Join with double newline\n</code></pre> <p>Example: <pre><code># Input (Pydantic)\nrecommendation.description = \"The cramfs filesystem...\"\nrecommendation.rationale = \"Removing support reduces...\"\nrecommendation.impact = \"Minimal impact expected...\"\n\n# Output (xsdata)\nRule.description = HtmlTextWithSubType(\nvalue=\"The cramfs filesystem...\\n\\n\"\n\"Removing support reduces...\\n\\n\"\n\"Minimal impact expected...\"\n)\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#3-embedded-xml-tags-disa-stig-format","title":"3. Embedded XML Tags (DISA STIG Format)","text":"<p>Use when: Need XML tags inside XCCDF element (like DISA VulnDiscussion)</p> <pre><code>description:\ntarget_element: \"description\"\nstructure: \"embedded_xml_tags\"\ncomponents:\n\n- tag: \"VulnDiscussion\"\nsources:\n\n- field: \"description\"\n- field: \"rationale\"\nseparator: \"\\n\\n\"\n\n- tag: \"FalsePositives\"\ncontent: \"\" # Empty (DISA legacy)\n\n- tag: \"PotentialImpacts\"\nsources:\n\n- field: \"impact\"\noptional: true # Only if field exists\n</code></pre> <p>Example: <pre><code># Output (xsdata)\nRule.description = HtmlTextWithSubType(\nvalue=\"&lt;VulnDiscussion&gt;The cramfs filesystem...\\n\\n\"\n\"Removing support reduces...&lt;/VulnDiscussion&gt;\"\n\"&lt;FalsePositives&gt;&lt;/FalsePositives&gt;\"\n\"&lt;PotentialImpacts&gt;Minimal impact...&lt;/PotentialImpacts&gt;\"\n)\n</code></pre></p> <p>Rendered XML: <pre><code>&lt;description&gt;\n&lt;VulnDiscussion&gt;The cramfs filesystem is a compressed read-only filesystem...\n\nRemoving support for unneeded filesystem types reduces attack surface.&lt;/VulnDiscussion&gt;\n&lt;FalsePositives&gt;&lt;/FalsePositives&gt;\n&lt;PotentialImpacts&gt;Minimal impact expected.&lt;/PotentialImpacts&gt;\n&lt;/description&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#4-list-field-mapping","title":"4. List Field Mapping","text":"<p>Use when: Create multiple XCCDF elements from a list (like CCI identifiers)</p> <pre><code>ident:\ntarget_element: \"ident\"\nmultiple: true # Creates one &lt;ident&gt; per CCI\ncci_lookup:\nenabled: true\nsource_field: \"cis_controls\"\nextract: \"primary\"\ndeduplicate_nist: true\nattributes:\nsystem: \"http://cyber.mil/cci\"\n</code></pre> <p>Example: <pre><code># Input (Pydantic)\nrecommendation.cis_controls = [\n{\"id\": \"4.1\", ...},\n{\"id\": \"4.8\", ...}\n]\n\n# CCI lookup\n# 4.1 [\"CCI-001234\", \"CCI-001235\"]\n# 4.8 [\"CCI-000381\", \"CCI-000382\"]\n\n# After deduplication\nccis = [\"CCI-001234\", \"CCI-000381\", \"CCI-000382\"]\n\n# Output (xsdata)\nRule.ident = [\nIdentType(value=\"CCI-001234\", system=\"http://cyber.mil/cci\"),\nIdentType(value=\"CCI-000381\", system=\"http://cyber.mil/cci\"),\nIdentType(value=\"CCI-000382\", system=\"http://cyber.mil/cci\")\n]\n</code></pre></p> <p>Rendered XML: <pre><code>&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-001234&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000381&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000382&lt;/ident&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#available-transformations","title":"Available Transformations","text":"<p>Transformations are defined in <code>base_style.yaml</code> and can be used by any field:</p>"},{"location":"developer-guide/mapping-engine-guide/#strip_html","title":"strip_html","text":"<p>Removes all HTML tags, returns plain text.</p> <pre><code>title:\nsource_field: \"title\"\ntransform: \"strip_html\"\n</code></pre> <pre><code>Input: \"&lt;p&gt;Ensure &lt;code&gt;cramfs&lt;/code&gt; is disabled&lt;/p&gt;\"\nOutput: \"Ensure cramfs is disabled\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#strip_html_keep_code","title":"strip_html_keep_code","text":"<p>Strips HTML but preserves code blocks and lists.</p> <pre><code>audit:\nsource_field: \"audit\"\ntransform: \"strip_html_keep_code\"\n</code></pre> <pre><code>Input: \"&lt;p&gt;Run: &lt;code&gt;modprobe -n -v cramfs&lt;/code&gt;&lt;/p&gt;&lt;pre&gt;grep cramfs&lt;/pre&gt;\"\nOutput: \"Run: `modprobe -n -v cramfs`\\n\\n```\\ngrep cramfs\\n```\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#html_to_markdown","title":"html_to_markdown","text":"<p>Converts HTML to Markdown format.</p> <pre><code>description:\nsource_field: \"description\"\ntransform: \"html_to_markdown\"\n</code></pre> <pre><code>Input: \"&lt;p&gt;The &lt;code&gt;cramfs&lt;/code&gt; filesystem &lt;strong&gt;must&lt;/strong&gt; be disabled.&lt;/p&gt;\"\nOutput: \"The `cramfs` filesystem **must** be disabled.\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#none","title":"none","text":"<p>Pass through unchanged (no transformation).</p> <pre><code>version:\nsource_field: \"version\"\ntransform: \"none\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#variable-substitution","title":"Variable Substitution","text":"<p>Use <code>{variable}</code> syntax to insert dynamic values:</p>"},{"location":"developer-guide/mapping-engine-guide/#available-variables","title":"Available Variables","text":"<p>From Recommendation:</p> <ul> <li><code>{ref}</code> - Recommendation number (e.g., \"1.1.1\")</li> <li><code>{ref_normalized}</code> - Underscored version (e.g., \"1_1_1\")</li> <li><code>{title}</code> - Recommendation title</li> <li>Any Pydantic field name</li> </ul> <p>From Benchmark:</p> <ul> <li><code>{benchmark.title}</code> - Benchmark title</li> <li><code>{benchmark.version}</code> - Benchmark version</li> <li><code>{benchmark.url}</code> - Benchmark URL</li> <li><code>{benchmark_id}</code> - Numeric ID</li> </ul> <p>Generated:</p> <ul> <li><code>{download_date}</code> - Current date</li> <li><code>{platform}</code> - Inferred platform name</li> </ul>"},{"location":"developer-guide/mapping-engine-guide/#example-dynamic-attributes","title":"Example: Dynamic Attributes","text":"<pre><code>fixtext:\ntarget_element: \"fixtext\"\nsource_field: \"remediation\"\ntransform: \"strip_html_keep_code\"\nattributes:\nfixref: \"F-{ref_normalized}\" # F-1_1_1, F-1_1_2, etc.\n</code></pre> <p>Result: <pre><code>&lt;fixtext fixref=\"F-1_1_1\"&gt;Run: modprobe -n -v cramfs&lt;/fixtext&gt;\n&lt;fixtext fixref=\"F-2_3_5\"&gt;Edit /etc/ssh/sshd_config&lt;/fixtext&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#cci-lookup-configuration","title":"CCI Lookup Configuration","text":"<p>CCI (Control Correlation Identifier) lookup is a special feature for DISA compliance:</p>"},{"location":"developer-guide/mapping-engine-guide/#basic-cci-lookup","title":"Basic CCI Lookup","text":"<pre><code>ident:\ntarget_element: \"ident\"\nmultiple: true\ncci_lookup:\nenabled: true\nmapping_file: \"data/cis-cci-mapping.json\"\nsource_field: \"cis_controls\" # Look up CCIs from CIS Controls\nextract: \"primary\" # \"primary\" or \"all\"\ndeduplicate_nist: true # Remove duplicate NIST mappings\nattributes:\nsystem: \"http://cyber.mil/cci\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#extract-options","title":"Extract Options","text":"<p><code>extract: \"primary\"</code> (Recommended for DISA)</p> <ul> <li>Returns only the primary CCI for each NIST control</li> <li>Result: 1-3 CCIs per recommendation</li> <li>Cleaner XCCDF output</li> </ul> <p><code>extract: \"all\"</code> (Comprehensive)</p> <ul> <li>Returns primary + all supporting CCIs</li> <li>Result: 6-20 CCIs per recommendation</li> <li>More complete but verbose</li> </ul>"},{"location":"developer-guide/mapping-engine-guide/#example-cci-lookup-flow","title":"Example: CCI Lookup Flow","text":"<pre><code># Input\nrecommendation.cis_controls = [\n{\"id\": \"4.1\", \"title\": \"...\"},\n{\"id\": \"4.8\", \"title\": \"...\"}\n]\n\n# Step 1: Look up NIST controls for each CIS Control\n# 4.1 CM-8, CM-8(1)\n# 4.8 CM-7, CM-7(1)\n\n# Step 2: Look up CCIs for each NIST control\n# CM-8 CCI-000389 (primary) + 3 supporting\n# CM-8(1) CCI-000390 (primary) + 2 supporting\n# CM-7 CCI-000381 (primary) + 2 supporting\n# CM-7(1) CCI-000382 (primary) + 1 supporting\n\n# Step 3: Extract (based on config)\nif extract == \"primary\":\nccis = [\"CCI-000389\", \"CCI-000390\", \"CCI-000381\", \"CCI-000382\"]\nelse: # \"all\"\nccis = [\"CCI-000389\", \"CCI-xxx\", \"CCI-yyy\", ...] # 12 total\n\n# Step 4: Deduplicate\nccis = unique(ccis) # Remove any duplicates\n\n# Output\nRule.ident = [IdentType(value=cci) for cci in ccis]\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#how-to-add-a-new-field-to-xccdf","title":"How to Add a New Field to XCCDF","text":"<p>Scenario: You want to add the \"default_value\" field to XCCDF output.</p>"},{"location":"developer-guide/mapping-engine-guide/#step-1-check-pydantic-model","title":"Step 1: Check Pydantic Model","text":"<p>Verify the field exists:</p> <pre><code># src/cis_bench/models/benchmark.py\nclass Recommendation(BaseModel):\n# ...\ndefault_value: Optional[str] = None # Field exists\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#step-2-choose-xccdf-element","title":"Step 2: Choose XCCDF Element","text":"<p>Decide where it belongs in XCCDF. Options:</p> <ul> <li>New <code>&lt;default&gt;</code> element</li> <li>Add to existing <code>&lt;description&gt;</code> with custom tag</li> <li>Add as metadata</li> </ul> <p>Let's add as a new element:</p>"},{"location":"developer-guide/mapping-engine-guide/#step-3-update-yaml-config","title":"Step 3: Update YAML Config","text":"<pre><code># src/cis_bench/exporters/configs/disa_style.yaml\n\nfield_mappings:\n# ... existing mappings\n\ndefault_value: # New mapping\ntarget_element: \"default\"\nsource_field: \"default_value\"\ntransform: \"strip_html\"\noptional: true # Only include if field has value\nxccdf_type: \"TextType\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#step-4-test-the-change","title":"Step 4: Test the Change","text":"<pre><code># Export with new config\ncis-bench export 23598 --format xccdf --style disa -o test.xml\n\n# Check output\ngrep \"&lt;default&gt;\" test.xml\n</code></pre> <p>Result: <pre><code>&lt;Rule id=\"xccdf_rule_1_1_1\"&gt;\n&lt;title&gt;Ensure mounting of cramfs is disabled&lt;/title&gt;\n&lt;description&gt;...&lt;/description&gt;\n&lt;default&gt;Not applicable - module should not be loaded&lt;/default&gt;\n&lt;ident&gt;...&lt;/ident&gt;\n&lt;/Rule&gt;\n</code></pre></p> <p>That's it! No Python code changes needed.</p>"},{"location":"developer-guide/mapping-engine-guide/#how-to-create-a-new-xccdf-style","title":"How to Create a New XCCDF Style","text":"<p>Scenario: You want to create a \"minimal\" XCCDF style with only essential fields.</p>"},{"location":"developer-guide/mapping-engine-guide/#step-1-create-new-config-file","title":"Step 1: Create New Config File","text":"<pre><code># Create new style config\ntouch src/cis_bench/exporters/configs/minimal_style.yaml\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#step-2-define-configuration","title":"Step 2: Define Configuration","text":"<pre><code># src/cis_bench/exporters/configs/minimal_style.yaml\n\n# Inherit base\nextends: base_style.yaml\n\n# Style metadata\nmetadata:\nstyle_name: \"minimal\"\ndescription: \"Minimal XCCDF with only essential fields\"\nxccdf_version: \"1.2\"\nxccdf_namespace: \"http://checklists.nist.gov/xccdf/1.2\"\n\n# Benchmark settings\nbenchmark:\nid_template: \"xccdf_minimal_benchmark_{benchmark_id}\"\n\ntitle:\nsource: \"title\"\ntransform: \"strip_html\"\n\ndescription:\nsource: \"title\"\nprepend_text: \"CIS Benchmark - Minimal Export. \"\n\nversion:\nsource: \"version\"\n\n# Rule-level field mappings (minimal set)\nfield_mappings:\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\n\ndescription:\ntarget_element: \"description\"\nsource_field: \"description\"\ntransform: \"strip_html_keep_code\"\n\n# Just one check element (simplified)\ncheck:\ntarget_element: \"check\"\nstructure: \"nested\"\nattributes:\nsystem: \"urn:cis:check\"\nchildren:\n\n- element: \"check-content\"\nsource_field: \"audit\"\ntransform: \"strip_html_keep_code\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#step-3-register-in-exporter","title":"Step 3: Register in Exporter","text":"<pre><code># src/cis_bench/exporters/xccdf_unified_exporter.py\n\nSUPPORTED_STYLES = {\n'disa': 'configs/disa_style.yaml',\n'cis': 'configs/cis_style.yaml',\n'minimal': 'configs/minimal_style.yaml' # Add this line\n}\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#step-4-test-your-new-style","title":"Step 4: Test Your New Style","text":"<pre><code># Export with new style\ncis-bench export 23598 --format xccdf --style minimal -o minimal.xml\n\n# Verify output\nless minimal.xml\n</code></pre> <p>That's it! You've created a new XCCDF style without modifying transformation logic.</p>"},{"location":"developer-guide/mapping-engine-guide/#working-with-config-inheritance","title":"Working with Config Inheritance","text":""},{"location":"developer-guide/mapping-engine-guide/#base-style-pattern","title":"Base Style Pattern","text":"<pre><code># base_style.yaml - Common configuration\ntransformations:\nstrip_html:\nfunction: \"HTMLCleaner.strip_html\"\n\nbenchmark:\nnamespaces:\ndefault: \"http://checklists.nist.gov/xccdf/1.2\"\ndc: \"http://purl.org/dc/elements/1.1/\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#child-style-inherits","title":"Child Style Inherits","text":"<pre><code># disa_style.yaml\nextends: base_style.yaml # Inherit all from base\n\n# Override specific settings\nmetadata:\nxccdf_version: \"1.1.4\" # Override (base has 1.2)\n\n# Add new transformations\ntransformations:\ncustom_disa_transform:\nfunction: \"MyCustomTransform\"\n\n# field_mappings are merged (not replaced)\nfield_mappings:\ntitle:\nsource_field: \"title\" # Uses strip_html from base\n</code></pre> <p>Inheritance Rules: 1. <code>transformations</code> - Merged (child adds to base) 2. <code>field_mappings</code> - Merged (child adds/overrides) 3. <code>metadata</code> - Child overrides base 4. <code>benchmark</code> - Child overrides base 5. <code>namespaces</code> - Merged (child adds to base)</p>"},{"location":"developer-guide/mapping-engine-guide/#advanced-features","title":"Advanced Features","text":""},{"location":"developer-guide/mapping-engine-guide/#conditional-mapping","title":"Conditional Mapping","text":"<p>Map fields only when certain conditions are met:</p> <pre><code>impact_statement:\ntarget_element: \"impact\"\nsource_field: \"impact\"\ntransform: \"strip_html\"\noptional: true # Only include if field has value\ncondition:\nfield: \"impact\"\nnot_empty: true # Only map if field is not empty/None\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#nested-structures","title":"Nested Structures","text":"<p>Create nested XCCDF elements:</p> <pre><code>check:\ntarget_element: \"check\"\nstructure: \"nested\"\nattributes:\nsystem: \"C-{ref_normalized}\"\nchildren:\n\n- element: \"check-content-ref\"\nattributes:\nname: \"oval:check:{ref_normalized}:def:1\"\nhref: \"oval-definitions.xml\"\n\n- element: \"check-content\"\nsource_field: \"audit\"\ntransform: \"strip_html_keep_code\"\n</code></pre> <p>Output: <pre><code>&lt;check system=\"C-1_1_1\"&gt;\n&lt;check-content-ref\nname=\"oval:check:1_1_1:def:1\"\nhref=\"oval-definitions.xml\"/&gt;\n&lt;check-content&gt;Run: modprobe -n -v cramfs&lt;/check-content&gt;\n&lt;/check&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#custom-metadata-blocks","title":"Custom Metadata Blocks","text":"<p>Add CIS Controls as structured metadata:</p> <pre><code>cis_controls_metadata:\nstructure: \"custom_namespace\"\nnamespace: \"controls\"\ncomponents:\n\n- element: \"control\"\nsource_field: \"cis_controls\"\nmultiple: true\nattributes:\nid: \"{control.id}\"\nversion: \"8\"\nig: \"{control.ig}\"\ncontent: \"{control.title}\"\n</code></pre> <p>Output: <pre><code>&lt;metadata&gt;\n&lt;controls:control id=\"4.1\" version=\"8\" ig=\"IG1\"&gt;\nEstablish and Maintain Secure Configuration Process\n&lt;/controls:control&gt;\n&lt;controls:control id=\"4.8\" version=\"8\" ig=\"IG2\"&gt;\nUninstall or Disable Unnecessary Services\n&lt;/controls:control&gt;\n&lt;/metadata&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#real-world-example-complete-field-mapping","title":"Real-World Example: Complete Field Mapping","text":"<p>Let's walk through mapping the <code>fixtext</code> element for DISA STIG:</p>"},{"location":"developer-guide/mapping-engine-guide/#disa-stig-requirement","title":"DISA STIG Requirement","text":"<pre><code>&lt;fixtext fixref=\"F-1_1_1\"&gt;\nEdit /etc/modprobe.d/cramfs.conf and add:\ninstall cramfs /bin/true\n&lt;/fixtext&gt;\n</code></pre> <p>Requirements: 1. Element name: <code>fixtext</code> 2. Attribute: <code>fixref</code> with format \"F-{ref_normalized}\" 3. Content: Remediation text with code preserved 4. Type: FixTextType (xsdata)</p>"},{"location":"developer-guide/mapping-engine-guide/#yaml-configuration","title":"YAML Configuration","text":"<pre><code>fixtext:\ntarget_element: \"fixtext\" # 1. Element name\nsource_field: \"remediation\" # Source from Pydantic\ntransform: \"strip_html_keep_code\" # 3. Preserve code blocks\nattributes: # 2. Dynamic attribute\nfixref: \"F-{ref_normalized}\"\nxccdf_type: \"FixTextType\" # 4. xsdata type\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#mappingengine-process","title":"MappingEngine Process","text":"<pre><code># 1. Load config\nconfig = field_mappings['fixtext']\n\n# 2. Get source data\nsource_value = getattr(recommendation, 'remediation')\n# \"&lt;p&gt;Edit &lt;code&gt;/etc/modprobe.d/cramfs.conf&lt;/code&gt; and add:&lt;pre&gt;install cramfs /bin/true&lt;/pre&gt;&lt;/p&gt;\"\n\n# 3. Apply transformation\ntransformed = apply_transform(source_value, 'strip_html_keep_code')\n# \"Edit `/etc/modprobe.d/cramfs.conf` and add:\\n\\n```\\ninstall cramfs /bin/true\\n```\"\n\n# 4. Substitute variables in attributes\nref_normalized = recommendation.ref.replace('.', '_') # \"1.1.1\" \"1_1_1\"\nfixref_value = f\"F-{ref_normalized}\" # \"F-1_1_1\"\n\n# 5. Create xsdata object\nfixtext = FixTextType(\nvalue=transformed,\nfixref=fixref_value\n)\n\n# 6. Add to Rule\nrule.fixtext = fixtext\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#verification","title":"Verification","text":"<pre><code># Export and check\ncis-bench export 23598 --format xccdf --style disa -o output.xml\ngrep -A3 \"&lt;fixtext\" output.xml\n</code></pre> <p>Output: <pre><code>&lt;fixtext fixref=\"F-1_1_1\"&gt;\nEdit `/etc/modprobe.d/cramfs.conf` and add:\n</code></pre> install cramfs /bin/true <pre><code>&lt;/fixtext&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#debugging-mapping-issues","title":"Debugging Mapping Issues","text":""},{"location":"developer-guide/mapping-engine-guide/#enable-verbose-logging","title":"Enable Verbose Logging","text":"<pre><code>cis-bench --verbose export 23598 --format xccdf --style disa\n</code></pre> <p>Logs show: <pre><code>DEBUG: Loading config: disa_style.yaml\nDEBUG: Processing field: title\nDEBUG: Source value: \"&lt;p&gt;Ensure cramfs disabled&lt;/p&gt;\"\nDEBUG: Applying transform: strip_html\nDEBUG: Result: \"Ensure cramfs disabled\"\nDEBUG: Creating TextType object\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#common-issues","title":"Common Issues","text":"<p>Issue: \"Field not found\" <pre><code>KeyError: 'custom_field'\n</code></pre> Fix: Add field to Pydantic model or use <code>optional: true</code> in config</p> <p>Issue: \"Invalid xsdata type\" <pre><code>TypeError: Rule.title expects TextType, got str\n</code></pre> Fix: Check <code>xccdf_type</code> in config matches xsdata model</p> <p>Issue: \"CCI lookup returns no results\" <pre><code>WARNING: No CCIs found for CIS Control 18.1\n</code></pre> Fix: CCI mapping file incomplete, control is INFERRED (has no CCIs)</p> <p>Issue: \"Namespace prefix not declared\" <pre><code>ERROR: Namespace prefix 'controls' not defined\n</code></pre> Fix: Add namespace to <code>benchmark.namespaces</code> in config</p>"},{"location":"developer-guide/mapping-engine-guide/#testing-your-configuration-changes","title":"Testing Your Configuration Changes","text":""},{"location":"developer-guide/mapping-engine-guide/#unit-test-configuration-loading","title":"Unit Test Configuration Loading","text":"<pre><code># tests/unit/test_mapping_config.py\n\ndef test_load_custom_style():\n\"\"\"Test loading custom style config.\"\"\"\nconfig = load_yaml_config('configs/my_custom_style.yaml')\n\nassert config['metadata']['style_name'] == 'custom'\nassert 'title' in config['field_mappings']\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#integration-test-export","title":"Integration Test Export","text":"<pre><code># tests/integration/test_custom_xccdf.py\n\ndef test_custom_style_export(sample_benchmark):\n\"\"\"Test exporting with custom style.\"\"\"\nexporter = XCCDFUnifiedExporter(style='custom')\nxccdf = exporter.export(sample_benchmark)\n\n# Verify structure\nassert xccdf.id.startswith('xccdf_custom_benchmark_')\nassert len(xccdf.group[0].rule) &gt; 0\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#manual-validation","title":"Manual Validation","text":"<pre><code># Export\ncis-bench export 23598 --format xccdf --style custom -o test.xml\n\n# Validate against schema\nxmllint --schema schemas/xccdf-1.2.xsd test.xml\n\n# Check specific elements\nxmllint --xpath \"//Rule/title\" test.xml\nxmllint --xpath \"count(//ident)\" test.xml\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#best-practices","title":"Best Practices","text":""},{"location":"developer-guide/mapping-engine-guide/#1-start-from-base-style","title":"1. Start from Base Style","text":"<p>Always extend <code>base_style.yaml</code>: <pre><code>extends: base_style.yaml # Do not start from scratch\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#2-use-descriptive-names","title":"2. Use Descriptive Names","text":"<pre><code># Good\nfield_mappings:\nvulnerability_discussion:\ntarget_element: \"description\"\n\n# Bad\nfield_mappings:\ndesc:\ntarget_element: \"description\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#3-document-your-transformations","title":"3. Document Your Transformations","text":"<pre><code>transformations:\ncustom_transform:\ndescription: \"Converts CIS-style lists to DISA bullet points\" # Document!\nfunction: \"MyTransformers.convert_lists\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#4-test-each-field-mapping","title":"4. Test Each Field Mapping","text":"<p>Do not add 10 mappings at once. Add one, test, commit, repeat.</p>"},{"location":"developer-guide/mapping-engine-guide/#5-use-optional-wisely","title":"5. Use Optional Wisely","text":"<pre><code>impact_statement:\nsource_field: \"impact\"\noptional: true # Good - impact field might not exist\n\ntitle:\nsource_field: \"title\"\noptional: false # Good - title is required\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#6-validate-xsdata-types","title":"6. Validate xsdata Types","text":"<p>Check the xsdata model to ensure type matches:</p> <pre><code># src/cis_bench/models/xccdf_v1_1/__init__.py\nclass Rule:\ntitle: TextWithSubType # Not TextType!\n</code></pre> <pre><code># Config must match\ntitle:\nxccdf_type: \"TextWithSubType\" # Matches\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#configuration-file-locations","title":"Configuration File Locations","text":"<pre><code>src/cis_bench/exporters/configs/\n\u251c\u2500\u2500 base_style.yaml # Common config (inherit from this)\n\u251c\u2500\u2500 disa_style.yaml # DISA STIG format\n\u251c\u2500\u2500 cis_style.yaml # CIS native format (if exists)\n\u2514\u2500\u2500 custom_style.yaml # Your custom style\n</code></pre> <p>Data files: <pre><code>src/cis_bench/data/\n\u2514\u2500\u2500 cis-cci-mapping.json # CIS Control CCI mappings\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#example-minimal-working-config","title":"Example: Minimal Working Config","text":"<p>Here's a complete minimal style that actually works:</p> <pre><code># minimal_working_style.yaml\n\nextends: base_style.yaml\n\nmetadata:\nstyle_name: \"minimal\"\nxccdf_version: \"1.2\"\n\nbenchmark:\nid_template: \"xccdf_minimal_{benchmark_id}\"\n\ntitle:\nsource: \"title\"\ntransform: \"strip_html\"\n\nversion:\nsource: \"version\"\n\nfield_mappings:\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\nxccdf_type: \"TextType\"\n\ndescription:\ntarget_element: \"description\"\nsource_field: \"description\"\ntransform: \"strip_html\"\nxccdf_type: \"HtmlTextWithSubType\"\n\ncheck:\ntarget_element: \"check\"\nstructure: \"nested\"\nattributes:\nsystem: \"urn:minimal:check\"\nchildren:\n\n- element: \"check-content\"\nsource_field: \"audit\"\ntransform: \"strip_html_keep_code\"\n</code></pre> <p>This produces: <pre><code>&lt;Benchmark id=\"xccdf_minimal_23598\"&gt;\n&lt;title&gt;CIS AlmaLinux OS 10 Benchmark&lt;/title&gt;\n&lt;description&gt;CIS AlmaLinux OS 10 Benchmark&lt;/description&gt;\n&lt;version&gt;1.0.0&lt;/version&gt;\n&lt;Group&gt;\n&lt;Rule&gt;\n&lt;title&gt;Ensure cramfs is disabled&lt;/title&gt;\n&lt;description&gt;The cramfs filesystem type...&lt;/description&gt;\n&lt;check system=\"urn:minimal:check\"&gt;\n&lt;check-content&gt;modprobe -n -v cramfs&lt;/check-content&gt;\n&lt;/check&gt;\n&lt;/Rule&gt;\n&lt;/Group&gt;\n&lt;/Benchmark&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#common-patterns","title":"Common Patterns","text":""},{"location":"developer-guide/mapping-engine-guide/#pattern-1-combining-multiple-fields","title":"Pattern 1: Combining Multiple Fields","text":"<pre><code>remediation_full:\ntarget_element: \"fix\"\nsources:\n\n- field: \"remediation\"\nlabel: \"Remediation:\"\n\n- field: \"default_value\"\nlabel: \"Default:\"\n\n- field: \"references\"\nlabel: \"References:\"\nseparator: \"\\n\\n\"\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#pattern-2-conditional-content","title":"Pattern 2: Conditional Content","text":"<pre><code>impact:\ntarget_element: \"impact\"\nsource_field: \"impact\"\ntransform: \"strip_html\"\noptional: true\ndefault: \"No impact information available\" # Use if field empty\n</code></pre>"},{"location":"developer-guide/mapping-engine-guide/#pattern-3-list-expansion","title":"Pattern 3: List Expansion","text":"<pre><code>profiles:\ntarget_element: \"profile\"\nsource_field: \"profiles\"\nmultiple: true # One &lt;profile&gt; per list item\ntransform: \"none\"\n</code></pre> <p>Input: <pre><code>recommendation.profiles = [\"Level 1 - Server\", \"Level 2 - Workstation\"]\n</code></pre></p> <p>Output: <pre><code>&lt;profile&gt;Level 1 - Server&lt;/profile&gt;\n&lt;profile&gt;Level 2 - Workstation&lt;/profile&gt;\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#mappingengine-code-reference","title":"MappingEngine Code Reference","text":"<p>Main class: <code>src/cis_bench/exporters/mapping_engine.py</code></p> <p>Key methods:</p> <pre><code>class MappingEngine:\ndef __init__(self, config: dict):\n\"\"\"Initialize with loaded YAML config.\"\"\"\n\ndef map_benchmark(self, benchmark: Benchmark) -&gt; XCCDFBenchmark:\n\"\"\"Map Pydantic Benchmark to xsdata Benchmark.\"\"\"\n\ndef map_recommendation(self, rec: Recommendation) -&gt; Rule:\n\"\"\"Map Pydantic Recommendation to xsdata Rule.\"\"\"\n# THIS IS THE CORE METHOD\n# Loops through field_mappings and applies each\n\ndef apply_field_mapping(self, rec, field_config):\n\"\"\"Apply single field mapping based on config.\"\"\"\n\ndef apply_transformation(self, value, transform_name):\n\"\"\"Apply named transformation from config.\"\"\"\n</code></pre> <p>Critical loop (line ~150): <pre><code>def map_recommendation(self, recommendation):\n\"\"\"Map recommendation using config.\"\"\"\nrule = Rule(id=self.generate_rule_id(recommendation))\n\n# LOOP-DRIVEN ARCHITECTURE (DO NOT HARD-CODE FIELDS!)\nfor field_name, mapping in self.config['field_mappings'].items():\nvalue = self.apply_field_mapping(recommendation, mapping)\nsetattr(rule, field_name, value)\n\nreturn rule\n</code></pre></p> <p>This is why config-driven works:</p> <ul> <li>Add field to YAML automatically mapped</li> <li>Remove field from YAML automatically excluded</li> <li>No code changes needed</li> </ul>"},{"location":"developer-guide/mapping-engine-guide/#troubleshooting-configuration","title":"Troubleshooting Configuration","text":""},{"location":"developer-guide/mapping-engine-guide/#validation-errors","title":"Validation Errors","text":"<p>Symptom: Export fails with validation error</p> <p>Debug: <pre><code># Check config loads correctly\npython3 &lt;&lt; EOF\nfrom cis_bench.exporters.mapping_engine import load_yaml_config\nconfig = load_yaml_config('configs/my_style.yaml')\nprint(config.keys())\nEOF\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#transformation-not-applied","title":"Transformation Not Applied","text":"<p>Symptom: HTML still in output when it should be stripped</p> <p>Debug: <pre><code># Add logging to transformation\ntitle:\nsource_field: \"title\"\ntransform: \"strip_html\"\ndebug: true # Enable debug logging for this field\n</code></pre></p>"},{"location":"developer-guide/mapping-engine-guide/#missing-output","title":"Missing Output","text":"<p>Symptom: Field doesn't appear in XCCDF</p> <p>Check: 1. Field exists in Pydantic model? 2. Field mapping in config? 3. Optional field but value is None? 4. Transformation returning empty string?</p>"},{"location":"developer-guide/mapping-engine-guide/#related-documentation","title":"Related Documentation","text":"<ul> <li>Data Flow Pipeline - Complete transformation process</li> <li>MAPPING_ENGINE_DESIGN.md - Technical architecture</li> <li>YAML Config Reference - Complete syntax guide</li> <li>How to Add XCCDF Style - Step-by-step tutorial</li> </ul>"},{"location":"developer-guide/mapping-engine-guide/#summary","title":"Summary","text":"<p>The MappingEngine provides:</p> <p>Flexibility - Change XCCDF structure without code changes Reusability - Share transformations across styles Maintainability - Clear separation of data and structure Extensibility - Add new styles in minutes Testability - Test configs independent of code</p> <p>Key Principle: Configuration defines WHAT to map, code defines HOW to map it.</p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/","title":"CIS Benchmark InSpec Profile Style Guide","text":"<p>OHDF-Compliant Format Version: 1.0.0 Date: November 6, 2025</p> <p>Documentation Path</p> <p>You are here: Technical Reference &gt; InSpec Profile Style Guide</p> <ul> <li>For XCCDF export: See XCCDF Guide</li> <li>For workflow example: See Workflows - Scenario 4</li> </ul>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#overview","title":"Overview","text":"<p>This style guide defines the standardized format for InSpec profiles generated from CIS Benchmarks. It ensures OHDF (OASIS Heimdall Data Format) compliance and consistency across all CIS Benchmark profiles.</p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#control-structure","title":"Control Structure","text":""},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#complete-example","title":"Complete Example","text":"<pre><code>control 'almalinux-10-cis-6.1.1' do\ntitle 'Ensure AIDE is installed'\n\n# ============================================================================\n# DESCRIPTIONS\n# ============================================================================\n\n# Main description (REQUIRED)\ndesc \"Advanced Intrusion Detection Environment (AIDE) is an intrusion detection tool\nthat uses predefined rules to check the integrity of files and directories in the Linux\noperating system. AIDE has its own database to check the integrity of files and directories.\n\nBy monitoring the filesystem state, compromised files can be detected to prevent or limit\nthe exposure of accidental or malicious misconfigurations or modified binaries.\"\n\n# Check procedure (REQUIRED)\ndesc 'check', 'Run the following command and verify aide is installed:\n# rpm -q aide\n\naide-&lt;version&gt;'\n\n# Remediation (REQUIRED)\ndesc 'fix', 'Run the following command to install aide:\n# dnf install aide\nConfigure aide as appropriate for your environment.\nInitialize aide:\n# aide --init\n# mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz'\n\n# Optional sub-descriptions (only if present in source benchmark)\ndesc 'rationale', 'Detailed reasoning for this control...'\ndesc 'potential_impacts', 'Prelinking feature can interfere with aide...'\ndesc 'mitigations', 'Run prelink -ua to restore binaries...'\ndesc 'false_positives', '...'\ndesc 'false_negatives', '...'\n\n# ============================================================================\n# IMPACT\n# ============================================================================\n\nimpact 0.5 # Mapped from CIS severity or default medium\n\n# ============================================================================\n# REFERENCES (External documentation only)\n# ============================================================================\n\n# Only include if external supplemental documentation exists\n# DO NOT reference the benchmark itself (redundant)\nref 'NIST Security Guide', url: 'https://csrc.nist.gov/...'\nref 'Vendor Documentation', url: 'https://vendor.com/security'\n\n# ============================================================================\n# TAGS - Compliance Framework Mappings\n# ============================================================================\n\n# --- Basic Metadata ---\ntag severity: 'medium' # low, medium, high, critical\n\n# --- CIS Controls (v7 and v8) ---\n# Multiple CIS Controls can map to one recommendation\n# Array maintains alignment with cci and nist arrays\ntag cis_controls: [\n{\nversion: 7,\ncontrol: '14.9',\ntitle: 'Enforce Detail Logging for Access or Changes to Sensitive Data',\nimplementation_groups: ['ig3'] # Only IGs where this applies\n},\n{\nversion: 8,\ncontrol: '3.14',\ntitle: 'Log Sensitive Data Access',\nimplementation_groups: ['ig1', 'ig2', 'ig3'] # All IGs\n}\n]\n\n# --- DoD/NIST Compliance Mappings ---\n# ALIGNED ARRAYS: Position indicates mapping relationship\n# cis_controls[0] cci[0] nist[0]\n# cis_controls[1] cci[1] nist[1]\n\ntag cci: [\n'CCI-000123', # Primary CCI for CIS v7:14.9\n'CCI-000126' # Primary CCI for CIS v8:3.14\n]\n\ntag nist: [\n'AU-2 a', # NIST control for CCI-000123 (from v7:14.9)\n'AU-2 c' # NIST control for CCI-000126 (from v8:3.14)\n]\n\n# --- MITRE ATT&amp;CK Framework ---\ntag mitre_technique_ids: ['T1565', 'T1565.001'] # Attack techniques\ntag mitre_tactic_ids: ['TA0001'] # Attack tactics\ntag mitre_mitigation_ids: ['M1022'] # Mitigations\n\n# --- CIS Profile Applicability ---\n# Which profile levels include this control\ntag level_1: ['server', 'workstation'] # Both platforms at Level 1\n# tag level_2: ['server'] # Only if in Level 2\n# tag level_3: ['workstation'] # Only if benchmark has Level 3\n\n# --- STIG Cross-References (Optional - only if in benchmark references) ---\n# Enables cross-framework mapping via CCI as universal index\n# tag stig_requirements: ['SV-251710', 'V-251710'] # STIGs covering same CCI\n\n# ============================================================================\n# TEST IMPLEMENTATION\n# ============================================================================\n\ndescribe package('aide') do\nit { should be_installed }\nend\nend\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#style-rules","title":"Style Rules","text":""},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#1-control-naming","title":"1. Control Naming","text":"<p>Format: <code>&lt;benchmark-short&gt;-cis-&lt;control-ref&gt;</code></p> <p>Examples:</p> <ul> <li><code>almalinux-10-cis-6.1.1</code></li> <li><code>oci-foundations-cis-5.1.1</code></li> <li><code>ubuntu-22-cis-1.1.1.1</code></li> </ul> <p>Rules:</p> <ul> <li>Use lowercase with hyphens</li> <li>Include benchmark identifier for uniqueness</li> <li>Use CIS reference number from benchmark</li> </ul>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#2-descriptions","title":"2. Descriptions","text":"<p>Required:</p> <ul> <li><code>desc</code> - Main description (always)</li> <li><code>desc 'check'</code> - Audit procedure (always)</li> <li><code>desc 'fix'</code> - Remediation (always)</li> </ul> <p>Optional (only if present in source):</p> <ul> <li><code>desc 'rationale'</code></li> <li><code>desc 'potential_impacts'</code></li> <li><code>desc 'mitigations'</code></li> <li><code>desc 'false_positives'</code></li> <li><code>desc 'false_negatives'</code></li> </ul> <p>Formatting:</p> <ul> <li>Use <code>%q()</code> for multi-line with complex quotes</li> <li>Use single quotes <code>'...'</code> for simple strings</li> <li>Use double quotes <code>\"...\"</code> for strings with single quotes</li> </ul>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#3-references","title":"3. References","text":"<p>Include: External supplemental documentation only Exclude: Self-references to the benchmark itself</p> <p>Format: <pre><code>ref 'Document Title', url: 'https://...'\nref 'Document Title', uri: 'urn:...' # For non-HTTP URIs\n</code></pre></p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#4-tags-naming-conventions","title":"4. Tags - Naming Conventions","text":"<p>No \"cis_\" prefix spam:</p> <ul> <li><code>tag severity:</code> (not <code>tag cis_severity:</code>)</li> <li><code>tag level_1:</code> (not <code>tag cis_level_1:</code>)</li> <li><code>tag cis_controls:</code> (exception - it's a defined term)</li> </ul> <p>Consistency:</p> <ul> <li>All list-type tags are ARRAYS (even single items)</li> <li>Use snake_case for tag names</li> <li>Use descriptive suffixes: <code>_ids</code>, <code>_groups</code>, etc.</li> </ul>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#5-aligned-arrays-the-compliance-chain","title":"5. Aligned Arrays - The Compliance Chain","text":"<p>Critical: Array positions indicate mapping relationships</p> <pre><code>tag cis_controls: [control_v7, control_v8] # Source controls\ntag cci: [cci_for_v7, cci_for_v8] # Mapped CCIs\ntag nist: [nist_for_v7, nist_for_v8] # Mapped NIST\n</code></pre> <p>Rules:</p> <ul> <li>Position <code>[0]</code> in all three arrays represents one complete mapping chain</li> <li>Position <code>[1]</code> in all three arrays represents another complete mapping chain</li> <li>Do NOT reorder independently - alignment is semantic</li> </ul> <p>Rationale: Both CIS Controls v7 and v8 are equally valid compliance frameworks. Neither should be privileged over the other.</p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#6-cci-mapping-strategy","title":"6. CCI Mapping Strategy","text":"<p>Default: PRIMARY CCI only (key compliance mapping) Optional: Supporting CCIs available via <code>--include-supporting-ccis</code> flag</p> <p>Reasoning:</p> <ul> <li>Primary CCI provides the core compliance requirement</li> <li>Supporting CCIs add detail but can clutter</li> <li>Users can opt-in for comprehensive coverage</li> </ul>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#7-implementation-groups","title":"7. Implementation Groups","text":"<p>Format: Sparse array of applicable groups only</p> <pre><code>implementation_groups: ['ig3'] # Only IG3\nimplementation_groups: ['ig1', 'ig2', 'ig3'] # All three\n</code></pre> <p>Not: <pre><code># Do not use explicit true/false\n{ig1: false, ig2: false, ig3: true}\n</code></pre></p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#8-profile-levels","title":"8. Profile Levels","text":"<p>Format: Array of applicable platforms</p> <pre><code>tag level_1: ['server', 'workstation'] # Both\ntag level_2: ['server'] # Server only\ntag level_3: ['workstation'] # Workstation only (if L3 exists)\n</code></pre> <p>Values: <code>'server'</code>, <code>'workstation'</code>, or both</p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#data-flow","title":"Data Flow","text":"<pre><code>CIS Benchmark JSON cis-workbench-cli XCCDF SAF/ts-inspec-objects InSpec Profile\n\n1. Source: CIS API JSON with cis_controls, mitre_mapping, nist_controls\n2. Export: XCCDF with &lt;metadata&gt; containing all mappings\n3. Parse: Extract metadata into InSpec tags\n4. Output: OHDF-compliant InSpec profile\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#comparison-cis-vs-disa-profiles","title":"Comparison: CIS vs DISA Profiles","text":"Element CIS Profile DISA STIG Profile Control ID <code>benchmark-cis-X.Y.Z</code> <code>SV-######</code> or <code>V-######</code> Reference CIS ref number STIG ID gid/rid/stig_id Not included Included cis_controls Included Not applicable mitre_* Included Not typically included level_1/2/3 Included Not applicable cci/nist Via CISCCI mapping Direct from STIG"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#examples","title":"Examples","text":""},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#control-with-multiple-cis-controls","title":"Control with Multiple CIS Controls","text":"<pre><code>tag cis_controls: [\n{version: 7, control: '6.2', implementation_groups: ['ig1', 'ig2', 'ig3']},\n{version: 7, control: '6.3', implementation_groups: ['ig2', 'ig3']},\n{version: 8, control: '8.2', implementation_groups: ['ig1', 'ig2', 'ig3']}\n]\ntag cci: ['CCI-000172', 'CCI-000173', 'CCI-000366']\ntag nist: ['AU-12 c', 'AU-12 a', 'CM-6 b']\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#control-in-multiple-levels","title":"Control in Multiple Levels","text":"<pre><code>tag level_1: ['server', 'workstation']\ntag level_2: ['server', 'workstation']\n# Both Level 1 and Level 2, both platforms\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#control-with-no-mitre-mapping","title":"Control with No MITRE Mapping","text":"<pre><code># If no MITRE mapping exists, simply omit the tags\n# tag mitre_technique_ids: [] # Do not include empty arrays\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#migration-from-old-format","title":"Migration from Old Format","text":""},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#old-disa-style-for-cis-incorrect","title":"Old (DISA-style for CIS - INCORRECT)","text":"<pre><code>control 'SV-6.1.1' do # Wrong ID format\ntag gid: 'CIS-6_1_1' # DISA-specific, not needed\ntag rid: 'xccdf_cis...' # DISA-specific\ntag stig_id: '6.1.1' # Not a STIG\ntag cci: ['CCI-1', 'CCI-2', 'CCI-3', 'CCI-4'] # Primary + Supporting\ntag potential_impacts: '...' # Should be desc\nend\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#new-cis-native-correct","title":"New (CIS-native - CORRECT)","text":"<pre><code>control 'almalinux-10-cis-6.1.1' do # CIS-specific ID\ndesc 'potential_impacts', '...' # desc not tag\ntag cci: ['CCI-1', 'CCI-2'] # Primary only (2 CIS Controls)\ntag cis_controls: [{...}, {...}] # CIS metadata\ntag level_1: ['server'] # Profile applicability\nend\n</code></pre>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#optional-tags","title":"Optional Tags","text":""},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#stig-cross-references","title":"STIG Cross-References","text":"<p>If the benchmark includes STIG cross-references in its references field, include them:</p> <pre><code>tag stig_requirements: ['SV-251710', 'V-251710'] # STIGs sharing same CCI\n</code></pre> <p>Purpose: Enables cross-framework mapping via CCI as the universal index. The CCI connects CIS controls to STIG requirements.</p> <p>Note: Only include if present in source benchmark data. Not all CIS benchmarks have STIG mappings.</p>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#validation-checklist","title":"Validation Checklist","text":"<ul> <li>[ ] Control ID follows <code>&lt;benchmark&gt;-cis-&lt;ref&gt;</code> format</li> <li>[ ] No DISA-specific tags for control metadata (gid, rid, stig_id)</li> <li>[ ] Supplementary info uses <code>desc</code> not <code>tag</code></li> <li>[ ] All list tags are arrays (even single items)</li> <li>[ ] cis_controls, cci, nist arrays are aligned by position</li> <li>[ ] Only primary CCIs included (not supporting)</li> <li>[ ] No self-references in <code>ref</code> statements</li> <li>[ ] Profile levels use clean format: <code>tag level_1: ['server']</code></li> <li>[ ] No \"cis_\" prefix except on <code>cis_controls</code></li> <li>[ ] Optional tags (stig_requirements) only if data exists</li> </ul>"},{"location":"technical-reference/CIS-INSPEC-PROFILE-STYLE-GUIDE/#see-also","title":"See Also","text":"<ul> <li>OHDF Specification</li> <li>InSpec Profile Documentation</li> <li>CIS Controls Framework</li> <li>NIST SP 800-53</li> </ul>"},{"location":"technical-reference/DATA_MODEL/","title":"CIS Benchmark CLI - Data Model and JSON Schema","text":"<p>Documentation Path</p> <p>You are here: Technical Reference &gt; Data Model</p> <ul> <li>For architecture: See Architecture Overview</li> <li>For data flow: See Data Flow Pipeline</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#overview","title":"Overview","text":"<p>This document defines our canonical data format for CIS benchmarks. All data flows through this format.</p>"},{"location":"technical-reference/DATA_MODEL/#data-flow-architecture","title":"Data Flow Architecture","text":"<pre><code>flowchart LR\n    subgraph Input[\"Input Sources\"]\n        WB[\"CIS WorkBench&lt;br/&gt;(HTML)\"]\n        API[\"CIS API&lt;br/&gt;(JSON navtree)\"]\n        SCAP[\"Future: SCAP\"]\n        EXCEL[\"Future: Excel\"]\n        PDF[\"Future: PDF\"]\n    end\n\n    subgraph Canonical[\"Canonical Format\"]\n        SCHEMA[\"JSON Schema&lt;br/&gt;(Our Format)&lt;br/&gt;VALIDATED\"]\n    end\n\n    subgraph Output[\"Output Formats\"]\n        XCCDF[\"XCCDF XML\"]\n        YAML[\"YAML\"]\n        CSV[\"CSV\"]\n        MD[\"Markdown\"]\n        JSON[\"JSON\"]\n        FUTURE[\"Future formats\"]\n    end\n\n    WB --&gt; SCHEMA\n    API --&gt; SCHEMA\n    SCAP --&gt; SCHEMA\n    EXCEL --&gt; SCHEMA\n    PDF --&gt; SCHEMA\n\n    SCHEMA --&gt; XCCDF\n    SCHEMA --&gt; YAML\n    SCHEMA --&gt; CSV\n    SCHEMA --&gt; MD\n    SCHEMA --&gt; JSON\n    SCHEMA --&gt; FUTURE\n\n    style SCHEMA fill:#90EE90,stroke:#006400,stroke-width:3px\n    style Input fill:#E8F4F8,stroke:#0066CC\n    style Output fill:#FFF4E6,stroke:#CC6600</code></pre> <p>KEY PRINCIPLE: All data MUST validate against our JSON Schema before it can be exported to any format.</p>"},{"location":"technical-reference/DATA_MODEL/#why-json-schema-as-canonical-format","title":"Why JSON Schema as Canonical Format?","text":""},{"location":"technical-reference/DATA_MODEL/#benefits","title":"Benefits","text":"<p>Single Source of Truth</p> <ul> <li>All exporters map from ONE format</li> <li>No exporter-specific logic in scraper</li> <li>Clear contract between components</li> </ul> <p>Validation</p> <ul> <li>Ensure scraped data is complete</li> <li>Catch extraction errors early</li> <li>Verify required fields present</li> </ul> <p>Documentation</p> <ul> <li>Self-documenting data format</li> <li>Clear field definitions</li> <li>Type information</li> </ul> <p>Versioning</p> <ul> <li>Schema v1.0, v2.0 as needs evolve</li> <li>Backward compatibility tracking</li> <li>Migration paths</li> </ul> <p>Code Generation</p> <ul> <li>Can generate Python dataclasses from schema</li> <li>Type hints from schema</li> <li>Validation code auto-generated</li> </ul> <p>Testing</p> <ul> <li>Validate test fixtures</li> <li>Ensure exporters get expected input</li> <li>Clear test assertions</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#our-json-schema","title":"Our JSON Schema","text":""},{"location":"technical-reference/DATA_MODEL/#location","title":"Location","text":"<p><code>cis_bench/models/schema.json</code></p>"},{"location":"technical-reference/DATA_MODEL/#structure","title":"Structure","text":"<pre><code>{\n\"$schema\": \"http://json-schema.org/draft-07/schema#\",\n\"$id\": \"https://github.com/yourusername/cis-benchmark-cli/schemas/benchmark-v1.0.json\",\n\"title\": \"CIS Benchmark\",\n\"description\": \"Canonical data format for CIS Benchmark downloaded from CIS WorkBench\",\n\"type\": \"object\",\n\"required\": [\"title\", \"benchmark_id\", \"url\", \"version\", \"recommendations\"],\n\"properties\": {\n\"title\": {\n\"type\": \"string\",\n\"description\": \"Full benchmark title (e.g., 'CIS Amazon EKS Benchmark v1.8.0')\",\n\"examples\": [\"CIS Amazon EKS Benchmark v1.8.0\", \"CIS NGINX Benchmark vNEXT\"]\n},\n\"benchmark_id\": {\n\"type\": \"string\",\n\"description\": \"CIS WorkBench benchmark ID\",\n\"pattern\": \"^[0-9]+$\",\n\"examples\": [\"22605\", \"18528\"]\n},\n\"url\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Source URL of the benchmark\"\n},\n\"version\": {\n\"type\": \"string\",\n\"description\": \"Benchmark version (extracted from title or metadata)\",\n\"examples\": [\"v1.8.0\", \"vNEXT\", \"v1.0.0\"]\n},\n\"downloaded_at\": {\n\"type\": \"string\",\n\"format\": \"date-time\",\n\"description\": \"ISO 8601 timestamp when benchmark was downloaded\"\n},\n\"scraper_version\": {\n\"type\": \"string\",\n\"description\": \"Scraper strategy version used\",\n\"examples\": [\"v1_2025_10\"]\n},\n\"total_recommendations\": {\n\"type\": \"integer\",\n\"minimum\": 0,\n\"description\": \"Total number of recommendations in benchmark\"\n},\n\"recommendations\": {\n\"type\": \"array\",\n\"description\": \"Array of benchmark recommendations\",\n\"items\": {\n\"$ref\": \"#/$defs/recommendation\"\n}\n}\n},\n\n\"$defs\": {\n\"recommendation\": {\n\"type\": \"object\",\n\"required\": [\"ref\", \"title\", \"url\"],\n\"properties\": {\n\"ref\": {\n\"type\": \"string\",\n\"description\": \"Recommendation reference number\",\n\"pattern\": \"^[0-9]+(\\\\.[0-9]+)*$\",\n\"examples\": [\"3.1.1\", \"5.2.3\"]\n},\n\"title\": {\n\"type\": \"string\",\n\"description\": \"Recommendation title\",\n\"minLength\": 1\n},\n\"url\": {\n\"type\": \"string\",\n\"format\": \"uri\",\n\"description\": \"Direct URL to recommendation page\"\n},\n\"assessment\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Automated scoring/assessment information (may contain HTML)\"\n},\n\"description\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Detailed description of the recommendation (may contain HTML)\"\n},\n\"rationale\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Rationale/justification for the recommendation (may contain HTML)\"\n},\n\"impact\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Impact statement (may contain HTML)\"\n},\n\"audit\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Audit procedure to verify compliance (may contain HTML)\"\n},\n\"remediation\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Remediation steps to achieve compliance (may contain HTML)\"\n},\n\"default_value\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Default configuration value (may contain HTML)\"\n},\n\"artifact_eq\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"Artifact equation (may contain HTML)\"\n},\n\"mitre_mapping\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"MITRE ATT&amp;CK framework mappings (may contain HTML)\"\n},\n\"references\": {\n\"type\": [\"string\", \"null\"],\n\"description\": \"External references and citations (may contain HTML)\"\n}\n},\n\"additionalProperties\": false\n}\n}\n}\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#using-json-schema","title":"Using JSON Schema","text":""},{"location":"technical-reference/DATA_MODEL/#validation","title":"Validation","text":"<pre><code>import json\nimport jsonschema\n\n# Load schema\nwith open('cis_bench/models/schema.json') as f:\nschema = json.load(f)\n\n# Validate scraped data\ntry:\njsonschema.validate(instance=benchmark_data, schema=schema)\nprint(\" Data is valid\")\nexcept jsonschema.ValidationError as e:\nprint(f\" Validation failed: {e.message}\")\nprint(f\" Path: {' '.join(str(p) for p in e.path)}\")\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#data-generation-from-schema","title":"Data Generation from Schema","text":"<p>We can also use tools like <code>datamodel-code-generator</code> to create Python dataclasses from our schema:</p> <pre><code>pip install datamodel-code-generator\n\ndatamodel-codegen \\\n--input cis_bench/models/schema.json \\\n--output cis_bench/models/benchmark.py \\\n--input-file-type jsonschema\n</code></pre> <p>This generates type-safe Python classes that match our schema exactly!</p>"},{"location":"technical-reference/DATA_MODEL/#exporter-mapping","title":"Exporter Mapping","text":"<p>Each exporter knows how to map from our canonical format to its target format:</p>"},{"location":"technical-reference/DATA_MODEL/#json-exporter","title":"JSON Exporter","text":"<pre><code># Simple pass-through (already in our format)\ndef export(self, data, output_path):\nwith open(output_path, 'w') as f:\njson.dump(data, f, indent=2)\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#yaml-exporter","title":"YAML Exporter","text":"<pre><code># Direct mapping (structure is the same)\ndef export(self, data, output_path):\nwith open(output_path, 'w') as f:\nyaml.dump(data, f)\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#csv-exporter","title":"CSV Exporter","text":"<pre><code># Flatten recommendations array\ndef export(self, data, output_path):\nrows = []\nfor rec in data['recommendations']:\nrow = {\n'benchmark_title': data['title'],\n'benchmark_id': data['benchmark_id'],\n'ref': rec['ref'],\n'title': rec['title'],\n# ... flatten all fields\n}\nrows.append(row)\n\n# Write CSV\nwith open(output_path, 'w') as f:\nwriter = csv.DictWriter(f, fieldnames=row.keys())\nwriter.writeheader()\nwriter.writerows(rows)\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#xccdf-exporter","title":"XCCDF Exporter","text":"<pre><code># Map to xsdata XCCDF models\ndef export(self, data, output_path):\nfrom cis_bench.models.xccdf import Benchmark, Rule, Status\n\n# Create XCCDF Benchmark\nxccdf_benchmark = Benchmark(\nid=f\"cis_benchmark_{data['benchmark_id']}\",\nstatus=[Status(value=\"draft\")],\ntitle=data['title'],\nversion=data['version']\n)\n\n# Map each recommendation XCCDF Rule\nfor rec in data['recommendations']:\nrule = Rule(\nid=f\"rule_{rec['ref'].replace('.', '_')}\",\ntitle=rec['title'],\ndescription=strip_html(rec['description']),\n# ... map other fields per XCCDF spec\n)\nxccdf_benchmark.rule.append(rule)\n\n# Serialize to XML\nxml_output = xccdf_benchmark.to_xml(pretty_print=True)\nwith open(output_path, 'w') as f:\nf.write(xml_output)\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#field-definitions","title":"Field Definitions","text":""},{"location":"technical-reference/DATA_MODEL/#benchmark-level","title":"Benchmark Level","text":"Field Type Required Description <code>title</code> string Full benchmark title <code>benchmark_id</code> string CIS WorkBench ID <code>url</code> string (URI) Source URL <code>version</code> string Benchmark version <code>downloaded_at</code> string (ISO 8601) Download timestamp <code>scraper_version</code> string Strategy version used <code>total_recommendations</code> integer Count of recommendations <code>recommendations</code> array Array of recommendation objects"},{"location":"technical-reference/DATA_MODEL/#recommendation-level","title":"Recommendation Level","text":"Field Type Required Description HTML Allowed <code>ref</code> string Reference number (e.g., \"3.1.1\") No <code>title</code> string Recommendation title No <code>url</code> string (URI) Direct link to recommendation No <code>assessment</code> string/null Automated scoring info Yes <code>description</code> string/null Detailed description Yes <code>rationale</code> string/null Justification Yes <code>impact</code> string/null Impact statement Yes <code>audit</code> string/null Audit procedure Yes <code>remediation</code> string/null Remediation steps Yes <code>default_value</code> string/null Default config value Yes <code>artifact_eq</code> string/null Artifact equation Yes <code>mitre_mapping</code> string/null MITRE ATT&amp;CK mappings Yes <code>references</code> string/null External references Yes <p>HTML Allowed: Fields may contain HTML markup that should be:</p> <ul> <li>Preserved in JSON/YAML export</li> <li>Stripped for CSV export</li> <li>Converted to XCCDF-safe format for XCCDF export</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#validation-strategy","title":"Validation Strategy","text":""},{"location":"technical-reference/DATA_MODEL/#when-to-validate","title":"When to Validate","text":"<ol> <li>After scraping - Before saving JSON</li> <li>Before exporting - Ensure input is valid</li> <li>In tests - Validate all fixtures</li> </ol>"},{"location":"technical-reference/DATA_MODEL/#validation-levels","title":"Validation Levels","text":"<p>Strict (for our saved JSON):</p> <ul> <li>All required fields present</li> <li>Types match schema</li> <li>Additional properties not allowed</li> </ul> <p>Lenient (for backward compatibility):</p> <ul> <li>Required fields present</li> <li>Types match when present</li> <li>Additional properties allowed (ignore)</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#schema-evolution","title":"Schema Evolution","text":""},{"location":"technical-reference/DATA_MODEL/#version-100-current","title":"Version 1.0.0 (Current)","text":"<ul> <li>Initial schema</li> <li>Based on current CIS WorkBench fields</li> <li>Includes all 10 recommendation fields</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#version-110-future","title":"Version 1.1.0 (Future)","text":"<ul> <li>Add new fields as CIS WorkBench evolves</li> <li>Maintain backward compatibility</li> <li>Use <code>oneOf</code> for version-specific fields</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#version-200-future","title":"Version 2.0.0 (Future)","text":"<ul> <li>Breaking changes if needed</li> <li>Migration guide provided</li> <li>Tool supports both v1 and v2</li> </ul>"},{"location":"technical-reference/DATA_MODEL/#tools-and-libraries","title":"Tools and Libraries","text":"<p>JSON Schema Validation: <pre><code>pip install jsonschema\n</code></pre></p> <p>Code Generation from Schema: <pre><code>pip install datamodel-code-generator\n</code></pre></p> <p>Schema Documentation: <pre><code>pip install json-schema-for-humans\njson-schema-for-humans cis_bench/models/schema.json docs/schema.html\n</code></pre></p>"},{"location":"technical-reference/DATA_MODEL/#example-complete-benchmark","title":"Example: Complete Benchmark","text":"<pre><code>{\n\"title\": \"CIS Amazon Elastic Kubernetes Service (EKS) Benchmark\",\n\"benchmark_id\": \"22605\",\n\"url\": \"https://workbench.cisecurity.org/benchmarks/22605\",\n\"version\": \"v1.8.0\",\n\"downloaded_at\": \"2025-10-17T21:48:00Z\",\n\"scraper_version\": \"v1_2025_10\",\n\"total_recommendations\": 50,\n\"recommendations\": [\n{\n\"ref\": \"3.1.1\",\n\"title\": \"Ensure that the kubeconfig file permissions are set to 644 or more restrictive\",\n\"url\": \"https://workbench.cisecurity.org/sections/3511915/recommendations/5772605\",\n\"assessment\": \"&lt;p&gt;Automated assessment available&lt;/p&gt;\",\n\"description\": \"&lt;p&gt;If kubelet is running, and if it is configured by a kubeconfig file...&lt;/p&gt;\",\n\"rationale\": \"&lt;p&gt;Improper access permissions could allow...&lt;/p&gt;\",\n\"impact\": \"&lt;p&gt;None expected&lt;/p&gt;\",\n\"audit\": \"&lt;p&gt;Run the following command: &lt;code&gt;stat -c %a /var/lib/kubelet/kubeconfig&lt;/code&gt;&lt;/p&gt;\",\n\"remediation\": \"&lt;p&gt;Run: &lt;code&gt;chmod 644 /var/lib/kubelet/kubeconfig&lt;/code&gt;&lt;/p&gt;\",\n\"default_value\": null,\n\"artifact_eq\": null,\n\"mitre_mapping\": \"&lt;p&gt;T1574.006 - Hijack Execution Flow: Dynamic Linker Hijacking&lt;/p&gt;\",\n\"references\": \"&lt;ul&gt;&lt;li&gt;Kubernetes documentation&lt;/li&gt;&lt;/ul&gt;\"\n}\n// ... 49 more recommendations\n]\n}\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#integration-with-exporters","title":"Integration with Exporters","text":""},{"location":"technical-reference/DATA_MODEL/#baseexporter-contract","title":"BaseExporter Contract","text":"<pre><code>class BaseExporter(ABC):\n@abstractmethod\ndef export(self, data: dict, output_path: str) -&gt; str:\n\"\"\"Export benchmark data.\n\nArgs:\ndata: Dictionary matching cis_bench/models/schema.json\noutput_path: Where to write output\n\nReturns:\nPath to created file\n\nRaises:\njsonschema.ValidationError: If data doesn't match schema\nIOError: If file cannot be written\n\"\"\"\n# All exporters should validate input first\nself._validate_input(data)\n\n# Then perform export\n# ...\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#mapping-examples","title":"Mapping Examples","text":"<p>JSON Schema Field XCCDF Field</p> Our Schema XCCDF Element Notes <code>ref</code> <code>Rule/@id</code> Convert \"3.1.1\" \"rule_3_1_1\" <code>title</code> <code>Rule/title</code> Direct mapping <code>description</code> <code>Rule/description</code> Strip HTML tags <code>rationale</code> <code>Rule/rationale</code> Strip HTML tags <code>audit</code> <code>Rule/check/check-content</code> Strip HTML, wrap in check <code>remediation</code> <code>Rule/fixtext</code> Strip HTML tags <code>mitre_mapping</code> <code>Rule/reference</code> Parse and map to reference elements <p>JSON Schema Field CSV Column</p> <p>All fields flattened to single row: <pre><code>benchmark_title,benchmark_id,ref,title,description,audit,...\n\"CIS Amazon EKS\",\"22605\",\"3.1.1\",\"Ensure...\",\"If kubelet...\",\"Run...\",...\n</code></pre></p>"},{"location":"technical-reference/DATA_MODEL/#validation-implementation","title":"Validation Implementation","text":""},{"location":"technical-reference/DATA_MODEL/#in-workbenchscraper","title":"In WorkbenchScraper","text":"<pre><code>import jsonschema\n\nclass WorkbenchScraper:\ndef __init__(self, session, schema_path='cis_bench/models/schema.json'):\nself.session = session\n\n# Load schema\nwith open(schema_path) as f:\nself.schema = json.load(f)\n\ndef download_benchmark(self, benchmark_url):\n# ... scraping logic ...\n\nbenchmark_data = {\n'title': title,\n'benchmark_id': benchmark_id,\n'recommendations': recommendations,\n# ...\n}\n\n# VALIDATE before returning\ntry:\njsonschema.validate(instance=benchmark_data, schema=self.schema)\nexcept jsonschema.ValidationError as e:\nraise ValueError(f\"Scraped data validation failed: {e.message}\")\n\nreturn benchmark_data\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#in-exporters","title":"In Exporters","text":"<pre><code>class BaseExporter(ABC):\ndef _validate_input(self, data: dict):\n\"\"\"Validate input data against schema.\"\"\"\nwith open('cis_bench/models/schema.json') as f:\nschema = json.load(f)\n\njsonschema.validate(instance=data, schema=schema)\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#schema-files","title":"Schema Files","text":"<p>We'll maintain multiple schema versions:</p> <pre><code>cis_bench/models/\n\u251c\u2500\u2500 schema.json # Current schema (symlink to v1.0.0)\n\u251c\u2500\u2500 schemas/\n\u2502 \u251c\u2500\u2500 v1.0.0.json # Version 1.0.0\n\u2502 \u251c\u2500\u2500 v1.1.0.json # Version 1.1.0 (future)\n\u2502 \u2514\u2500\u2500 v2.0.0.json # Version 2.0.0 (future)\n\u2514\u2500\u2500 schema_validator.py # Validation utilities\n</code></pre>"},{"location":"technical-reference/DATA_MODEL/#benefits-in-practice","title":"Benefits in Practice","text":""},{"location":"technical-reference/DATA_MODEL/#before-no-schema","title":"Before (No Schema)","text":"<pre><code>flowchart LR\n    A[Scraper extracts data] --&gt; B[Export to XCCDF]\n    B --&gt; C[\u274c Missing field!&lt;br/&gt;XCCDF invalid!&lt;br/&gt;Debug for hours...]\n\n    style C fill:#FFE0E0,stroke:#CC0000,stroke-width:2px</code></pre>"},{"location":"technical-reference/DATA_MODEL/#after-with-schema","title":"After (With Schema)","text":"<pre><code>flowchart LR\n    A[Scraper extracts data] --&gt; B{Validate against schema}\n    B --&gt;|Invalid| C[\u274c Missing 'title' field!&lt;br/&gt;Validation fails immediately&lt;br/&gt;Fix scraper in minutes]\n    C --&gt; D[Re-scrape]\n    D --&gt; E{Validates}\n    E --&gt;|Valid| F[Export to XCCDF]\n    F --&gt; G[\u2705 Valid XCCDF]\n\n    style C fill:#FFE0E0,stroke:#CC0000,stroke-width:2px\n    style G fill:#E0FFE0,stroke:#00CC00,stroke-width:2px\n    style E fill:#E8F4F8,stroke:#0066CC,stroke-width:2px\n    style B fill:#E8F4F8,stroke:#0066CC,stroke-width:2px</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/","title":"MappingEngine Design Document","text":"<p>Documentation Path</p> <p>You are here: Technical Reference &gt; MappingEngine Design (Technical Architecture)</p> <ul> <li>For practical guide: See MappingEngine User Guide</li> <li>For system overview: See Data Flow Pipeline</li> </ul> <p>This design document describes the technical architecture. The system implements the config-driven, loop-driven approach specified here.</p>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#overview","title":"Overview","text":"<p>The MappingEngine is a configuration-driven transformation engine that maps CIS Benchmark data to various XCCDF export styles (DISA STIG-compatible, CIS Native, etc.). It reads YAML configuration files that define field mappings, transformations, and composite field assembly.</p>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#purpose","title":"Purpose","text":"<ul> <li>Read YAML configurations that define how to map our Pydantic data models to XCCDF structures</li> <li>Apply transformations (strip_html, html_to_markdown, composite field assembly)</li> <li>Handle complex XCCDF structures (embedded XML tags, nested elements, variable substitution)</li> <li>Support multiple export styles without changing code (just swap YAML config)</li> <li>Be extensible for new transformations and field types</li> </ul>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#architecture","title":"Architecture","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#high-level-data-flow","title":"High-Level Data Flow","text":"<pre><code>flowchart TD\n    subgraph Input[\"Input\"]\n        PYDANTIC[\"Benchmark Data\"]\n    end\n\n    subgraph Processing[\"MappingEngine Processing\"]\n        CONFIG[\"Load Configuration\"]\n        MAPPER[\"Map Fields\"]\n        TRANSFORM[\"Apply Transforms\"]\n        VARS[\"Substitute Variables\"]\n        XML[\"Build XML Structure\"]\n\n        CONFIG --&gt; MAPPER\n        MAPPER --&gt; TRANSFORM\n        TRANSFORM --&gt; VARS\n        VARS --&gt; XML\n    end\n\n    subgraph Output[\"Output\"]\n        XCCDF[\"XCCDF Output\"]\n    end\n\n    PYDANTIC --&gt; CONFIG\n    XML --&gt; XCCDF\n\n    style Input fill:#E8F4F8,stroke:#0066CC\n    style Processing fill:#fff4e1,stroke:#ff9800\n    style Output fill:#FFF4E6,stroke:#CC6600</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#component-relationships","title":"Component Relationships","text":"<p>Main Processing Pipeline:</p> <pre><code>flowchart LR\n    CONFIG[\"ConfigLoader&lt;br/&gt;Load YAML&lt;br/&gt;Validate schema\"]\n    MAPPER[\"FieldMapper&lt;br/&gt;Map source to target&lt;br/&gt;Resolve paths\"]\n    PIPELINE[\"TransformPipeline&lt;br/&gt;Apply transforms\"]\n    VARS[\"VariableSubstituter&lt;br/&gt;Resolve variables\"]\n    BUILDER[\"XMLStructureBuilder&lt;br/&gt;Build XCCDF\"]\n\n    CONFIG --&gt; MAPPER\n    MAPPER --&gt; PIPELINE\n    PIPELINE --&gt; VARS\n    VARS --&gt; BUILDER\n\n    style CONFIG fill:#e3f2fd,stroke:#1976d2,stroke-width:2px\n    style MAPPER fill:#fff3e0,stroke:#f57c00,stroke-width:2px\n    style PIPELINE fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px\n    style VARS fill:#e8f5e9,stroke:#388e3c,stroke-width:2px\n    style BUILDER fill:#fff9c4,stroke:#f57f17,stroke-width:2px</code></pre> <p>Available Transformers:</p> <ul> <li>StripHTML - Remove HTML tags</li> <li>Markdown - Convert HTML to Markdown</li> <li>Composite - Combine multiple fields</li> <li>Custom - User-defined transformations</li> </ul> <p>Field Mapping Strategies:</p> <pre><code>flowchart TD\n    ABC[\"Base Strategy Pattern\"]\n\n    ABC --&gt; SIMPLE[\"Simple Mapping&lt;br/&gt;Direct field copy\"]\n    ABC --&gt; COMPOSITE[\"Composite Mapping&lt;br/&gt;Combine multiple fields\"]\n    ABC --&gt; EMBEDDED[\"Embedded XML&lt;br/&gt;Nested structure\"]\n    ABC --&gt; CCI[\"CCI Lookup&lt;br/&gt;DoD compliance\"]\n\n    style ABC fill:#e8f5e9,stroke:#388e3c,stroke-width:3px\n    style SIMPLE fill:#e3f2fd,stroke:#1976d2\n    style COMPOSITE fill:#fff3e0,stroke:#f57c00\n    style EMBEDDED fill:#f3e5f5,stroke:#7b1fa2\n    style CCI fill:#ffebee,stroke:#c62828</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#class-structure","title":"Class Structure","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#1-core-mappingengine","title":"1. Core: MappingEngine","text":"<pre><code>class MappingEngine:\n\"\"\"Configuration-driven mapping engine for transforming Pydantic models to XCCDF.\n\nResponsibilities:\n\n- Load YAML configuration files\n- Coordinate mapping process\n- Apply transformations\n- Build XCCDF structures\n\nUsage:\nengine = MappingEngine.from_config('disa_style.yaml')\nxccdf_benchmark = engine.map_benchmark(pydantic_benchmark)\n\"\"\"\n\ndef __init__(self, config: MappingConfig):\n\"\"\"Initialize engine with loaded configuration.\"\"\"\nself.config = config\nself.field_mapper = FieldMapper(config.field_mappings)\nself.transform_registry = TransformRegistry()\nself.variable_substituter = VariableSubstituter()\n\n@classmethod\ndef from_config(cls, config_path: str) -&gt; 'MappingEngine':\n\"\"\"Factory method: Load config and create engine.\"\"\"\nconfig = ConfigLoader.load(config_path)\nreturn cls(config)\n\ndef map_benchmark(self, benchmark: Benchmark) -&gt; XCCDFBenchmark:\n\"\"\"Map Pydantic Benchmark to XCCDF Benchmark.\n\nArgs:\nbenchmark: Validated Pydantic Benchmark model\n\nReturns:\nxsdata XCCDF Benchmark ready for XML serialization\n\"\"\"\n\ndef map_rule(self, recommendation: Recommendation, context: MappingContext) -&gt; Rule:\n\"\"\"Map single Recommendation to XCCDF Rule.\n\nArgs:\nrecommendation: Pydantic Recommendation model\ncontext: Mapping context (variables for substitution)\n\nReturns:\nxsdata XCCDF Rule\n\"\"\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#2-configuration-configloader-and-mappingconfig","title":"2. Configuration: ConfigLoader and MappingConfig","text":"<pre><code>@dataclass\nclass MappingConfig:\n\"\"\"Parsed YAML configuration.\n\nStructure matches YAML file:\n\n- metadata: Style info\n- benchmark: Benchmark-level mappings\n- rule_defaults: Default rule attributes\n- rule_id: ID generation template\n- field_mappings: Core field mapping definitions\n- transformations: Transform function definitions\n- validation: Validation rules\n\"\"\"\n\nstyle_name: str\ndescription: str\nxccdf_version: str\n\nbenchmark_mappings: Dict[str, FieldMapping]\nrule_defaults: Dict[str, Any]\nrule_id_template: str\n\nfield_mappings: Dict[str, FieldMapping]\ntransformations: Dict[str, TransformDef]\n\ncci_lookup: Optional[CCILookupConfig] = None\nvalidation: Optional[ValidationConfig] = None\n\nclass ConfigLoader:\n\"\"\"Load and validate YAML configuration files.\"\"\"\n\n@staticmethod\ndef load(config_path: str) -&gt; MappingConfig:\n\"\"\"Load YAML and parse into MappingConfig.\n\nValidates:\n\n- YAML syntax\n- Required sections present\n- Field mapping structure\n- Transform definitions valid\n\nRaises:\nConfigValidationError: If config is invalid\n\"\"\"\n\n@staticmethod\ndef validate_config(config_dict: dict) -&gt; None:\n\"\"\"Validate configuration structure.\"\"\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#3-field-mapping-fieldmapper","title":"3. Field Mapping: FieldMapper","text":"<pre><code>@dataclass\nclass FieldMapping:\n\"\"\"Definition of how to map one field.\n\nTypes of mappings:\n1. Simple: source_field target_element (with optional transform)\n2. Composite: multiple sources one target (VulnDiscussion)\n3. Embedded XML: nested XML tags within XCCDF element\n4. Lookup-based: CCI lookup, NIST deduplication\n5. Template-based: Variable substitution\n\"\"\"\n\ntarget_element: str\nsource_field: Optional[str] = None\ntransform: Optional[str] = None\nstructure: Optional[str] = None # 'embedded_xml_tags', 'nested', 'dublin_core'\nmultiple: bool = False\n\n# For composite/embedded structures\ncomponents: Optional[List[ComponentMapping]] = None\n\n# For attributes\nattributes: Optional[Dict[str, str]] = None\n\n# For static content\ncontent: Optional[str] = None\n\n# For conditional mapping\noptional: bool = False\ncondition: Optional[str] = None\n\n@dataclass\nclass ComponentMapping:\n\"\"\"Component of a composite or embedded XML mapping.\"\"\"\n\ntag: Optional[str] = None # For embedded XML\nelement: Optional[str] = None # For nested elements\n\nsources: Optional[List[SourceDef]] = None\ncontent: Optional[str] = None\n\ncombine: Optional[str] = None # 'join', 'concat', etc.\nseparator: str = \"\\n\\n\"\n\nattributes: Optional[Dict[str, str]] = None\noptional: bool = False\n\n@dataclass\nclass SourceDef:\n\"\"\"Source field with transformation.\"\"\"\nfield: str\ntransform: Optional[str] = None\nseparator: str = \"\"\n\nclass FieldMapper:\n\"\"\"Maps fields from source models to target structures.\n\nResponsibilities:\n\n- Resolve source field paths (nested attributes)\n- Apply field-level transformations\n- Handle composite field assembly\n- Build nested/embedded structures\n\"\"\"\n\ndef __init__(self, field_mappings: Dict[str, FieldMapping]):\nself.mappings = field_mappings\n\ndef map_field(self,\nmapping: FieldMapping,\nsource_obj: Any,\ncontext: MappingContext) -&gt; Any:\n\"\"\"Map a single field from source to target.\n\nHandles:\n\n- Simple field extraction\n- Composite field assembly\n- Embedded XML structure\n- Variable substitution in templates\n\nReturns:\nMapped value ready for XCCDF model\n\"\"\"\n\ndef resolve_source_value(self, source_field: str, source_obj: Any) -&gt; Any:\n\"\"\"Resolve potentially nested field path.\n\nExamples:\n'title' source_obj.title\n'mitre_mapping.techniques' source_obj.mitre_mapping.techniques\n'cis_controls[0].control' source_obj.cis_controls[0].control\n\"\"\"\n\ndef build_composite_field(self,\ncomponents: List[ComponentMapping],\nsource_obj: Any,\ncontext: MappingContext) -&gt; str:\n\"\"\"Build composite field from multiple sources.\n\nExample: VulnDiscussion = description + rationale\n\"\"\"\n\ndef build_embedded_xml_structure(self,\ncomponents: List[ComponentMapping],\nsource_obj: Any,\ncontext: MappingContext) -&gt; str:\n\"\"\"Build embedded XML tags within text content.\n\nExample: &lt;description&gt;\n&lt;VulnDiscussion&gt;...&lt;/VulnDiscussion&gt;\n&lt;FalsePositives/&gt;\n&lt;Mitigations&gt;...&lt;/Mitigations&gt;\n&lt;/description&gt;\n\"\"\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#4-transformation-transformpipeline-and-transformers","title":"4. Transformation: TransformPipeline and Transformers","text":"<pre><code>class TransformRegistry:\n\"\"\"Registry of available transformations.\n\nBuilt-in transformations:\n\n- none: Pass through unchanged\n- strip_html: Remove all HTML tags\n- strip_html_keep_code: Strip HTML but preserve code blocks\n- html_to_markdown: Convert HTML to Markdown\n\nExtensible: Register custom transforms\n\"\"\"\n\ndef __init__(self):\nself._transforms: Dict[str, Callable] = {}\nself._register_builtin_transforms()\n\ndef register(self, name: str, transform_func: Callable):\n\"\"\"Register custom transformation.\"\"\"\n\ndef get_transform(self, name: str) -&gt; Callable:\n\"\"\"Get transformation function by name.\"\"\"\n\ndef apply(self, transform_name: str, value: Any, **kwargs) -&gt; Any:\n\"\"\"Apply transformation to value.\"\"\"\n\nclass TransformPipeline:\n\"\"\"Apply series of transformations to field values.\"\"\"\n\ndef __init__(self, registry: TransformRegistry):\nself.registry = registry\n\ndef apply_transform(self, transform_name: str, value: Any) -&gt; Any:\n\"\"\"Apply single transformation.\"\"\"\n\ndef apply_chain(self, transforms: List[str], value: Any) -&gt; Any:\n\"\"\"Apply chain of transformations in order.\"\"\"\n\n# Built-in transformers\nclass HTMLCleaner:\n\"\"\"HTML transformation utilities.\"\"\"\n\n@staticmethod\ndef strip_html(html: Optional[str]) -&gt; str:\n\"\"\"Remove all HTML tags, return plain text.\"\"\"\n\n@staticmethod\ndef strip_html_keep_code(html: Optional[str]) -&gt; str:\n\"\"\"Strip HTML but preserve code blocks and lists.\"\"\"\n\n@staticmethod\ndef html_to_markdown(html: Optional[str]) -&gt; str:\n\"\"\"Convert HTML to Markdown format.\"\"\"\n\nclass CompositeTransformer:\n\"\"\"Build composite fields from multiple sources.\"\"\"\n\n@staticmethod\ndef join_with_separator(values: List[str], separator: str = \"\\n\\n\") -&gt; str:\n\"\"\"Join non-empty values with separator.\"\"\"\n\n@staticmethod\ndef concat(values: List[str]) -&gt; str:\n\"\"\"Concatenate values with no separator.\"\"\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#5-variable-substitution-variablesubstituter","title":"5. Variable Substitution: VariableSubstituter","text":"<pre><code>class VariableSubstituter:\n\"\"\"Substitute variables in templates with actual values.\n\nVariables:\n\n- {ref}: Original ref (e.g., \"3.1.1\")\n- {ref_normalized}: Normalized ref (e.g., \"3_1_1\")\n- {platform}: Benchmark platform\n- {control.version}: CIS Control version\n- {control.control}: CIS Control ID\n- {nist_control_id}: NIST control ID\n\nUsed in:\n\n- ID templates: \"xccdf_cis_{platform}_rule_{ref_normalized}\"\n- Attributes: fixref=\"F-{ref_normalized}\"\n- Content: \"{control.title}\"\n\"\"\"\n\ndef substitute(self, template: str, context: MappingContext) -&gt; str:\n\"\"\"Substitute all variables in template.\n\nArgs:\ntemplate: String with {variable} placeholders\ncontext: Mapping context with variable values\n\nReturns:\nString with variables replaced\n\"\"\"\n\ndef normalize_ref(self, ref: str) -&gt; str:\n\"\"\"Convert ref to normalized form: 3.1.1 3_1_1\"\"\"\nreturn ref.replace('.', '_')\n\ndef extract_platform(self, title: str) -&gt; str:\n\"\"\"Extract platform from benchmark title.\"\"\"\n\n@dataclass\nclass MappingContext:\n\"\"\"Context for variable substitution and conditional logic.\n\nContains:\n\n- Current recommendation being mapped\n- Benchmark-level metadata\n- Generated IDs and references\n- Loop iteration variables (for multiple elements)\n\"\"\"\n\nrecommendation: Recommendation\nbenchmark: Benchmark\nplatform: str\nref_normalized: str\n\n# For iterating over collections\ncurrent_control: Optional[CISControl] = None\ncurrent_nist: Optional[str] = None\ncurrent_technique: Optional[str] = None\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#6-strategy-pattern-mappingstrategy","title":"6. Strategy Pattern: MappingStrategy","text":"<pre><code>class MappingStrategy(ABC):\n\"\"\"Abstract base for field mapping strategies.\n\nDifferent strategies for different field types:\n\n- SimpleFieldStrategy: Direct field mapping\n- CompositeFieldStrategy: Multiple sources one target\n- EmbeddedXMLStrategy: Nested XML tags\n- CCILookupStrategy: CCI/NIST deduplication logic\n- NestedElementStrategy: Nested XCCDF elements\n\"\"\"\n\n@abstractmethod\ndef apply(self,\nmapping: FieldMapping,\nsource_obj: Any,\ncontext: MappingContext) -&gt; Any:\n\"\"\"Apply this mapping strategy.\"\"\"\n\nclass SimpleFieldStrategy(MappingStrategy):\n\"\"\"Simple field: source target with optional transform.\"\"\"\n\ndef apply(self, mapping: FieldMapping, source_obj: Any, context: MappingContext) -&gt; Any:\n# Get source value\nvalue = getattr(source_obj, mapping.source_field)\n\n# Apply transformation\nif mapping.transform:\nvalue = transform_registry.apply(mapping.transform, value)\n\n# Substitute variables\nif isinstance(value, str) and '{' in value:\nvalue = variable_substituter.substitute(value, context)\n\nreturn value\n\nclass CompositeFieldStrategy(MappingStrategy):\n\"\"\"Composite field: multiple sources joined together.\"\"\"\n\ndef apply(self, mapping: FieldMapping, source_obj: Any, context: MappingContext) -&gt; Any:\n# Extract all source values\nvalues = []\nfor source_def in mapping.sources:\nvalue = getattr(source_obj, source_def.field)\n\n# Apply transform to each source\nif source_def.transform:\nvalue = transform_registry.apply(source_def.transform, value)\n\nif value:\nvalues.append(value)\n\n# Join with separator\nreturn mapping.separator.join(values)\n\nclass EmbeddedXMLStrategy(MappingStrategy):\n\"\"\"Embedded XML: Build XML tags within XCCDF description element.\"\"\"\n\ndef apply(self, mapping: FieldMapping, source_obj: Any, context: MappingContext) -&gt; str:\n# Build embedded XML structure\nxml_parts = []\n\nfor component in mapping.components:\ntag = component.tag\n\nif component.content:\n# Static content\nxml_parts.append(f\"&lt;{tag}&gt;{component.content}&lt;/{tag}&gt;\")\n\nelif component.sources:\n# Dynamic content from sources\nvalues = []\nfor source_def in component.sources:\nvalue = getattr(source_obj, source_def.field, None)\nif value and source_def.transform:\nvalue = transform_registry.apply(source_def.transform, value)\nif value:\nvalues.append(value)\n\nif values or not component.optional:\ncontent = component.separator.join(values)\nxml_parts.append(f\"&lt;{tag}&gt;{content}&lt;/{tag}&gt;\")\n\nreturn \"\\n\".join(xml_parts)\n\nclass CCILookupStrategy(MappingStrategy):\n\"\"\"CCI lookup with NIST deduplication.\"\"\"\n\ndef __init__(self, cci_service: CCILookupService):\nself.cci_service = cci_service\n\ndef apply(self, mapping: FieldMapping, source_obj: Any, context: MappingContext) -&gt; List[str]:\n# Get CIS control IDs\ncis_control_ids = [c.control for c in source_obj.cis_controls]\n\n# Get cited NIST controls\ncited_nist = source_obj.nist_controls\n\n# Deduplicate: Get CCIs and extra NIST controls\nccis, extra_nist = self.cci_service.deduplicate_nist_controls(\ncis_control_ids, cited_nist\n)\n\nreturn ccis\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#7-error-handling-mappingerror","title":"7. Error Handling: MappingError","text":"<pre><code>class MappingError(Exception):\n\"\"\"Base exception for mapping errors.\"\"\"\npass\n\nclass ConfigValidationError(MappingError):\n\"\"\"YAML configuration is invalid.\"\"\"\npass\n\nclass FieldMappingError(MappingError):\n\"\"\"Error mapping specific field.\"\"\"\n\ndef __init__(self, field_name: str, reason: str):\nself.field_name = field_name\nsuper().__init__(f\"Failed to map field '{field_name}': {reason}\")\n\nclass TransformError(MappingError):\n\"\"\"Error applying transformation.\"\"\"\n\ndef __init__(self, transform_name: str, reason: str):\nself.transform_name = transform_name\nsuper().__init__(f\"Transform '{transform_name}' failed: {reason}\")\n\nclass VariableSubstitutionError(MappingError):\n\"\"\"Variable not found in context.\"\"\"\n\ndef __init__(self, variable: str, template: str):\nself.variable = variable\nsuper().__init__(f\"Variable '{variable}' not found in template: {template}\")\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#key-method-signatures","title":"Key Method Signatures","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#mappingenginemap_benchmark","title":"MappingEngine.map_benchmark()","text":"<pre><code>def map_benchmark(self, benchmark: Benchmark) -&gt; XCCDFBenchmark:\n\"\"\"\nHigh-level algorithm:\n\n1. Create mapping context with benchmark metadata\n\n- Extract platform from title\n- Set up variable substitution context\n\n2. Map benchmark-level fields\n\n- id (using id_template)\n- title\n- description\n- version\n- status\n\n3. Map each recommendation to XCCDF Rule\n\n- Create rule-specific context (ref, ref_normalized)\n- Apply rule_defaults (severity, weight)\n- Map all fields per field_mappings config\n- Handle composite fields (VulnDiscussion)\n- Handle embedded XML (description tags)\n- Handle CCI/NIST deduplication\n- Handle metadata namespace\n\n4. Assemble XCCDF Benchmark\n\n- Create xsdata Benchmark object\n- Add all rules\n- Return schema-compliant XCCDF\n\nReturns:\nXCCDFBenchmark: xsdata model ready for XML serialization\n\nRaises:\nMappingError: If mapping fails for any field\nValidationError: If result doesn't validate\n\"\"\"\n\n# 1. Setup context\ncontext = MappingContext(\nbenchmark=benchmark,\nplatform=self._extract_platform(benchmark.title),\nrecommendation=None # Set per-rule\n)\n\n# 2. Map benchmark\nbenchmark_id = self.variable_substituter.substitute(\nself.config.benchmark_mappings['id_template'],\ncontext\n)\n\nxccdf_benchmark = XCCDFBenchmark(\nid=benchmark_id,\nstatus=[Status(value=\"draft\")],\ntitle=[TextType(value=benchmark.title)],\ndescription=[HtmlTextWithSubType(content=[benchmark.title])],\nversion=VersionType(value=benchmark.version)\n)\n\n# 3. Map rules\nrules = []\nfor rec in benchmark.recommendations:\ncontext.recommendation = rec\ncontext.ref_normalized = self.variable_substituter.normalize_ref(rec.ref)\n\nrule = self.map_rule(rec, context)\nrules.append(rule)\n\nxccdf_benchmark.rule = rules\n\n# 4. Return\nreturn xccdf_benchmark\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#mappingenginemap_rule","title":"MappingEngine.map_rule()","text":"<pre><code>def map_rule(self, recommendation: Recommendation, context: MappingContext) -&gt; Rule:\n\"\"\"\nAlgorithm:\n\n1. Generate rule ID from template\n2. Apply rule defaults (severity, weight, selected)\n3. For each field in field_mappings:\na. Determine mapping strategy (simple/composite/embedded/lookup)\nb. Apply strategy to map field\nc. Apply transformations\nd. Substitute variables\ne. Build XCCDF element\n4. Assemble Rule object\n5. Validate and return\n\nReturns:\nRule: xsdata XCCDF Rule\n\"\"\"\n\n# 1. Generate ID\nrule_id = self.variable_substituter.substitute(\nself.config.rule_id_template,\ncontext\n)\n\n# 2. Create Rule with defaults\nrule = Rule(\nid=rule_id,\nseverity=self.config.rule_defaults.get('severity', 'medium'),\nweight=self.config.rule_defaults.get('weight', '10.0'),\nselected=self.config.rule_defaults.get('selected', True)\n)\n\n# 3. Map each field\nfor field_name, mapping in self.config.field_mappings.items():\ntry:\n# Choose strategy\nstrategy = self._get_strategy_for_mapping(mapping)\n\n# Apply strategy\nvalue = strategy.apply(mapping, recommendation, context)\n\n# Set on rule\nself._set_rule_attribute(rule, mapping.target_element, value)\n\nexcept Exception as e:\nraise FieldMappingError(field_name, str(e))\n\n# 4. Return\nreturn rule\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#fieldmappermap_field","title":"FieldMapper.map_field()","text":"<pre><code>def map_field(self, mapping: FieldMapping, source_obj: Any, context: MappingContext) -&gt; Any:\n\"\"\"\nAlgorithm:\n\n1. Determine field type/structure\n\n- Simple field\n- Composite field\n- Embedded XML\n- Nested elements\n- Lookup-based\n\n2. Route to appropriate builder\n\n3. Apply transformations\n\n4. Substitute variables\n\n5. Return mapped value\n\"\"\"\n\n# 1. Check structure type\nif mapping.structure == 'embedded_xml_tags':\nreturn self.build_embedded_xml_structure(\nmapping.components,\nsource_obj,\ncontext\n)\n\nelif mapping.structure == 'nested':\nreturn self.build_nested_structure(\nmapping.children,\nsource_obj,\ncontext\n)\n\nelif mapping.source_logic:\n# Special logic (CCI lookup, etc.)\nreturn self._apply_source_logic(mapping, source_obj, context)\n\nelif mapping.components:\n# Composite field\nreturn self.build_composite_field(\nmapping.components,\nsource_obj,\ncontext\n)\n\nelse:\n# Simple field\nvalue = self.resolve_source_value(mapping.source_field, source_obj)\n\n# Transform\nif mapping.transform:\nvalue = self.transform_pipeline.apply_transform(\nmapping.transform,\nvalue\n)\n\n# Variable substitution\nif isinstance(value, str):\nvalue = self.variable_substituter.substitute(value, context)\n\nreturn value\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#fieldmapperbuild_embedded_xml_structure","title":"FieldMapper.build_embedded_xml_structure()","text":"<pre><code>def build_embedded_xml_structure(self,\ncomponents: List[ComponentMapping],\nsource_obj: Any,\ncontext: MappingContext) -&gt; str:\n\"\"\"\nBuild embedded XML tags within XCCDF description element.\n\nAlgorithm:\n\n1. For each component:\na. Extract tag name\nb. Get content (static or from sources)\nc. Apply transformations\nd. Build XML tag\ne. Handle optional tags (skip if no content)\n\n2. Join all tags\n\n3. Return as single string\n\nExample output:\n&lt;VulnDiscussion&gt;Combined description and rationale&lt;/VulnDiscussion&gt;\n&lt;FalsePositives&gt;&lt;/FalsePositives&gt;\n&lt;Mitigations&gt;Additional info content&lt;/Mitigations&gt;\n&lt;IAControls&gt;&lt;/IAControls&gt;\n\"\"\"\n\nxml_parts = []\n\nfor component in components:\ntag = component.tag\n\n# Static content\nif component.content is not None:\nxml_parts.append(f\"&lt;{tag}&gt;{component.content}&lt;/{tag}&gt;\")\ncontinue\n\n# Dynamic content from sources\nif component.sources:\nvalues = []\n\nfor source_def in component.sources:\nvalue = self.resolve_source_value(source_def.field, source_obj)\n\n# Transform\nif source_def.transform:\nvalue = self.transform_pipeline.apply_transform(\nsource_def.transform,\nvalue\n)\n\nif value:\nvalues.append(value)\n\n# Join values\nif values:\ncontent = source_def.separator.join(values)\nxml_parts.append(f\"&lt;{tag}&gt;{content}&lt;/{tag}&gt;\")\n\nelif not component.optional:\n# Required but empty\nxml_parts.append(f\"&lt;{tag}&gt;&lt;/{tag}&gt;\")\n\nreturn \"\\n\".join(xml_parts)\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#configuration-processing","title":"Configuration Processing","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#how-yaml-config-is-processed","title":"How YAML Config is Processed","text":"<pre><code># Example: Processing disa_style.yaml\n\n# 1. Load YAML\nwith open('disa_style.yaml') as f:\nconfig_dict = yaml.safe_load(f)\n\n# 2. Parse into structured objects\nconfig = MappingConfig(\nstyle_name=config_dict['metadata']['style_name'],\nbenchmark_mappings={\n'id': FieldMapping(\ntarget_element='id',\nsource_field=None, # Generated from template\ntemplate=config_dict['benchmark']['id_template']\n),\n'title': FieldMapping(\ntarget_element='title',\nsource_field='title',\ntransform='none'\n)\n},\nfield_mappings={\n'description': FieldMapping(\ntarget_element='description',\nstructure='embedded_xml_tags',\ncomponents=[\nComponentMapping(\ntag='VulnDiscussion',\nsources=[\nSourceDef(field='description', transform='strip_html'),\nSourceDef(field='rationale', transform='strip_html')\n],\nseparator='\\n\\n'\n),\nComponentMapping(\ntag='FalsePositives',\ncontent=''\n),\n# ... more components\n]\n),\n'fixtext': FieldMapping(\ntarget_element='fixtext',\nsource_field='remediation',\ntransform='strip_html_keep_code',\nattributes={\n'fixref': 'F-{ref_normalized}'\n}\n),\n# ... more mappings\n},\ntransformations={\n'strip_html': TransformDef(\ndescription='Remove all HTML tags',\nfunction='HTMLCleaner.strip_html'\n),\n# ... more transforms\n}\n)\n\n# 3. Create engine with config\nengine = MappingEngine(config)\n\n# 4. Use engine to map\nxccdf_benchmark = engine.map_benchmark(pydantic_benchmark)\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#transformation-pipeline","title":"Transformation Pipeline","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#how-transformations-are-applied","title":"How Transformations are Applied","text":"<pre><code># Example: strip_html transformation\n\n# 1. YAML defines transform\ntransformations:\nstrip_html:\ndescription: \"Remove all HTML tags, return plain text\"\nfunction: \"HTMLCleaner.strip_html\"\n\n# 2. Transform registered in registry\ntransform_registry.register('strip_html', HTMLCleaner.strip_html)\n\n# 3. Field mapping specifies transform\nfield_mappings:\ndescription:\nsource_field: \"description\"\ntransform: \"strip_html\"\n\n# 4. During mapping, transform is applied\nvalue = recommendation.description # \"&lt;p&gt;This is &lt;strong&gt;text&lt;/strong&gt;&lt;/p&gt;\"\ntransformed = transform_registry.apply('strip_html', value)\n# Result: \"This is text\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#transform-chain-example","title":"Transform Chain Example","text":"<pre><code># Apply multiple transforms in sequence\ntransform_pipeline.apply_chain(\n['strip_html', 'html_to_markdown'],\nvalue\n)\n\n# Equivalent to:\nvalue = strip_html(value)\nvalue = html_to_markdown(value)\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#variable-substitution","title":"Variable Substitution","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#how-variables-are-resolved","title":"How Variables are Resolved","text":"<pre><code># Example: Rule ID generation\n\n# 1. YAML template\nrule_id:\ntemplate: \"xccdf_cis_{platform}_rule_{ref_normalized}\"\n\n# 2. Context has variables\ncontext = MappingContext(\nbenchmark=benchmark,\nrecommendation=rec,\nplatform=\"eks\", # Extracted from title\nref_normalized=\"3_1_1\" # From rec.ref \"3.1.1\"\n)\n\n# 3. Substitute variables\nrule_id = variable_substituter.substitute(\n\"xccdf_cis_{platform}_rule_{ref_normalized}\",\ncontext\n)\n# Result: \"xccdf_cis_eks_rule_3_1_1\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#nested-variable-access","title":"Nested Variable Access","text":"<pre><code># YAML\nattributes:\nversion: \"{control.version}\"\nid: \"{control.control}\"\n\n# Code\ncontext.current_control = CISControl(version=8, control=\"4.8\", ...)\n\nattribute_value = variable_substituter.substitute(\n\"{control.version}\",\ncontext\n)\n# Result: \"8\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#error-handling-strategy","title":"Error Handling Strategy","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#validation-points","title":"Validation Points","text":"<p>Config Load Time</p> <ul> <li>YAML syntax valid</li> <li>Required sections present</li> <li>Field mappings well-formed</li> <li>Transform functions exist</li> </ul> <p>Mapping Time</p> <ul> <li>Source fields exist</li> <li>Transformations succeed</li> <li>Variables can be resolved</li> <li>Required fields populated</li> </ul> <p>Output Time</p> <ul> <li>XCCDF validates against schema</li> <li>All required elements present</li> <li>IDs unique and valid</li> </ul>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#error-handling-example","title":"Error Handling Example","text":"<pre><code>try:\n# Load config\nconfig = ConfigLoader.load('disa_style.yaml')\n\n# Create engine\nengine = MappingEngine(config)\n\n# Map benchmark\nxccdf_benchmark = engine.map_benchmark(pydantic_benchmark)\n\n# Serialize to XML\nxml_output = xccdf_benchmark.to_xml()\n\nexcept ConfigValidationError as e:\nlogger.error(f\"Invalid configuration: {e}\")\nlogger.error(f\"File: {e.config_path}\")\nlogger.error(f\"Issue: {e.validation_errors}\")\n\nexcept FieldMappingError as e:\nlogger.error(f\"Failed to map field: {e.field_name}\")\nlogger.error(f\"Reason: {e}\")\nlogger.error(f\"Recommendation: {context.recommendation.ref}\")\n\nexcept TransformError as e:\nlogger.error(f\"Transform '{e.transform_name}' failed\")\nlogger.error(f\"Input value: {e.input_value}\")\nlogger.error(f\"Error: {e}\")\n\nexcept VariableSubstitutionError as e:\nlogger.error(f\"Variable '{e.variable}' not found\")\nlogger.error(f\"Template: {e.template}\")\nlogger.error(f\"Available variables: {context.list_variables()}\")\n\nexcept ValidationError as e:\nlogger.error(f\"Output XCCDF validation failed\")\nlogger.error(f\"Schema error: {e}\")\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#extensibility","title":"Extensibility","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#adding-new-transformations","title":"Adding New Transformations","text":"<pre><code># 1. Define transformation function\ndef uppercase_transform(value: str) -&gt; str:\n\"\"\"Convert text to uppercase.\"\"\"\nreturn value.upper() if value else \"\"\n\n# 2. Register with registry\ntransform_registry.register('uppercase', uppercase_transform)\n\n# 3. Use in YAML config\nfield_mappings:\ntitle:\nsource_field: \"title\"\ntransform: \"uppercase\"\n\n# No code changes needed in MappingEngine!\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#adding-new-field-structures","title":"Adding New Field Structures","text":"<pre><code># 1. Create new strategy\nclass DublinCoreStrategy(MappingStrategy):\n\"\"\"Build Dublin Core metadata elements.\"\"\"\n\ndef apply(self, mapping: FieldMapping, source_obj: Any, context: MappingContext):\n# Build DC elements\nreturn dc_elements\n\n# 2. Register strategy\nstrategy_registry.register('dublin_core', DublinCoreStrategy)\n\n# 3. Use in YAML\nfield_mappings:\nreference:\ntarget_element: \"reference\"\nstructure: \"dublin_core\"\ndc_elements:\n\n- element: \"dc:identifier\"\ncontent: \"{nist_control_id}\"\n\n# Engine automatically uses DublinCoreStrategy!\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#adding-new-mapping-styles","title":"Adding New Mapping Styles","text":"<pre><code># Just create new YAML file!\n\n# cis_native_style.yaml\nmetadata:\nstyle_name: \"cis_native\"\ndescription: \"CIS native XCCDF format\"\nxccdf_version: \"1.2\"\n\nfield_mappings:\n# Different mappings than DISA style\ndescription:\ntarget_element: \"description\"\nsource_field: \"description\"\ntransform: \"html_to_markdown\" # Preserve formatting\n\n# Use it\nengine = MappingEngine.from_config('cis_native_style.yaml')\nxccdf = engine.map_benchmark(benchmark)\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#testing-strategy","title":"Testing Strategy","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#unit-tests","title":"Unit Tests","text":"<pre><code>def test_simple_field_mapping():\n\"\"\"Test basic field mapping with transformation.\"\"\"\nmapping = FieldMapping(\ntarget_element='title',\nsource_field='title',\ntransform='strip_html'\n)\n\nrec = Recommendation(title=\"&lt;p&gt;Test&lt;/p&gt;\")\ncontext = MappingContext(recommendation=rec, ...)\n\nstrategy = SimpleFieldStrategy()\nresult = strategy.apply(mapping, rec, context)\n\nassert result == \"Test\"\n\ndef test_composite_field_mapping():\n\"\"\"Test composite field (VulnDiscussion).\"\"\"\nmapping = FieldMapping(\nstructure='composite',\ncomponents=[\nComponentMapping(\nsources=[\nSourceDef(field='description', transform='strip_html'),\nSourceDef(field='rationale', transform='strip_html')\n],\nseparator='\\n\\n'\n)\n]\n)\n\nrec = Recommendation(\ndescription=\"&lt;p&gt;Desc&lt;/p&gt;\",\nrationale=\"&lt;p&gt;Rationale&lt;/p&gt;\"\n)\n\nstrategy = CompositeFieldStrategy()\nresult = strategy.apply(mapping, rec, context)\n\nassert result == \"Desc\\n\\nRationale\"\n\ndef test_variable_substitution():\n\"\"\"Test variable substitution in templates.\"\"\"\ncontext = MappingContext(\nref_normalized=\"3_1_1\",\nplatform=\"eks\"\n)\n\nsubstituter = VariableSubstituter()\nresult = substituter.substitute(\n\"xccdf_cis_{platform}_rule_{ref_normalized}\",\ncontext\n)\n\nassert result == \"xccdf_cis_eks_rule_3_1_1\"\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#integration-tests","title":"Integration Tests","text":"<pre><code>def test_full_benchmark_mapping():\n\"\"\"Test complete benchmark mapping using real config.\"\"\"\n# Load config\nengine = MappingEngine.from_config('disa_style.yaml')\n\n# Load test benchmark\nbenchmark = Benchmark.from_json_file('tests/fixtures/test_benchmark.json')\n\n# Map to XCCDF\nxccdf_benchmark = engine.map_benchmark(benchmark)\n\n# Validate structure\nassert xccdf_benchmark.id.startswith('xccdf_cis_')\nassert len(xccdf_benchmark.rule) == len(benchmark.recommendations)\n\n# Validate first rule\nrule = xccdf_benchmark.rule[0]\nassert rule.id == \"xccdf_cis_eks_rule_3_1_1\"\nassert rule.title\nassert rule.description\n\n# Validate embedded XML in description\ndesc_content = rule.description[0].content[0]\nassert '&lt;VulnDiscussion&gt;' in desc_content\nassert '&lt;FalsePositives&gt;' in desc_content\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#config-validation-tests","title":"Config Validation Tests","text":"<pre><code>def test_config_validation_missing_required():\n\"\"\"Test config validation catches missing required sections.\"\"\"\nwith pytest.raises(ConfigValidationError) as exc:\nConfigLoader.load('tests/configs/invalid_missing_field_mappings.yaml')\n\nassert 'field_mappings' in str(exc.value)\n\ndef test_config_validation_invalid_transform():\n\"\"\"Test config validation catches undefined transforms.\"\"\"\nwith pytest.raises(ConfigValidationError) as exc:\nConfigLoader.load('tests/configs/invalid_transform.yaml')\n\nassert 'unknown_transform' in str(exc.value)\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#performance-considerations","title":"Performance Considerations","text":""},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#caching","title":"Caching","text":"<pre><code>class MappingEngine:\n\"\"\"Engine with caching for expensive operations.\"\"\"\n\ndef __init__(self, config: MappingConfig):\nself.config = config\nself._platform_cache = {}\nself._cci_cache = {}\n\ndef _extract_platform(self, title: str) -&gt; str:\n\"\"\"Extract platform with caching.\"\"\"\nif title not in self._platform_cache:\nself._platform_cache[title] = self._do_extract_platform(title)\nreturn self._platform_cache[title]\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#batch-processing","title":"Batch Processing","text":"<pre><code>def map_benchmark(self, benchmark: Benchmark) -&gt; XCCDFBenchmark:\n\"\"\"Map with batch processing for expensive operations.\"\"\"\n\n# Pre-fetch all CCIs in batch (avoid N+1 queries)\nall_cis_controls = self._collect_all_cis_controls(benchmark)\ncci_batch = self.cci_service.batch_lookup(all_cis_controls)\n\n# Map rules with cached CCIs\nfor rec in benchmark.recommendations:\n# Use cached CCI results\n...\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#directory-structure","title":"Directory Structure","text":"<pre><code>cis_bench/\n\u251c\u2500\u2500 exporters/\n\u2502 \u251c\u2500\u2500 configs/\n\u2502 \u2502 \u251c\u2500\u2500 disa_style.yaml\n\u2502 \u2502 \u251c\u2500\u2500 cis_native_style.yaml\n\u2502 \u2502 \u2514\u2500\u2500 custom_style.yaml\n\u2502 \u2502\n\u2502 \u251c\u2500\u2500 mapping/\n\u2502 \u2502 \u251c\u2500\u2500 __init__.py\n\u2502 \u2502 \u251c\u2500\u2500 engine.py # MappingEngine\n\u2502 \u2502 \u251c\u2500\u2500 config.py # ConfigLoader, MappingConfig\n\u2502 \u2502 \u251c\u2500\u2500 field_mapper.py # FieldMapper\n\u2502 \u2502 \u251c\u2500\u2500 transforms.py # TransformRegistry, built-in transforms\n\u2502 \u2502 \u251c\u2500\u2500 variables.py # VariableSubstituter, MappingContext\n\u2502 \u2502 \u251c\u2500\u2500 strategies.py # Mapping strategies\n\u2502 \u2502 \u2514\u2500\u2500 errors.py # Exception classes\n\u2502 \u2502\n\u2502 \u2514\u2500\u2500 xccdf_exporter.py # Uses MappingEngine\n\u2502\n\u2514\u2500\u2500 utils/\n\u251c\u2500\u2500 html_parser.py # HTMLCleaner (used by transforms)\n\u2514\u2500\u2500 cci_lookup.py # CCILookupService (used by strategies)\n</code></pre>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#summary","title":"Summary","text":"<p>The MappingEngine is a sophisticated, configuration-driven system that:</p> <ol> <li>Loads YAML configs defining field mappings and transformations</li> <li>Applies transformations via pluggable registry (strip_html, markdown, etc.)</li> <li>Handles complex structures (embedded XML, composite fields, nested elements)</li> <li>Supports variable substitution ({ref}, {ref_normalized}, etc.)</li> <li>Uses strategy pattern for different field mapping types</li> <li>Is extensible - add transforms, strategies, and styles without code changes</li> <li>Provides clear error handling at config, mapping, and validation stages</li> </ol>"},{"location":"technical-reference/MAPPING_ENGINE_DESIGN/#benefits","title":"Benefits","text":"<ul> <li>Separation of Concerns: Mapping logic separate from XCCDF serialization</li> <li>Maintainability: Change mappings via YAML, not code</li> <li>Testability: Each component tested independently</li> <li>Extensibility: New transforms, strategies, styles via registration</li> <li>Clarity: Explicit configuration shows what maps to what</li> <li>Flexibility: Support multiple XCCDF styles (DISA, CIS, custom)</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/","title":"XCCDF Export Styles - Complete Specification","text":"<p>Documentation Path</p> <p>You are here: Technical Reference &gt; XCCDF Styles Comparison</p> <p>For practical usage: See Workflows | Commands Reference</p>"},{"location":"technical-reference/XCCDF_STYLES/#overview","title":"Overview","text":"<p>CIS Benchmark CLI supports TWO XCCDF export styles:</p> <ol> <li>DISA/DoD Style - STIG-compatible for DoD compliance tools (Uses XCCDF 1.1.4)</li> <li>CIS Native Style - Clean CIS-centric format for general XCCDF tools (Uses XCCDF 1.2)</li> </ol> <p>XCCDF Version Difference:</p> <ul> <li>DISA STIGs use XCCDF 1.1.4 (NOT 1.2)</li> <li>XCCDF 1.1.4 allows simple IDs (<code>CIS-6_1_1</code>)</li> <li>XCCDF 1.2 requires pattern IDs (<code>xccdf_org.cisecurity_rule_*</code>)</li> <li>Config specifies version, MappingEngine loads appropriate models</li> </ul> <p>Both styles use different XCCDF versions AND different conventions for mapping CIS Benchmark concepts to XCCDF elements.</p>"},{"location":"technical-reference/XCCDF_STYLES/#style-selection","title":"Style Selection","text":"<pre><code># DISA/DoD STIG-compatible export\ncis-bench export benchmark.json --format xccdf --style disa\n\n# CIS native clean export\ncis-bench export benchmark.json --format xccdf --style cis\n\n# Default: DISA style (most compatible)\ncis-bench export benchmark.json --format xccdf\n</code></pre>"},{"location":"technical-reference/XCCDF_STYLES/#style-1-disadod-xccdf-stig-compatible","title":"Style 1: DISA/DoD XCCDF (STIG-Compatible)","text":""},{"location":"technical-reference/XCCDF_STYLES/#purpose","title":"Purpose","text":"<ul> <li>Compatible with DoD STIG tools and workflows</li> <li>Uses DISA STIG conventions</li> <li>Includes CCI (Control Correlation Identifiers) for NIST 800-53 mapping</li> <li>Follows STIG element structure and naming</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#target-tools","title":"Target Tools","text":"<ul> <li>DISA SCAP Compliance Checker (SCC)</li> <li>OpenSCAP (DoD configurations)</li> <li>DISA STIG Viewer</li> <li>Nessus (Government configurations)</li> <li>Any tool expecting DISA STIG format</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#complete-rule-structure","title":"Complete Rule Structure","text":"<pre><code>&lt;Rule id=\"xccdf_cis_almalinux8_rule_3_1_1\"\nseverity=\"medium\"\nweight=\"10.0\"&gt;\n\n&lt;!-- STIG ID (maps to CIS ref) --&gt;\n&lt;version&gt;3.1.1&lt;/version&gt;\n\n&lt;!-- Title --&gt;\n&lt;title&gt;Ensure kubeconfig file permissions are set to 644 or more restrictive&lt;/title&gt;\n\n&lt;!-- Description with DISA embedded XML tags --&gt;\n&lt;description&gt;\n&amp;lt;VulnDiscussion&amp;gt;\nIf kubelet is running, and if it is configured by a kubeconfig file, ensure\nthat the proxy kubeconfig file has permissions of 644 or more restrictive.\n\nImproper access permissions could allow unauthorized users to access\nsensitive configuration data.\n&amp;lt;/VulnDiscussion&amp;gt;\n&amp;lt;FalsePositives&amp;gt;&amp;lt;/FalsePositives&amp;gt;\n&amp;lt;FalseNegatives&amp;gt;&amp;lt;/FalseNegatives&amp;gt;\n&amp;lt;Documentable&amp;gt;false&amp;lt;/Documentable&amp;gt;\n&amp;lt;Mitigations&amp;gt;Additional configuration notes if present&amp;lt;/Mitigations&amp;gt;\n&amp;lt;SeverityOverrideGuidance&amp;gt;&amp;lt;/SeverityOverrideGuidance&amp;gt;\n&amp;lt;PotentialImpacts&amp;gt;None expected&amp;lt;/PotentialImpacts&amp;gt;\n&amp;lt;ThirdPartyTools&amp;gt;&amp;lt;/ThirdPartyTools&amp;gt;\n&amp;lt;MitigationControl&amp;gt;&amp;lt;/MitigationControl&amp;gt;\n&amp;lt;Responsibility&amp;gt;&amp;lt;/Responsibility&amp;gt;\n&amp;lt;IAControls&amp;gt;&amp;lt;/IAControls&amp;gt;\n&lt;/description&gt;\n\n&lt;!-- CCIs (from cis-cci-mapping.json) - DoD standard for NIST mapping --&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000381&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000382&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000380&lt;/ident&gt;\n\n&lt;!-- NIST controls NOT covered by CCIs (after deduplication) --&gt;\n&lt;reference href=\"https://csrc.nist.gov/Projects/risk-management/sp800-53-controls\"&gt;\n&lt;dc:identifier&gt;SI-3&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n&lt;reference href=\"https://csrc.nist.gov/Projects/risk-management/sp800-53-controls\"&gt;\n&lt;dc:identifier&gt;MP-7&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n\n&lt;!-- Remediation (STIG convention) --&gt;\n&lt;fixtext fixref=\"F-3_1_1\"&gt;\nRun the following command:\nchmod 644 /var/lib/kubelet/kubeconfig\n&lt;/fixtext&gt;\n&lt;fix id=\"F-3_1_1\"/&gt;\n\n&lt;!-- Check/Audit (STIG convention) --&gt;\n&lt;check system=\"C-3_1_1\"&gt;\n&lt;check-content&gt;\nRun the following command:\nstat -c %a /var/lib/kubelet/kubeconfig\n\nVerify permissions are 644 or more restrictive.\n&lt;/check-content&gt;\n&lt;/check&gt;\n\n&lt;!-- Additional metadata (CIS-specific, standard XCCDF elements) --&gt;\n&lt;metadata&gt;\n&lt;cis-control version=\"8\" id=\"4.8\"&gt;\nUninstall or Disable Unnecessary Services on Enterprise Assets and Software\n&lt;/cis-control&gt;\n&lt;cis-control version=\"7\" id=\"9.2\"&gt;\nEnsure Only Approved Ports, Protocols and Services Are Running\n&lt;/cis-control&gt;\n&lt;profile&gt;Level 1 - Server&lt;/profile&gt;\n&lt;profile&gt;Level 1 - Workstation&lt;/profile&gt;\n&lt;mitre-technique&gt;T1068&lt;/mitre-technique&gt;\n&lt;mitre-tactic&gt;TA0001&lt;/mitre-tactic&gt;\n&lt;mitre-mitigation&gt;M1022&lt;/mitre-mitigation&gt;\n&lt;/metadata&gt;\n\n&lt;/Rule&gt;\n</code></pre>"},{"location":"technical-reference/XCCDF_STYLES/#cis-field-disa-element-mapping","title":"CIS Field DISA Element Mapping","text":"CIS Field DISA Element Location Notes ref <code>&lt;version&gt;</code> Direct CIS 3.1.1 STIG ID equivalent title <code>&lt;title&gt;</code> Direct Unchanged description <code>&lt;description&gt;</code> VulnDiscussion (first part) Embedded Strip HTML tags rationale <code>&lt;description&gt;</code> VulnDiscussion (second part) Embedded Strip HTML tags, append to description impact <code>&lt;description&gt;</code> PotentialImpacts Embedded Strip HTML tags additional_info <code>&lt;description&gt;</code> Mitigations Embedded If present remediation <code>&lt;fixtext&gt;</code> Direct Strip HTML, preserve code blocks audit <code>&lt;check&gt;&lt;check-content&gt;</code> Nested Strip HTML, preserve code blocks cis_controls <code>&lt;metadata&gt;</code> cis-control Custom CIS-specific metadata mitre_mapping <code>&lt;metadata&gt;</code> mitre-* Custom Techniques, tactics, mitigations profiles <code>&lt;metadata&gt;</code> profile Custom Level 1/2, Server/Workstation nist_controls (via CCI mapping) <code>&lt;ident system=\"http://cyber.mil/cci\"&gt;</code> Direct Primary + supporting CCIs nist_controls (extras) <code>&lt;reference&gt;&lt;dc:identifier&gt;</code> Direct Only if NOT covered by CCIs"},{"location":"technical-reference/XCCDF_STYLES/#attributes","title":"Attributes","text":"Attribute Value Reasoning Rule/@severity \"medium\" CIS has no severity concept, default to medium (CAT II equivalent) Rule/@weight \"10.0\" DISA standard weight Rule/@id <code>xccdf_cis_{platform}_rule_{ref}</code> Synthetic ID, CIS-prefixed fixtext/@fixref <code>F-{ref}</code> Links to fix element fix/@id <code>F-{ref}</code> Matches fixref check/@system <code>C-{ref}</code> Synthetic check ID"},{"location":"technical-reference/XCCDF_STYLES/#cci-nist-deduplication-algorithm","title":"CCI + NIST Deduplication Algorithm","text":"<p>Goal: Use CCIs (DoD standard) where available, add NIST references only for extras</p> <p>Input:</p> <ul> <li>CIS Control from recommendation: \"4.8\"</li> <li>CIS nist_controls: [\"CM-7\", \"SI-3\", \"MP-7\"]</li> <li>CCI mapping for 4.8: <pre><code>{\n\"primary_cci\": {\"cci\": \"CCI-000381\", \"nist\": \"CM-7.1\"},\n\"supporting_ccis\": [\n{\"cci\": \"CCI-000382\", \"nist\": \"CM-7.3\"},\n{\"cci\": \"CCI-000380\", \"nist\": \"CM-7.2\"}\n]\n}\n</code></pre></li> </ul> <p>Step 1: Extract all CCIs from mapping <pre><code>CCIs: [CCI-000381, CCI-000382, CCI-000380]\n</code></pre></p> <p>Step 2: Determine which NIST controls each CCI covers <pre><code>CCI-000381 CM-7.1 covers \"CM-7\"\nCCI-000382 CM-7.3 covers \"CM-7\"\nCCI-000380 CM-7.2 covers \"CM-7\"\n</code></pre></p> <p>Step 3: Check each CIS-cited NIST control <pre><code>For \"CM-7\": Covered by CCIs (CCI-000381, 382, 380)\nFor \"SI-3\": NOT in any CCI mapping\nFor \"MP-7\": NOT in any CCI mapping\n</code></pre></p> <p>Step 4: Build output <pre><code>&lt;!-- Add ALL CCIs from mapping (they cover CM-7) --&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000381&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000382&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000380&lt;/ident&gt;\n\n&lt;!-- Add extras as references (not covered by CCIs) --&gt;\n&lt;reference&gt;\n&lt;dc:identifier&gt;SI-3&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n&lt;reference&gt;\n&lt;dc:identifier&gt;MP-7&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n</code></pre></p> <p>Matching Logic for NIST Controls: <pre><code>def nist_control_matches(cited, cci_mapped):\n\"\"\"Check if CCI-mapped control covers cited control.\n\nExamples:\ncited=\"CM-7\", cci_mapped=\"CM-7.1\" True\ncited=\"CM-7\", cci_mapped=\"CM-7\" True\ncited=\"CM-7.1\", cci_mapped=\"CM-7\" False (too broad)\ncited=\"CM-7(5)\", cci_mapped=\"CM-7.1\" False (different enhancement)\n\nLogic: Strip enhancement numbers, check if cci_mapped starts with cited\n\"\"\"\ncited_base = cited.split('(')[0] # \"CM-7(5)\" \"CM-7\"\ncci_base = cci_mapped.split('(')[0] # \"CM-7(5)\" \"CM-7\"\n\n# CM-7.1 covers CM-7, but not vice versa\nreturn cci_base.startswith(cited_base)\n</code></pre></p>"},{"location":"technical-reference/XCCDF_STYLES/#why-this-normalization-is-correct","title":"Why This Normalization Is Correct","text":"<p>Respects source material: Uses exactly what CIS authors cited DoD compliant: Uses CCI (standard DoD method) No duplication: CM-7 not stated twice No invention: Does not add NIST controls CIS didn't cite Preserves extras: CIS-specific NIST citations become references Tool compatible: DISA tools understand CCIs, ignore CIS metadata</p>"},{"location":"technical-reference/XCCDF_STYLES/#style-2-cis-native-xccdf-clean-format","title":"Style 2: CIS Native XCCDF (Clean Format)","text":""},{"location":"technical-reference/XCCDF_STYLES/#purpose_1","title":"Purpose","text":"<ul> <li>Clean, CIS-centric XCCDF export</li> <li>No DoD baggage (no CCI, no VMS tags)</li> <li>Optimized for non-DoD XCCDF tools</li> <li>Preserves all CIS-specific data</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#target-tools_1","title":"Target Tools","text":"<ul> <li>OpenSCAP (commercial/non-DoD)</li> <li>Generic XCCDF validators</li> <li>Custom compliance tools</li> <li>Research/analysis tools</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#complete-rule-structure_1","title":"Complete Rule Structure","text":"<pre><code>&lt;Rule id=\"xccdf_org.cisecurity.benchmarks_rule_3_1_1\"&gt;\n\n&lt;!-- CIS Reference --&gt;\n&lt;version&gt;3.1.1&lt;/version&gt;\n\n&lt;!-- Title --&gt;\n&lt;title&gt;Ensure kubeconfig file permissions are set to 644 or more restrictive&lt;/title&gt;\n\n&lt;!-- Clean separated content (no embedded XML tags) --&gt;\n&lt;description&gt;\nIf kubelet is running, and if it is configured by a kubeconfig file, ensure\nthat the proxy kubeconfig file has permissions of 644 or more restrictive.\n&lt;/description&gt;\n\n&lt;rationale&gt;\nImproper access permissions could allow unauthorized users to access\nsensitive configuration data.\n&lt;/rationale&gt;\n\n&lt;!-- Impact as warning (XCCDF standard for caveats) --&gt;\n&lt;warning category=\"general\"&gt;\nNone expected\n&lt;/warning&gt;\n\n&lt;!-- Direct NIST 800-53 references --&gt;\n&lt;reference href=\"https://csrc.nist.gov/Projects/risk-management/sp800-53-controls\"&gt;\n&lt;dc:title&gt;NIST SP 800-53&lt;/dc:title&gt;\n&lt;dc:identifier&gt;CM-7&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n&lt;reference href=\"https://csrc.nist.gov/Projects/risk-management/sp800-53-controls\"&gt;\n&lt;dc:title&gt;NIST SP 800-53&lt;/dc:title&gt;\n&lt;dc:identifier&gt;SI-3&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n&lt;reference href=\"https://csrc.nist.gov/Projects/risk-management/sp800-53-controls\"&gt;\n&lt;dc:title&gt;NIST SP 800-53&lt;/dc:title&gt;\n&lt;dc:identifier&gt;MP-7&lt;/dc:identifier&gt;\n&lt;/reference&gt;\n\n&lt;!-- CIS-specific metadata (standard XCCDF metadata element) --&gt;\n&lt;metadata&gt;\n&lt;!-- Profiles --&gt;\n&lt;cis-profile&gt;Level 1 - Server&lt;/cis-profile&gt;\n&lt;cis-profile&gt;Level 1 - Workstation&lt;/cis-profile&gt;\n\n&lt;!-- CIS Controls v8 --&gt;\n&lt;cis-control version=\"8\"&gt;\n&lt;control-id&gt;4.8&lt;/control-id&gt;\n&lt;title&gt;Uninstall or Disable Unnecessary Services on Enterprise Assets and Software&lt;/title&gt;\n&lt;ig1&gt;false&lt;/ig1&gt;\n&lt;ig2&gt;true&lt;/ig2&gt;\n&lt;ig3&gt;true&lt;/ig3&gt;\n&lt;/cis-control&gt;\n\n&lt;!-- CIS Controls v7 --&gt;\n&lt;cis-control version=\"7\"&gt;\n&lt;control-id&gt;9.2&lt;/control-id&gt;\n&lt;title&gt;Ensure Only Approved Ports, Protocols and Services Are Running&lt;/title&gt;\n&lt;ig1&gt;false&lt;/ig1&gt;\n&lt;ig2&gt;true&lt;/ig2&gt;\n&lt;ig3&gt;true&lt;/ig3&gt;\n&lt;/cis-control&gt;\n\n&lt;!-- MITRE ATT&amp;CK --&gt;\n&lt;mitre-attack&gt;\n&lt;technique&gt;T1068&lt;/technique&gt;\n&lt;technique&gt;T1203&lt;/technique&gt;\n&lt;tactic&gt;TA0001&lt;/tactic&gt;\n&lt;mitigation&gt;M1022&lt;/mitigation&gt;\n&lt;/mitre-attack&gt;\n\n&lt;!-- Assessment type --&gt;\n&lt;assessment-status&gt;Automated&lt;/assessment-status&gt;\n\n&lt;!-- Artifacts (if present) --&gt;\n&lt;artifacts&gt;\n&lt;artifact id=\"1.1.1.1.1\" status=\"draft\"&gt;\nScript Check Engine Check \"nix_module_chk_v3.sh\"...\n&lt;/artifact&gt;\n&lt;/artifacts&gt;\n&lt;/metadata&gt;\n\n&lt;!-- Remediation --&gt;\n&lt;fixtext&gt;\nRun the following command:\nchmod 644 /var/lib/kubelet/kubeconfig\n&lt;/fixtext&gt;\n\n&lt;!-- Audit/Check --&gt;\n&lt;check&gt;\n&lt;check-content&gt;\nRun the following command:\nstat -c %a /var/lib/kubelet/kubeconfig\n\nVerify the permissions are 644 or more restrictive.\n&lt;/check-content&gt;\n&lt;/check&gt;\n\n&lt;/Rule&gt;\n</code></pre>"},{"location":"technical-reference/XCCDF_STYLES/#cis-field-cis-native-element-mapping","title":"CIS Field CIS Native Element Mapping","text":"CIS Field CIS Native Element Location Notes ref <code>&lt;version&gt;</code> Direct CIS reference number title <code>&lt;title&gt;</code> Direct Unchanged description <code>&lt;description&gt;</code> Direct Clean, no embedded tags rationale <code>&lt;rationale&gt;</code> Direct Separate element impact <code>&lt;warning category=\"general\"&gt;</code> Direct XCCDF standard for impacts additional_info <code>&lt;metadata&gt;</code> additional-info Custom If present remediation <code>&lt;fixtext&gt;</code> Direct Same as DISA audit <code>&lt;check&gt;&lt;check-content&gt;</code> Nested Same as DISA profiles <code>&lt;metadata&gt;</code> cis-profile Custom Level/workload tags cis_controls <code>&lt;metadata&gt;</code> cis-control Custom v7/v8 with IG groups mitre_mapping <code>&lt;metadata&gt;</code> mitre-attack Custom Techniques/tactics/mitigations nist_controls <code>&lt;reference&gt;&lt;dc:identifier&gt;</code> Direct All NIST controls (no CCI) artifacts <code>&lt;metadata&gt;</code> artifacts Custom Test artifacts assessment_status <code>&lt;metadata&gt;</code> assessment-status Custom Automated/Manual"},{"location":"technical-reference/XCCDF_STYLES/#differences-from-disa-style","title":"Differences from DISA Style","text":"Aspect DISA Style CIS Native Style Description structure Embedded XML tags (VulnDiscussion, etc.) Clean separate elements NIST mapping Via CCIs (<code>&lt;ident&gt;</code>) Direct references CIS Controls In metadata only In metadata MITRE In metadata In metadata Rationale Embedded in VulnDiscussion Separate <code>&lt;rationale&gt;</code> element Impact Embedded as PotentialImpacts <code>&lt;warning&gt;</code> element Complexity Higher (DoD conventions) Lower (clean structure) Target audience DoD/Government Commercial/General"},{"location":"technical-reference/XCCDF_STYLES/#cci-nist-deduplication-algorithm-disa-style-only","title":"CCI + NIST Deduplication Algorithm (DISA Style Only)","text":""},{"location":"technical-reference/XCCDF_STYLES/#purpose_2","title":"Purpose","text":"<p>Avoid duplicating NIST control references when CCIs already provide that mapping.</p>"},{"location":"technical-reference/XCCDF_STYLES/#algorithm","title":"Algorithm","text":"<p>Input:</p> <ul> <li><code>cis_controls</code>: List of CIS Control objects from recommendation</li> <li><code>nist_controls</code>: List of NIST control IDs cited by CIS authors (e.g., [\"CM-7\", \"SI-3\"])</li> <li><code>cis_cci_mapping</code>: Loaded from cis-cci-mapping.json</li> </ul> <p>Process:</p> <p>Step 1: For each CIS Control, look up CCI mapping <pre><code>for cis_ctrl in recommendation.cis_controls:\ncis_id = f\"{cis_ctrl.version}.{cis_ctrl.control}\" # \"8.4.8\" or \"7.9.2\"\n\nmapping = cis_cci_mapping.get(cis_id)\nif mapping:\n# Collect CCIs\nall_ccis.append(mapping['primary_cci']['cci'])\nall_ccis.extend([s['cci'] for s in mapping['supporting_ccis']])\n</code></pre></p> <p>Step 2: Build CCI NIST reverse map <pre><code>cci_to_nist = {}\nfor mapping in cis_cci_mapping.values():\n# From primary\ncci_to_nist[mapping['primary_cci']['cci']] = extract_nist(mapping['primary_cci'])\n\n# From supporting\nfor supp in mapping['supporting_ccis']:\ncci_to_nist[supp['cci']] = extract_nist(supp)\n\n# Extract NIST from CCI mapping entry\ndef extract_nist(cci_entry):\n# Could be in 'nist' field or need to parse from reasoning\n# Return base control: \"CM-7.1\" \"CM-7\"\n</code></pre></p> <p>Step 3: Check which cited NIST controls are covered by CCIs <pre><code>covered_nist = set()\nfor cci in all_ccis:\nnist_ctrl = cci_to_nist.get(cci)\nif nist_ctrl:\nbase = nist_ctrl.split('(')[0].split('.')[0] # \"CM-7(5)\" \"CM-7\"\ncovered_nist.add(base)\n</code></pre></p> <p>Step 4: Find NIST controls NOT covered by CCIs <pre><code>extra_nist = []\nfor cited in recommendation.nist_controls:\ncited_base = cited.split('(')[0].split('.')[0]\nif cited_base not in covered_nist:\nextra_nist.append(cited)\n</code></pre></p> <p>Output: <pre><code>&lt;!-- All CCIs (cover CM-7) --&gt;\n&lt;ident&gt;CCI-000381&lt;/ident&gt;\n&lt;ident&gt;CCI-000382&lt;/ident&gt;\n&lt;ident&gt;CCI-000380&lt;/ident&gt;\n\n&lt;!-- Extras not covered by CCIs --&gt;\n&lt;reference&gt;&lt;dc:identifier&gt;SI-3&lt;/dc:identifier&gt;&lt;/reference&gt;\n&lt;reference&gt;&lt;dc:identifier&gt;MP-7&lt;/dc:identifier&gt;&lt;/reference&gt;\n</code></pre></p>"},{"location":"technical-reference/XCCDF_STYLES/#nist-control-matching-rules","title":"NIST Control Matching Rules","text":"<p>Matching is hierarchical:</p> <ul> <li>CCI maps to \"CM-7.1\" covers citation of \"CM-7\"</li> <li>CCI maps to \"CM-7\" does NOT cover citation of \"CM-7.1\" (too specific)</li> <li>CCI maps to \"CM-7(5)\" covers \"CM-7\" but not \"CM-7(4)\" (different enhancement)</li> </ul> <p>Base matching: <pre><code>def cci_covers_citation(cci_nist_control: str, cited_nist_control: str) -&gt; bool:\n\"\"\"Check if CCI-mapped control covers the cited control.\n\nExamples:\n(\"CM-7.1\", \"CM-7\") True\n(\"CM-7\", \"CM-7\") True\n(\"CM-7\", \"CM-7.1\") False (CCI too broad)\n(\"CM-7.1\", \"CM-7.1\") True\n(\"CM-7.1\", \"CM-7.2\") False (different sub-control)\n\"\"\"\n# Normalize: remove enhancements\ncited_base = cited_nist_control.split('(')[0]\ncci_base = cci_nist_control.split('(')[0]\n\n# Check if CCI control starts with cited\n# \"CM-7.1\".startswith(\"CM-7\") True\nreturn cci_base.startswith(cited_base)\n</code></pre></p>"},{"location":"technical-reference/XCCDF_STYLES/#edge-cases","title":"Edge Cases","text":"<p>Case 1: CIS cites \"CM-7\" but CCI maps to \"CM-7(5)\"</p> <ul> <li>Match: CM-7(5) covers CM-7? YES (enhancement of CM-7)</li> <li>Action: Use CCI</li> </ul> <p>Case 2: CIS cites \"CM-7.1\" but CCI maps to \"CM-7\"</p> <ul> <li>Match: CM-7 covers CM-7.1? NO (too general)</li> <li>Action: Add CM-7.1 as reference (CCI doesn't cover specific sub-control)</li> </ul> <p>Case 3: CIS has no CIS Controls (old benchmark)</p> <ul> <li>No CCI mapping available</li> <li>Action: Add all NIST controls as references</li> </ul> <p>Case 4: CCI mapping not found for CIS Control</p> <ul> <li>Mapping incomplete</li> <li>Action: Add all NIST controls as references, log warning</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#implementation-notes","title":"Implementation Notes","text":"<p>CCI Mapping File: Bundle cis-cci-mapping.json with tool <pre><code># Load once at module import\nimport json\nfrom pathlib import Path\n\nCCI_MAPPING_FILE = Path(__file__).parent / 'data' / 'cis-cci-mapping.json'\n\nwith open(CCI_MAPPING_FILE) as f:\nCIS_CCI_MAPPING = json.load(f)\n</code></pre></p> <p>Lookup function: <pre><code>def get_ccis_for_cis_control(cis_version: int, cis_control_id: str) -&gt; List[str]:\n\"\"\"Get all CCIs for a CIS control.\n\nArgs:\ncis_version: 7 or 8\ncis_control_id: \"4.8\", \"10.3\", etc.\n\nReturns:\nList of CCI identifiers [\"CCI-000381\", \"CCI-000382\", ...]\n\"\"\"\n# CCI mapping uses just control number, not version-prefixed\n# Both v7 and v8 might map to same CCIs (NIST doesn't change)\n\nmapping = CIS_CCI_MAPPING.get(cis_control_id)\nif not mapping:\nreturn []\n\nccis = []\nif mapping.get('primary_cci'):\nccis.append(mapping['primary_cci']['cci'])\n\nfor supp in mapping.get('supporting_ccis', []):\nccis.append(supp.get('cci') or supp.get('cci_id'))\n\nreturn ccis\n</code></pre></p>"},{"location":"technical-reference/XCCDF_STYLES/#comparison-matrix","title":"Comparison Matrix","text":"Feature DISA Style CIS Native Style Use case DoD compliance, STIG viewers General compliance, analysis NIST mapping CCIs (DoD standard) Direct references Description VulnDiscussion + legacy tags Clean description + rationale CIS Controls Metadata only Metadata (primary) MITRE Metadata Metadata Profiles Metadata Metadata Validation DISA STIG tools Generic XCCDF tools File size Smaller (no duplicated NIST) Slightly larger Complexity Higher Lower"},{"location":"technical-reference/XCCDF_STYLES/#implementation-plan","title":"Implementation Plan","text":""},{"location":"technical-reference/XCCDF_STYLES/#phase-1-disa-style-exporter","title":"Phase 1: DISA Style Exporter","text":"<ol> <li>Add <code>cci_mappings: List[str]</code> to Pydantic Recommendation model</li> <li>Create <code>cis_bench/utils/cci_lookup.py</code> - Load and query cis-cci-mapping.json</li> <li> <p>Enhance <code>cis_bench/exporters/xccdf_exporter.py</code>:</p> </li> <li> <p>Add CCI lookup</p> </li> <li>Implement deduplication algorithm</li> <li>Add <code>&lt;ident&gt;</code> elements</li> <li>Structure description with VulnDiscussion/PotentialImpacts/Mitigations</li> <li>Add fixtext, fix, check elements</li> <li>Add severity, weight attributes</li> <li>Test with DISA tools</li> </ol>"},{"location":"technical-reference/XCCDF_STYLES/#phase-2-cis-native-exporter","title":"Phase 2: CIS Native Exporter","text":"<ol> <li>Create <code>cis_bench/exporters/xccdf_cis_exporter.py</code></li> <li>Clean structure (no embedded tags)</li> <li>Separate rationale element</li> <li>Direct NIST references (all of them)</li> <li>Rich metadata with CIS/MITRE data</li> <li>Test validation</li> </ol>"},{"location":"technical-reference/XCCDF_STYLES/#phase-3-cli-integration","title":"Phase 3: CLI Integration","text":"<ol> <li>Add <code>--style disa|cis</code> flag to export command</li> <li>Default to DISA (broader compatibility)</li> <li>Document both in README</li> </ol>"},{"location":"technical-reference/XCCDF_STYLES/#testing-strategy","title":"Testing Strategy","text":""},{"location":"technical-reference/XCCDF_STYLES/#disa-style-validation","title":"DISA Style Validation","text":"<pre><code># Export\ncis-bench export benchmark.json --format xccdf --style disa -o disa_output.xml\n\n# Parse with stig_parser (should work!)\npython -c \"from stig_parser import convert_xccdf; ...\"\n\n# Validate structure\ncd schemas\nXML_CATALOG_FILES=catalog.xml xmllint --schema xccdf_1.2.xsd ../disa_output.xml --noout\n</code></pre>"},{"location":"technical-reference/XCCDF_STYLES/#cis-style-validation","title":"CIS Style Validation","text":"<pre><code># Export\ncis-bench export benchmark.json --format xccdf --style cis -o cis_output.xml\n\n# Validate\nxmllint --schema xccdf_1.2.xsd cis_output.xml --noout\n\n# Check for CIS metadata\ngrep -o '&lt;cis-control' cis_output.xml | wc -l # Should find CIS controls\n</code></pre>"},{"location":"technical-reference/XCCDF_STYLES/#comparison-test","title":"Comparison Test","text":"<pre><code># Export same benchmark in both styles\ncis-bench export alma8.json --format xccdf --style disa -o alma8_disa.xml\ncis-bench export alma8.json --format xccdf --style cis -o alma8_cis.xml\n\n# Compare\ndiff &lt;(xmllint --format alma8_disa.xml) &lt;(xmllint --format alma8_cis.xml)\n\n# Should show:\n# - DISA has &lt;ident&gt; elements\n# - DISA has VulnDiscussion structure\n# - CIS has separate &lt;rationale&gt;\n# - CIS has more &lt;reference&gt; elements (no CCI deduplication)\n</code></pre>"},{"location":"technical-reference/XCCDF_STYLES/#future-enhancements","title":"Future Enhancements","text":""},{"location":"technical-reference/XCCDF_STYLES/#v11-style-auto-detection-on-import","title":"v1.1 - Style Auto-Detection on Import","text":"<ul> <li>Parse existing XCCDF</li> <li>Detect: Has CCIs? DISA style</li> <li>Detect: Has <code>&lt;rationale&gt;</code>? CIS style</li> <li>Round-trip: Import Modify Export in same style</li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#v12-hybrid-style","title":"v1.2 - Hybrid Style","text":"<ul> <li>Best of both worlds</li> <li>CCIs AND direct NIST references (explicit redundancy for maximum compatibility)</li> <li>User choice: <code>--style hybrid</code></li> </ul>"},{"location":"technical-reference/XCCDF_STYLES/#v13-custom-styles","title":"v1.3 - Custom Styles","text":"<ul> <li>User-defined XCCDF templates (Jinja2)</li> <li>Corporate branding</li> <li>Custom metadata namespaces</li> </ul>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/","title":"MappingEngine YAML Configuration Reference","text":"<p>Documentation Path</p> <p>You are here: Technical Reference &gt; YAML Config Syntax</p> <ul> <li>For practical guide: See MappingEngine User Guide</li> <li>For how-to: See How To Add XCCDF Style</li> </ul>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#overview","title":"Overview","text":"<p>This document provides a complete reference for writing MappingEngine YAML configuration files. These files define how CIS Benchmark data is transformed into XCCDF format.</p>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#configuration-structure","title":"Configuration Structure","text":"<pre><code># Top-level structure\nmetadata: # Style metadata\nstyle_name: \"...\"\ndescription: \"...\"\nxccdf_version: \"...\"\n\nbenchmark: # Benchmark-level mappings\nid_template: \"...\"\ntitle: {...}\ndescription: {...}\nversion: {...}\n\nrule_defaults: # Default rule attributes\nseverity: \"...\"\nweight: \"...\"\nselected: \"...\"\n\nrule_id: # Rule ID generation\ntemplate: \"...\"\nref_normalized: \"...\"\n\nfield_mappings: # Field mapping definitions\nfield_name:\ntarget_element: \"...\"\nsource_field: \"...\"\ntransform: \"...\"\n# ... more options\n\ntransformations: # Transform definitions\ntransform_name:\ndescription: \"...\"\nfunction: \"...\"\n\ncci_deduplication: # CCI/NIST deduplication config\nenabled: true\nalgorithm: {...}\n\nvalidation: # Validation rules\nrequire_cci_for_cis_controls: false\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#metadata-section","title":"Metadata Section","text":"<p>Describes the export style:</p> <pre><code>metadata:\nstyle_name: \"disa\" # Unique identifier\ndescription: \"DISA/DoD STIG-compatible XCCDF export\"\nxccdf_version: \"1.2\" # Target XCCDF version\ntarget_tools: # Compatible tools (optional)\n\n- \"DISA SCAP Compliance Checker (SCC)\"\n- \"OpenSCAP (DoD configurations)\"\nconventions: \"Follows DISA STIG XML structure\" # Notes (optional)\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#benchmark-section","title":"Benchmark Section","text":"<p>Benchmark-level field mappings:</p> <pre><code>benchmark:\n# ID template with variables\nid_template: \"xccdf_cis_{platform}_benchmark\"\n\n# Simple field mapping\ntitle:\nsource: \"title\"\ntransform: \"none\"\n\ndescription:\nsource: \"title\" # Can reuse other fields\ntransform: \"none\"\n\nversion:\nsource: \"version\"\ntransform: \"none\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#rule-defaults","title":"Rule Defaults","text":"<p>Default attributes applied to all rules:</p> <pre><code>rule_defaults:\nseverity: \"medium\" # CAT II equivalent\nweight: \"10.0\" # DISA standard\nselected: \"true\" # Rule enabled by default\nrole: \"full\" # Full rule (not snippet)\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#rule-id-generation","title":"Rule ID Generation","text":"<p>Template for generating rule IDs:</p> <pre><code>rule_id:\ntemplate: \"xccdf_cis_{platform}_rule_{ref_normalized}\"\nref_normalized: \"replace('.', '_')\" # 3.1.1 3_1_1\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#field-mappings","title":"Field Mappings","text":"<p>Core of the configuration. Each field mapping defines how to map one field.</p>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#simple-field-mapping","title":"Simple Field Mapping","text":"<p>Direct field copy with optional transform:</p> <pre><code>field_mappings:\ntitle:\ntarget_element: \"title\" # XCCDF element name\nsource_field: \"title\" # Source field on Recommendation\ntransform: \"strip_html\" # Transform to apply\ndescription: \"Rule title\" # Optional documentation\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#field-with-attributes","title":"Field with Attributes","text":"<p>Add attributes to XCCDF element:</p> <pre><code>fixtext:\ntarget_element: \"fixtext\"\nsource_field: \"remediation\"\ntransform: \"strip_html_keep_code\"\nattributes:\nfixref: \"F-{ref_normalized}\" # Variable substitution in attributes\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#static-content-field","title":"Static Content Field","text":"<p>Element with static content (no source):</p> <pre><code>fix:\ntarget_element: \"fix\"\ncontent: \"\" # Empty element\nattributes:\nid: \"F-{ref_normalized}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#composite-field","title":"Composite Field","text":"<p>Multiple sources joined into one target:</p> <pre><code>description:\ntarget_element: \"description\"\nstructure: \"composite\"\nsources:\n\n- field: \"description\"\ntransform: \"strip_html\"\n\n- field: \"rationale\"\ntransform: \"strip_html\"\nseparator: \"\\n\\n\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#embedded-xml-structure","title":"Embedded XML Structure","text":"<p>Build nested XML tags within element:</p> <pre><code>description:\ntarget_element: \"description\"\nstructure: \"embedded_xml_tags\"\ncomponents:\n# Component with sources\n\n- tag: \"VulnDiscussion\"\nsources:\n\n- field: \"description\"\ntransform: \"strip_html\"\nseparator: \"\\n\\n\"\n\n- field: \"rationale\"\ntransform: \"strip_html\"\ncombine: \"join\"\n\n# Component with static content\n\n- tag: \"FalsePositives\"\ncontent: \"\"\n\n# Optional component (only if source present)\n\n- tag: \"Mitigations\"\nsources:\n\n- field: \"additional_info\"\ntransform: \"strip_html\"\noptional: true\n\n# More components...\n\n- tag: \"IAControls\"\ncontent: \"\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#nested-structure","title":"Nested Structure","text":"<p>Nested XCCDF elements:</p> <pre><code>check:\ntarget_element: \"check\"\nstructure: \"nested\"\nattributes:\nsystem: \"C-{ref_normalized}\"\nchildren:\n\n- element: \"check-content\"\nsource_field: \"audit\"\ntransform: \"strip_html_keep_code\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#multiple-elements","title":"Multiple Elements","text":"<p>Create multiple elements from array:</p> <pre><code>ident:\ntarget_element: \"ident\"\nmultiple: true # Create multiple &lt;ident&gt; elements\nsource_logic: \"cci_lookup_with_deduplication\"\ncci_lookup:\nenabled: true\nmapping_file: \"data/cis-cci-mapping.json\"\nsource_field: \"cis_controls\"\nextract: \"all\" # primary + supporting\ndeduplicate_nist: true\nattributes:\nsystem: \"http://cyber.mil/cci\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#custom-namespace-elements","title":"Custom Namespace Elements","text":"<p>Elements in custom namespace:</p> <pre><code>metadata:\ntarget_element: \"metadata\"\nstructure: \"custom_namespace\"\nnamespace: \"http://cisecurity.org/xccdf/metadata/1.0\"\nenabled: true\ncomponents:\n\n- element: \"cis-control\"\nsource_field: \"cis_controls\"\nmultiple: true # Create multiple elements\nattributes:\nversion: \"{control.version}\"\nid: \"{control.control}\"\nig1: \"{control.ig1}\"\ncontent: \"{control.title}\"\n\n- element: \"profile\"\nsource_field: \"profiles\"\nmultiple: true\ncontent: \"{profile}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#component-mapping-options","title":"Component Mapping Options","text":"<p>Components are used in embedded XML and custom namespace structures:</p> <pre><code>components:\n# Component with multiple sources\n\n- tag: \"VulnDiscussion\" # XML tag name\nsources: # Multiple sources\n\n- field: \"description\" # Source field\ntransform: \"strip_html\" # Transform to apply\nseparator: \"\\n\\n\" # Separator between sources\n\n- field: \"rationale\"\ntransform: \"strip_html\"\ncombine: \"join\" # How to combine sources\n\n# Component with static content\n\n- tag: \"FalsePositives\"\ncontent: \"\" # Static content\n\n# Optional component (skip if source empty)\n\n- tag: \"Mitigations\"\nsources:\n\n- field: \"additional_info\"\ntransform: \"strip_html\"\noptional: true # Skip if source is None/empty\n\n# Component with attributes\n\n- element: \"reference\" # Element name (custom namespace)\nsource_field: \"nist_controls\"\nmultiple: true # Loop over array\nattributes:\nhref: \"https://csrc.nist.gov/...\"\ncontent: \"{nist_control_id}\" # Variable substitution\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#transformations-section","title":"Transformations Section","text":"<p>Define available transformations:</p> <pre><code>transformations:\n# Pass-through (no transformation)\nnone:\ndescription: \"Pass through unchanged\"\n\n# Strip all HTML\nstrip_html:\ndescription: \"Remove all HTML tags, return plain text\"\nfunction: \"HTMLCleaner.strip_html\"\n\n# Strip HTML but keep code/lists\nstrip_html_keep_code:\ndescription: \"Strip HTML but preserve code blocks and lists\"\nfunction: \"HTMLCleaner.strip_html_keep_code\"\npreserve_elements:\n\n- \"code\"\n- \"pre\"\n- \"ul\"\n- \"ol\"\n- \"li\"\n\n# Convert to Markdown\nhtml_to_markdown:\ndescription: \"Convert HTML to Markdown\"\nfunction: \"HTMLCleaner.html_to_markdown\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#variables-reference","title":"Variables Reference","text":"<p>Available variables for substitution in templates:</p>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#benchmark-level-variables","title":"Benchmark-Level Variables","text":"<pre><code># Available in benchmark mappings\n{platform} # Extracted from title (e.g., \"eks\")\n{benchmark_id} # CIS WorkBench ID (e.g., \"22605\")\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#rule-level-variables","title":"Rule-Level Variables","text":"<pre><code># Available in rule mappings\n{ref} # Original ref (e.g., \"3.1.1\")\n{ref_normalized} # Normalized ref (e.g., \"3_1_1\")\n{platform} # Same as benchmark level\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#nested-variables-in-loops","title":"Nested Variables (in loops)","text":"<pre><code># When iterating over CIS controls\n{control.version} # CIS Control version (7 or 8)\n{control.control} # Control ID (e.g., \"4.8\")\n{control.title} # Control title\n{control.ig1} # IG1 boolean\n{control.ig2} # IG2 boolean\n{control.ig3} # IG3 boolean\n\n# When iterating over NIST controls\n{nist_control_id} # NIST control (e.g., \"CM-7\")\n\n# When iterating over MITRE mappings\n{technique} # MITRE technique (e.g., \"T1068\")\n{tactic} # MITRE tactic (e.g., \"TA0001\")\n{mitigation} # MITRE mitigation (e.g., \"M1022\")\n\n# When iterating over profiles\n{profile} # Profile name (e.g., \"Level 1 - Server\")\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#source-field-reference","title":"Source Field Reference","text":"<p>Available source fields from Recommendation model:</p>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#core-fields","title":"Core Fields","text":"<pre><code>ref # Recommendation reference (e.g., \"3.1.1\")\ntitle # Recommendation title\nurl # Direct URL to recommendation\nassessment_status # \"Automated\" or \"Manual\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#classification-and-mappings","title":"Classification and Mappings","text":"<pre><code>profiles # List[str] - Applicable profiles\ncis_controls # List[CISControl] - CIS Controls mappings\nmitre_mapping # MITREMapping - MITRE ATT&amp;CK mappings\nnist_controls # List[str] - NIST control IDs\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#content-fields-html","title":"Content Fields (HTML)","text":"<pre><code>description # Detailed description (HTML)\nrationale # Rationale/justification (HTML)\nimpact # Impact statement (HTML)\naudit # Audit procedure (HTML)\nremediation # Remediation steps (HTML)\nadditional_info # Additional information (HTML)\ndefault_value # Default config value (HTML)\nartifact_equation # Artifact equation (HTML)\nreferences # External references (HTML)\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#nested-field-access","title":"Nested Field Access","text":"<p>Use dot notation for nested fields:</p> <pre><code># Access CIS Control attributes\nsource_field: \"cis_controls[0].control\" # First control ID\nsource_field: \"cis_controls[0].version\" # First control version\n\n# Access MITRE mapping\nsource_field: \"mitre_mapping.techniques\" # List of techniques\nsource_field: \"mitre_mapping.tactics\" # List of tactics\nsource_field: \"mitre_mapping.mitigations\" # List of mitigations\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#cci-deduplication-configuration","title":"CCI Deduplication Configuration","text":"<p>Complex logic for CCI/NIST deduplication:</p> <pre><code>cci_deduplication:\nenabled: true\nalgorithm:\ndescription: \"Use CCIs where available, NIST references for extras\"\nsteps:\n\n- \"Extract all CIS Controls from recommendation\"\n- \"Look up CCIs for each CIS Control (primary + supporting)\"\n- \"Determine which NIST controls are covered by those CCIs\"\n- \"Add CCIs as &lt;ident&gt; elements\"\n- \"Add uncovered NIST controls as &lt;reference&gt; elements\"\n\nmatching_rules:\ndescription: \"How to determine if CCI covers a NIST citation\"\nhierarchical: true # CM-7.1 covers CM-7\nexamples:\n\n- cci_maps_to: \"CM-7.1\"\ncis_cites: \"CM-7\"\nresult: \"covered\" # CCI is more specific\n\n- cci_maps_to: \"CM-7\"\ncis_cites: \"CM-7.1\"\nresult: \"not_covered\" # CCI too broad\n\n- cci_maps_to: \"CM-7(5)\"\ncis_cites: \"CM-7\"\nresult: \"covered\" # Enhancement covers base\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#validation-section","title":"Validation Section","text":"<p>Validation rules for export:</p> <pre><code>validation:\nrequire_cci_for_cis_controls: false # Warn if CCI missing\nrequire_nist_controls: false # Warn if NIST missing\nmax_cci_per_rule: 50 # Sanity check limit\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#complete-example","title":"Complete Example","text":"<p>Minimal working configuration:</p> <pre><code># minimal_style.yaml\nmetadata:\nstyle_name: \"minimal\"\ndescription: \"Minimal XCCDF export\"\nxccdf_version: \"1.2\"\n\nbenchmark:\nid_template: \"xccdf_cis_{platform}_benchmark\"\ntitle:\nsource: \"title\"\ntransform: \"none\"\nversion:\nsource: \"version\"\ntransform: \"none\"\n\nrule_defaults:\nseverity: \"medium\"\nweight: \"10.0\"\nselected: \"true\"\n\nrule_id:\ntemplate: \"xccdf_cis_{platform}_rule_{ref_normalized}\"\nref_normalized: \"replace('.', '_')\"\n\nfield_mappings:\ntitle:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\n\ndescription:\ntarget_element: \"description\"\nsource_field: \"description\"\ntransform: \"strip_html\"\n\nrationale:\ntarget_element: \"rationale\"\nsource_field: \"rationale\"\ntransform: \"strip_html\"\n\ntransformations:\nnone:\ndescription: \"Pass through unchanged\"\n\nstrip_html:\ndescription: \"Remove all HTML tags\"\nfunction: \"HTMLCleaner.strip_html\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#best-practices","title":"Best Practices","text":""},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#1-use-descriptive-names","title":"1. Use Descriptive Names","text":"<pre><code># Good\nfield_mappings:\nvuln_discussion:\ntarget_element: \"VulnDiscussion\"\ndescription: \"Combined description and rationale for DISA compliance\"\n\n# Bad\nfield_mappings:\nfield1:\ntarget_element: \"VulnDiscussion\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#2-document-complex-mappings","title":"2. Document Complex Mappings","text":"<pre><code># Add comments for complex logic\nfield_mappings:\ndescription:\ntarget_element: \"description\"\nstructure: \"embedded_xml_tags\"\n# This builds DISA STIG-compatible description with nested XML tags.\n# VulnDiscussion combines description + rationale per DISA requirements.\ncomponents:\n\n- tag: \"VulnDiscussion\"\n# ... more config\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#3-group-related-fields","title":"3. Group Related Fields","text":"<pre><code>field_mappings:\n# === CORE IDENTIFICATION ===\nversion:\n# ...\ntitle:\n# ...\n\n# === DESCRIPTION (Complex - Embedded XML Tags) ===\ndescription:\n# ...\n\n# === CCI IDENTIFIERS ===\nident:\n# ...\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#4-use-consistent-naming","title":"4. Use Consistent Naming","text":"<pre><code># Be consistent with ID templates\nrule_id:\ntemplate: \"xccdf_cis_{platform}_rule_{ref_normalized}\"\n\n# Use same pattern for other IDs\ncheck:\nattributes:\nsystem: \"C-{ref_normalized}\"\n\nfix:\nattributes:\nid: \"F-{ref_normalized}\"\n\nfixtext:\nattributes:\nfixref: \"F-{ref_normalized}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#5-handle-optional-fields-gracefully","title":"5. Handle Optional Fields Gracefully","text":"<pre><code># Mark optional fields explicitly\ncomponents:\n\n- tag: \"Mitigations\"\nsources:\n\n- field: \"additional_info\"\ntransform: \"strip_html\"\noptional: true # Skip if field is empty\n\n- tag: \"PotentialImpacts\"\nsources:\n\n- field: \"impact\"\ntransform: \"strip_html\"\noptional: true # Skip if field is empty\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#6-validate-your-config","title":"6. Validate Your Config","text":"<p>Before using in production:</p> <ol> <li> <p>Syntax check: Ensure valid YAML <pre><code>python -c \"import yaml; yaml.safe_load(open('config.yaml'))\"\n</code></pre></p> </li> <li> <p>Schema validation: Use ConfigLoader to validate <pre><code>from cis_bench.exporters.mapping import ConfigLoader\nconfig = ConfigLoader.load('your_config.yaml')\n</code></pre></p> </li> <li> <p>Test with sample data: Run on small benchmark first</p> </li> <li> <p>Validate XCCDF output: Check against NIST schema <pre><code>xmllint --schema xccdf_1.2.xsd output.xml --noout\n</code></pre></p> </li> </ol>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#common-patterns","title":"Common Patterns","text":""},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-1-simple-field-with-transform","title":"Pattern 1: Simple Field with Transform","text":"<pre><code>title:\ntarget_element: \"title\"\nsource_field: \"title\"\ntransform: \"strip_html\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-2-field-with-static-attributes","title":"Pattern 2: Field with Static Attributes","text":"<pre><code>fixtext:\ntarget_element: \"fixtext\"\nsource_field: \"remediation\"\ntransform: \"strip_html_keep_code\"\nattributes:\nfixref: \"F-{ref_normalized}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-3-empty-element-with-id","title":"Pattern 3: Empty Element with ID","text":"<pre><code>fix:\ntarget_element: \"fix\"\ncontent: \"\"\nattributes:\nid: \"F-{ref_normalized}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-4-composite-field-join-multiple-sources","title":"Pattern 4: Composite Field (Join Multiple Sources)","text":"<pre><code>combined_description:\ntarget_element: \"description\"\nstructure: \"composite\"\nsources:\n\n- field: \"description\"\ntransform: \"strip_html\"\n\n- field: \"rationale\"\ntransform: \"strip_html\"\nseparator: \"\\n\\n\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-5-embedded-xml-disa-stig-description","title":"Pattern 5: Embedded XML (DISA STIG Description)","text":"<pre><code>description:\ntarget_element: \"description\"\nstructure: \"embedded_xml_tags\"\ncomponents:\n\n- tag: \"VulnDiscussion\"\nsources:\n\n- field: \"description\"\ntransform: \"strip_html\"\n\n- field: \"rationale\"\ntransform: \"strip_html\"\nseparator: \"\\n\\n\"\n\n- tag: \"FalsePositives\"\ncontent: \"\"\n\n- tag: \"Mitigations\"\nsources:\n\n- field: \"additional_info\"\ntransform: \"strip_html\"\noptional: true\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-6-multiple-elements-from-array","title":"Pattern 6: Multiple Elements from Array","text":"<pre><code>reference:\ntarget_element: \"reference\"\nmultiple: true\nsource_field: \"nist_controls\"\nattributes:\nhref: \"https://csrc.nist.gov/Projects/risk-management/sp800-53-controls\"\ncontent: \"{nist_control_id}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#pattern-7-custom-namespace-metadata","title":"Pattern 7: Custom Namespace Metadata","text":"<pre><code>metadata:\ntarget_element: \"metadata\"\nstructure: \"custom_namespace\"\nnamespace: \"http://cisecurity.org/xccdf/metadata/1.0\"\ncomponents:\n\n- element: \"cis-control\"\nsource_field: \"cis_controls\"\nmultiple: true\nattributes:\nversion: \"{control.version}\"\nid: \"{control.control}\"\ncontent: \"{control.title}\"\n</code></pre>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#troubleshooting","title":"Troubleshooting","text":""},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#issue-transform-not-found","title":"Issue: Transform Not Found","text":"<pre><code>Error: Transform 'unknown_transform' not found\n</code></pre> <p>Solution: Check <code>transformations</code> section. Available transforms:</p> <ul> <li>none</li> <li>strip_html</li> <li>strip_html_keep_code</li> <li>html_to_markdown</li> </ul>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#issue-source-field-not-found","title":"Issue: Source Field Not Found","text":"<pre><code>Error: Source field 'nonexistent_field' not found on Recommendation\n</code></pre> <p>Solution: Check field name spelling. Available fields:</p> <ul> <li>ref, title, url, assessment_status</li> <li>description, rationale, impact, audit, remediation</li> <li>cis_controls, mitre_mapping, nist_controls</li> <li>See \"Source Field Reference\" section</li> </ul>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#issue-variable-not-resolved","title":"Issue: Variable Not Resolved","text":"<pre><code>Error: Variable 'unknown_var' not found in template\n</code></pre> <p>Solution: Check variable name. Available variables:</p> <ul> <li>{ref}, {ref_normalized}, {platform}</li> <li>{control.version}, {control.control}</li> <li>{nist_control_id}, {technique}, {tactic}</li> <li>See \"Variables Reference\" section</li> </ul>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#issue-invalid-yaml-syntax","title":"Issue: Invalid YAML Syntax","text":"<pre><code>Error: YAML parsing failed\n</code></pre> <p>Solution: Validate YAML syntax:</p> <ul> <li>Consistent indentation (spaces, not tabs)</li> <li>Proper quoting of strings with special characters</li> <li>Valid list and dict syntax</li> </ul>"},{"location":"technical-reference/YAML_CONFIG_REFERENCE/#related-documents","title":"Related Documents","text":"<ul> <li>MAPPING_ENGINE_DESIGN.md - Complete design</li> <li>DISA Style Example - Complete YAML example</li> </ul> <p>Version: 1.0.0 Date: 2025-10-18</p>"},{"location":"user-guide/catalog-guide/","title":"Catalog Guide","text":"<p>The catalog feature provides fast, searchable access to 1,300+ CIS benchmarks with platform filtering and full-text search.</p> <p>Documentation Path</p> <p>You are here: User Guide &gt; Catalog System</p> <ul> <li>For commands: See Commands Reference</li> <li>For examples: See Workflows</li> <li>For terms: See Glossary</li> </ul>"},{"location":"user-guide/catalog-guide/#overview","title":"Overview","text":"<p>What is the Catalog?</p> <p>A local SQLite database with full-text search containing metadata for all CIS benchmarks:</p> <ul> <li>Benchmark titles, versions, and IDs</li> <li>Platform taxonomy (cloud, os, database, container, application)</li> <li>Status (Published, Draft, Archived)</li> <li>Communities and owners</li> <li>~1,300+ benchmarks indexed</li> </ul> <p>Benefits:</p> <ul> <li>Fast local search (no network required)</li> <li>Platform filtering (find all cloud benchmarks, databases, etc.)</li> <li>Full-text search with FTS5</li> <li>Discover what's available without browsing WorkBench</li> <li>Track benchmark versions</li> <li>Scriptable with JSON/CSV output</li> </ul>"},{"location":"user-guide/catalog-guide/#quick-start","title":"Quick Start","text":""},{"location":"user-guide/catalog-guide/#1-first-time-setup","title":"1. First Time Setup","text":"<pre><code># Login (one-time)\ncis-bench auth login --browser chrome\n\n# Build catalog (one-time, ~2 minutes)\ncis-bench catalog refresh\n</code></pre> <p>What catalog refresh does:</p> <ul> <li>Scrapes ~66 pages from CIS WorkBench</li> <li>Parallel processing (10 pages/batch, 5 threads)</li> <li>Builds searchable database</li> <li>Infers platform taxonomy automatically</li> <li>Takes ~2 minutes (vs ~10 min sequential)</li> <li>Stored in: <code>~/.cis-bench/catalog.db</code></li> </ul>"},{"location":"user-guide/catalog-guide/#2-search-and-use","title":"2. Search and Use","text":"<pre><code># Search for benchmarks\ncis-bench search \"ubuntu 22\"\n\n# Get benchmark in one command\ncis-bench get \"ubuntu 22\" --format xccdf --style cis\n</code></pre> <p>That's it! The catalog makes discovery fast and easy.</p>"},{"location":"user-guide/catalog-guide/#searching-the-catalog","title":"Searching the Catalog","text":""},{"location":"user-guide/catalog-guide/#basic-search","title":"Basic Search","text":"<p>Use the top-level <code>search</code> command (recommended):</p> <pre><code>cis-bench search \"ubuntu\"\ncis-bench search \"oracle cloud\"\ncis-bench search \"kubernetes\"\n</code></pre> <p>Search features:</p> <ul> <li>Full-text search with FTS5</li> <li>Fuzzy matching</li> <li>Searches titles, platforms, communities</li> <li>Returns up to 1000 results by default</li> </ul>"},{"location":"user-guide/catalog-guide/#platform-filtering","title":"Platform Filtering","text":"<p>Filter by category (platform-type): <pre><code># Find all cloud benchmarks\ncis-bench search --platform-type cloud\n\n# Find all databases\ncis-bench search --platform-type database\n\n# Find all operating systems\ncis-bench search --platform-type os\n\n# Find all container platforms\ncis-bench search --platform-type container\n</code></pre></p> <p>Platform categories:</p> <ul> <li><code>cloud</code> - AWS, Azure, GCP, Oracle Cloud, Alibaba Cloud, IBM Cloud</li> <li><code>os</code> - Ubuntu, RHEL, Windows, AlmaLinux, Oracle Linux, macOS, Debian</li> <li><code>database</code> - MySQL, PostgreSQL, Oracle DB, MongoDB, MSSQL</li> <li><code>container</code> - Kubernetes, Docker, EKS, AKS, GKE, OKE</li> <li><code>application</code> - NGINX, Apache, Tomcat</li> </ul> <p>Filter by specific platform: <pre><code># Find Ubuntu benchmarks\ncis-bench search --platform ubuntu\n\n# Find AWS benchmarks\ncis-bench search --platform aws\n\n# Combine: Oracle + cloud\ncis-bench search oracle --platform-type cloud\n</code></pre></p>"},{"location":"user-guide/catalog-guide/#advanced-filtering","title":"Advanced Filtering","text":"<pre><code># Latest versions only\ncis-bench search \"windows server\" --latest\n\n# Different status\ncis-bench search \"docker\" --status Archived\n\n# Limit results\ncis-bench search \"linux\" --limit 10\n\n# Combine filters\ncis-bench search \"oracle\" --platform-type cloud --latest --limit 5\n</code></pre>"},{"location":"user-guide/catalog-guide/#output-formats","title":"Output Formats","text":"<pre><code># JSON for scripting\ncis-bench search oracle --platform-type cloud --output-format json | jq\n\n# CSV for spreadsheets\ncis-bench search \"ubuntu\" --latest --output-format csv &gt; ubuntu_benchmarks.csv\n\n# YAML\ncis-bench search \"aws\" --output-format yaml\n</code></pre>"},{"location":"user-guide/catalog-guide/#catalog-information","title":"Catalog Information","text":""},{"location":"user-guide/catalog-guide/#platform-list","title":"Platform List","text":"<p>See all platforms with benchmark counts:</p> <pre><code>cis-bench catalog platforms\ncis-bench catalog platforms --output-format json\n</code></pre>"},{"location":"user-guide/catalog-guide/#statistics","title":"Statistics","text":"<p>View catalog statistics:</p> <pre><code>cis-bench catalog stats\n</code></pre> <p>Shows:</p> <ul> <li>Total benchmarks in catalog</li> <li>Published vs archived counts</li> <li>Downloaded benchmarks count</li> <li>Platforms and communities count</li> <li>Last refresh date</li> </ul>"},{"location":"user-guide/catalog-guide/#benchmark-details","title":"Benchmark Details","text":"<p>Get details for a specific benchmark:</p> <pre><code>cis-bench catalog info 23598\ncis-bench catalog info 23598 --output-format json\n</code></pre> <p>Shows:</p> <ul> <li>Title and version</li> <li>Status and platform</li> <li>Community and owner</li> <li>Published date</li> <li>URL</li> </ul>"},{"location":"user-guide/catalog-guide/#using-the-catalog","title":"Using the Catalog","text":""},{"location":"user-guide/catalog-guide/#recommended-workflow","title":"Recommended Workflow","text":"<p>Option 1: Use <code>get</code> command (easiest) <pre><code>cis-bench get \"ubuntu 22\" --format xccdf --style cis\n</code></pre></p> <p>Searches Downloads Exports in one command!</p> <p>Option 2: Search then download <pre><code># 1. Search to find ID\ncis-bench search \"oracle cloud\"\n\n# 2. Download by ID\ncis-bench download 23598\n\n# 3. Export\ncis-bench export 23598 --format xccdf\n</code></pre></p> <p>Option 3: Scripting workflow <pre><code># Get all Oracle Cloud benchmark IDs and download\ncis-bench search oracle --platform-type cloud --latest --output-format json | \\\njq -r '.[].benchmark_id' | \\\nxargs -I {} cis-bench download {}\n</code></pre></p>"},{"location":"user-guide/catalog-guide/#catalog-maintenance","title":"Catalog Maintenance","text":""},{"location":"user-guide/catalog-guide/#when-to-refresh","title":"When to Refresh","text":"<p>Refresh the catalog when:</p> <ul> <li>New benchmarks released (monthly)</li> <li>You want latest versions</li> <li>Platform coverage changes</li> </ul> <pre><code>cis-bench catalog refresh\n</code></pre> <p>Note: Downloaded benchmarks are cached separately. Refreshing catalog updates metadata only, not downloaded content.</p>"},{"location":"user-guide/catalog-guide/#check-for-updates","title":"Check for Updates","text":"<p>See which downloaded benchmarks have updates:</p> <pre><code>cis-bench catalog check-updates\n</code></pre>"},{"location":"user-guide/catalog-guide/#performance","title":"Performance","text":""},{"location":"user-guide/catalog-guide/#parallel-scraping","title":"Parallel Scraping","text":"<p>Default behavior:</p> <ul> <li>Batches: 10 pages per batch</li> <li>Threads: 5 concurrent per batch</li> <li>Rate limit: 2 seconds between batches</li> <li>Retry: 3 attempts with exponential backoff</li> <li>Failure threshold: Aborts if &gt;10% of pages fail</li> </ul> <p>Performance:</p> <ul> <li>Full 66 pages: ~2 minutes</li> <li>Per page: ~2 seconds (with parallelism)</li> <li>Respectful to CIS servers</li> </ul> <p>Tuning: <pre><code># Faster (less polite)\ncis-bench catalog refresh --rate-limit 1.0\n\n# Test with few pages\ncis-bench catalog refresh --max-pages 5\n</code></pre></p>"},{"location":"user-guide/catalog-guide/#database-schema","title":"Database Schema","text":""},{"location":"user-guide/catalog-guide/#tables","title":"Tables","text":"<p>catalog_benchmarks:</p> <ul> <li>Metadata for all benchmarks</li> <li>Fields: id, title, version, status, platform_type, platform, etc.</li> </ul> <p>downloaded_benchmarks:</p> <ul> <li>Full benchmark JSON content</li> <li>Cached for instant re-export</li> </ul> <p>benchmarks_fts:</p> <ul> <li>FTS5 virtual table for full-text search</li> <li>Indexes: title, platform, community, description</li> </ul>"},{"location":"user-guide/catalog-guide/#platform-inference","title":"Platform Inference","text":"<p>Platforms are automatically inferred from benchmark titles:</p> <p>Examples:</p> <ul> <li>\"CIS Ubuntu Linux 22.04\" platform_type: os, platform: ubuntu</li> <li>\"CIS Amazon Web Services\" platform_type: cloud, platform: aws</li> <li>\"CIS Oracle Database 19c\" platform_type: database, platform: oracle-database</li> <li>\"CIS Kubernetes V1.28\" platform_type: container, platform: kubernetes</li> </ul> <p>40+ patterns for accurate inference!</p>"},{"location":"user-guide/catalog-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/catalog-guide/#catalog-not-found","title":"Catalog Not Found","text":"<p>Error: \"Catalog not found\"</p> <p>Solution: <pre><code>cis-bench catalog refresh\n</code></pre></p>"},{"location":"user-guide/catalog-guide/#search-returns-no-results","title":"Search Returns No Results","text":"<p>Check: 1. Is query too specific? Try broader terms 2. Use <code>--status Archived</code> to see archived benchmarks 3. Remove <code>--latest</code> to see all versions 4. Try <code>--platform-type</code> instead of exact platform name</p> <p>Examples: <pre><code># Too specific\ncis-bench search \"Ubuntu Linux 22.04 LTS Server Edition\"\n\n# Better\ncis-bench search \"ubuntu 22\"\n\n# Best\ncis-bench search --platform-type os --platform ubuntu\n</code></pre></p>"},{"location":"user-guide/catalog-guide/#refresh-failed","title":"Refresh Failed","text":"<p>Common causes:</p> <ul> <li>Not authenticated: <code>cis-bench auth login --browser chrome</code></li> <li>Network issues: Check internet connection</li> <li>CIS WorkBench down: Try again later</li> <li>SSL errors: Use <code>--no-verify-ssl</code> or set REQUESTS_CA_BUNDLE</li> </ul> <p>Retry logic:</p> <ul> <li>Automatically retries failed pages (3 attempts)</li> <li>Continues if failure rate is low (&lt;10%)</li> <li>Aborts if too many failures (indicates bigger issue)</li> </ul>"},{"location":"user-guide/catalog-guide/#advanced-usage","title":"Advanced Usage","text":""},{"location":"user-guide/catalog-guide/#programmatic-access","title":"Programmatic Access","text":"<pre><code># Get all cloud benchmarks as JSON\ncis-bench search --platform-type cloud --output-format json &gt; cloud_benchmarks.json\n\n# Count benchmarks by platform\ncis-bench catalog platforms --output-format json | jq '.[] | {platform: .name, count: .count}'\n\n# Find latest Oracle benchmarks\ncis-bench search oracle --latest --output-format json | \\\njq -r '.[] | \"\\(.benchmark_id): \\(.title) \\(.version)\"'\n</code></pre>"},{"location":"user-guide/catalog-guide/#batch-operations","title":"Batch Operations","text":"<pre><code># Download all latest Ubuntu benchmarks\ncis-bench search ubuntu --latest --output-format json | \\\njq -r '.[].benchmark_id' | \\\nxargs -I {} cis-bench download {}\n\n# Export all downloaded to XCCDF\ncis-bench list --output-format json | \\\njq -r '.[].file' | \\\nxargs -I {} basename {} .json | \\\nxargs -I {} cis-bench export {} --format xccdf --style cis\n</code></pre>"},{"location":"user-guide/catalog-guide/#database-location","title":"Database Location","text":"<p>Production:</p> <ul> <li><code>~/.cis-bench/catalog.db</code></li> </ul> <p>Development: <pre><code>export CIS_BENCH_ENV=dev\ncis-bench catalog refresh\n# Stored in: ~/.cis-bench-dev/catalog.db\n</code></pre></p> <p>Test:</p> <ul> <li>Automatic test isolation</li> <li><code>/tmp/cis-bench-test/catalog.db</code></li> </ul>"},{"location":"user-guide/catalog-guide/#see-also","title":"See Also","text":"<ul> <li>Getting Started - Initial setup</li> <li>Commands Reference - All commands</li> <li>Configuration - Environment settings</li> <li>Search Command - Detailed search docs</li> </ul>"},{"location":"user-guide/commands-reference/","title":"Command Reference","text":"<p>Complete reference for all CIS Benchmark CLI commands.</p> <p>Quick Navigation</p> <ul> <li>Looking for examples? See End-to-End Workflows for real-world scenarios</li> <li>Need help? See Troubleshooting for common issues</li> <li>Confused by terms? See Glossary for definitions</li> </ul>"},{"location":"user-guide/commands-reference/#global-options","title":"Global Options","text":"<p>Available on all commands:</p> <p>Logging Levels: <pre><code>cis-bench --verbose &lt;command&gt; # Show DEBUG level logs\ncis-bench --debug &lt;command&gt; # Same as --verbose\ncis-bench --quiet &lt;command&gt; # Only warnings and errors\n</code></pre></p> <p>Per-Command Flags: Most commands also accept <code>-v, --verbose</code>, <code>-d, --debug</code>, <code>-q, --quiet</code> flags at the end.</p> <p>Other Global Options: <pre><code>cis-bench --version # Show version\ncis-bench --help # Show help\n</code></pre></p>"},{"location":"user-guide/commands-reference/#authentication-commands","title":"Authentication Commands","text":""},{"location":"user-guide/commands-reference/#cis-bench-auth-login","title":"<code>cis-bench auth login</code>","text":"<p>Log in to CIS WorkBench and save session for future use.</p> <p>Syntax: <pre><code>cis-bench auth login --browser &lt;browser&gt; [OPTIONS]\n</code></pre></p> <p>Required Options:</p> <ul> <li><code>-b, --browser</code> - Browser to extract cookies from (chrome|firefox|edge|safari)</li> </ul> <p>Optional Flags:</p> <ul> <li><code>--open</code> - Open CIS WorkBench login page in browser</li> <li><code>--no-verify-ssl</code> - Disable SSL certificate verification</li> </ul> <p>Examples: <pre><code># Login and open browser\ncis-bench auth login --browser chrome --open\n\n# Login (you're already logged in browser)\ncis-bench auth login --browser chrome\n\n# Login with SSL verification disabled\ncis-bench auth login --browser chrome --no-verify-ssl\n</code></pre></p> <p>What it does: 1. Optionally opens browser to CIS WorkBench 2. Extracts session cookies from your browser 3. Validates the session 4. Saves to <code>~/.cis-bench/session.cookies</code> 5. All future commands use this saved session</p>"},{"location":"user-guide/commands-reference/#cis-bench-auth-status","title":"<code>cis-bench auth status</code>","text":"<p>Check if you're logged in and session is valid.</p> <p>Syntax: <pre><code>cis-bench auth status [OPTIONS]\n</code></pre></p> <p>Options:</p> <ul> <li><code>-o, --output-format</code> - Output format (table|json|yaml)</li> </ul> <p>Examples: <pre><code># Check status\ncis-bench auth status\n\n# JSON output for scripting\ncis-bench auth status --output-format json\n</code></pre></p> <p>Output: <pre><code>{\n\"logged_in\": true,\n\"session_file\": \"/Users/username/.cis-bench/session.cookies\",\n\"cookie_count\": 5,\n\"ssl_verify\": false\n}\n</code></pre></p>"},{"location":"user-guide/commands-reference/#cis-bench-auth-logout","title":"<code>cis-bench auth logout</code>","text":"<p>Clear saved session and log out.</p> <p>Syntax: <pre><code>cis-bench auth logout\n</code></pre></p> <p>Example: <pre><code>cis-bench auth logout\n</code></pre></p> <p>What it does:</p> <ul> <li>Deletes <code>~/.cis-bench/session.cookies</code></li> <li>You'll need to run <code>auth login</code> again to use commands</li> </ul>"},{"location":"user-guide/commands-reference/#search-and-discovery","title":"Search and Discovery","text":""},{"location":"user-guide/commands-reference/#cis-bench-search","title":"<code>cis-bench search</code>","text":"<p>Search for CIS benchmarks in local catalog.</p> <p>Syntax: <pre><code>cis-bench search [QUERY] [OPTIONS]\n</code></pre></p> <p>Arguments:</p> <ul> <li><code>QUERY</code> - Search query (optional, omit to list all)</li> </ul> <p>Filter Options:</p> <ul> <li><code>--platform</code> - Filter by specific platform (e.g., ubuntu, aws, oracle-database)</li> <li><code>--platform-type</code> - Filter by category (cloud, os, database, container, application)</li> <li><code>--status</code> - Filter by status (Published, Archived, Draft) - default: Published</li> <li><code>--latest</code> - Show only latest version of each benchmark</li> <li><code>--limit</code> - Maximum results to show (default: 1000)</li> </ul> <p>Output Options:</p> <ul> <li><code>-o, --output-format</code> - Format (table|json|csv|yaml) - default: table</li> </ul> <p>Examples: <pre><code># Basic search\ncis-bench search \"ubuntu 22.04\"\ncis-bench search \"oracle cloud\"\n\n# Filter by platform category\ncis-bench search --platform-type cloud\ncis-bench search --platform-type database --latest\n\n# Filter by specific platform\ncis-bench search --platform aws\ncis-bench search oracle --platform-type cloud\n\n# Scripting with JSON\ncis-bench search \"ubuntu\" --latest --output-format json | jq\ncis-bench search --platform-type cloud --output-format csv\n\n# List all published benchmarks\ncis-bench search\n</code></pre></p> <p>Requirements:</p> <ul> <li>Must have catalog initialized: <code>cis-bench catalog refresh</code></li> <li>If no catalog, shows helpful message with instructions</li> </ul> <p>Platform Types:</p> <ul> <li><code>cloud</code> - AWS, Azure, GCP, Oracle Cloud, Alibaba Cloud, IBM Cloud</li> <li><code>os</code> - Ubuntu, RHEL, Windows, AlmaLinux, Oracle Linux, macOS</li> <li><code>database</code> - MySQL, PostgreSQL, Oracle DB, MongoDB, MSSQL</li> <li><code>container</code> - Kubernetes, Docker, EKS, AKS, GKE</li> <li><code>application</code> - NGINX, Apache, Tomcat</li> </ul>"},{"location":"user-guide/commands-reference/#cis-bench-get","title":"<code>cis-bench get</code>","text":"<p>Unified command: search + download + export in one step.</p> <p>Syntax: <pre><code>cis-bench get &lt;QUERY&gt; [OPTIONS]\n</code></pre></p> <p>Arguments:</p> <ul> <li><code>QUERY</code> - Search query for benchmark</li> </ul> <p>Export Options:</p> <ul> <li><code>-f, --format</code> - Export format (yaml|csv|markdown|md|xccdf|xml|json) - default: yaml</li> <li><code>--style</code> - XCCDF style (disa|cis) - default: disa, only for xccdf format</li> <li><code>-o, --output</code> - Output file path (default: auto-generated)</li> </ul> <p>Auth Options:</p> <ul> <li><code>-b, --browser</code> - Browser for auth (only needed if no saved session)</li> </ul> <p>Behavior Options:</p> <ul> <li><code>--non-interactive</code> - Disable interactive prompts (show table instead)</li> </ul> <p>Output Options:</p> <ul> <li><code>-v, --verbose</code> - Enable verbose logging</li> <li><code>-d, --debug</code> - Enable debug logging</li> <li><code>-q, --quiet</code> - Quiet mode</li> </ul> <p>Examples: <pre><code># Get and export in one command\ncis-bench get \"ubuntu 22.04\" --format xccdf --style cis\n\n# Get AWS benchmark\ncis-bench get \"aws eks\" --format yaml\n\n# Non-interactive mode (for CI/scripts)\ncis-bench get \"oracle cloud\" --format json --non-interactive\n</code></pre></p> <p>What it does: 1. Searches catalog for your query 2. If single match: selects it automatically 3. If multiple matches: shows interactive menu (or table if --non-interactive) 4. Checks if already downloaded (uses cache) 5. If not cached: downloads benchmark 6. Exports to requested format 7. Shows output file path</p> <p>Requirements:</p> <ul> <li>Catalog must be initialized</li> <li>Must be authenticated (saved session or --browser flag)</li> </ul>"},{"location":"user-guide/commands-reference/#download-and-management","title":"Download and Management","text":""},{"location":"user-guide/commands-reference/#cis-bench-download","title":"<code>cis-bench download</code>","text":"<p>Download benchmarks by ID.</p> <p>Syntax: <pre><code>cis-bench download &lt;BENCHMARK_ID&gt; [BENCHMARK_ID...] [OPTIONS]\n</code></pre></p> <p>Arguments:</p> <ul> <li><code>BENCHMARK_ID</code> - One or more benchmark IDs or URLs</li> </ul> <p>Input Options:</p> <ul> <li><code>-f, --file PATH</code> - File containing URLs/IDs (one per line)</li> </ul> <p>Auth Options:</p> <ul> <li><code>-b, --browser</code> - Browser for auth (only needed if no saved session)</li> <li><code>-c, --cookies PATH</code> - Use cookies from file instead of saved session</li> </ul> <p>Output Options:</p> <ul> <li><code>-o, --output-dir PATH</code> - Output directory (default: ./benchmarks)</li> <li><code>--format</code> - Export formats (json|yaml|csv|markdown|xccdf) - can specify multiple</li> </ul> <p>Behavior Options:</p> <ul> <li><code>--force</code> - Force re-download even if already cached</li> <li><code>--no-verify-ssl</code> - Disable SSL verification</li> <li><code>-v, --verbose</code> - Verbose logging</li> <li><code>-d, --debug</code> - Debug logging</li> <li><code>-q, --quiet</code> - Quiet mode</li> </ul> <p>Examples: <pre><code># Download single benchmark (uses saved session)\ncis-bench download 23598\n\n# Download multiple\ncis-bench download 23598 22605 18208\n\n# Force re-download (skip cache check)\ncis-bench download 23598 --force\n\n# Download with multiple export formats\ncis-bench download 23598 --format json --format xccdf\n\n# Download from file\ncis-bench download --file urls.txt\n\n# First time (no saved session)\ncis-bench download 23598 --browser chrome\n</code></pre></p> <p>What it does: 1. Checks if already cached (shows message if yes, unless --force) 2. Authenticates (uses saved session or --browser) 3. Downloads benchmark from WorkBench with progress bar 4. Saves to database cache 5. Saves to file in output directory 6. Exports to requested formats</p>"},{"location":"user-guide/commands-reference/#cis-bench-export","title":"<code>cis-bench export</code>","text":"<p>Export benchmark to different formats.</p> <p>Syntax: <pre><code>cis-bench export &lt;IDENTIFIER&gt; [OPTIONS]\n</code></pre></p> <p>Arguments:</p> <ul> <li><code>IDENTIFIER</code> - Benchmark ID (numeric) OR file path</li> </ul> <p>Export Options:</p> <ul> <li><code>-f, --format</code> - Format (yaml|csv|markdown|md|xccdf|xml) - default: yaml</li> <li><code>--style</code> - XCCDF style (disa|cis) - default: disa, only for xccdf</li> <li><code>-o, --output PATH</code> - Output file (default: auto-generated)</li> </ul> <p>Input Options:</p> <ul> <li><code>--input-dir PATH</code> - Input directory for file paths (default: ./benchmarks)</li> </ul> <p>Examples: <pre><code># Export from database by ID\ncis-bench export 23598 --format xccdf --style cis\ncis-bench export 23598 --format yaml\n\n# Export from file\ncis-bench export benchmark.json --format xccdf --style disa\ncis-bench export benchmark.json --format csv -o output.csv\n\n# All formats\ncis-bench export 23598 --format yaml\ncis-bench export 23598 --format csv\ncis-bench export 23598 --format markdown\ncis-bench export 23598 --format xccdf --style disa\ncis-bench export 23598 --format xccdf --style cis\n</code></pre></p> <p>XCCDF Styles:</p> <ul> <li><code>disa</code> - DISA/DoD STIG format (XCCDF 1.1.4, CCIs, VulnDiscussion)</li> <li><code>cis</code> - CIS native format (XCCDF 1.2, CIS Controls, MITRE ATT&amp;CK)</li> </ul>"},{"location":"user-guide/commands-reference/#cis-bench-list","title":"<code>cis-bench list</code>","text":"<p>List downloaded benchmarks.</p> <p>Syntax: <pre><code>cis-bench list [OPTIONS]\n</code></pre></p> <p>Options:</p> <ul> <li><code>--output-dir PATH</code> - Directory to scan (default: ./benchmarks)</li> <li><code>-o, --output-format</code> - Format (table|json|csv|yaml) - default: table</li> </ul> <p>Examples: <pre><code># List all downloaded benchmarks\ncis-bench list\n\n# JSON output\ncis-bench list --output-format json | jq\n\n# CSV export\ncis-bench list --output-format csv &gt; inventory.csv\n</code></pre></p> <p>Output Fields:</p> <ul> <li>Title</li> <li>Version</li> <li>Recommendations count</li> <li>CIS Controls v8 count</li> <li>MITRE mappings count</li> <li>NIST controls count</li> <li>Filename</li> </ul>"},{"location":"user-guide/commands-reference/#cis-bench-info","title":"<code>cis-bench info</code>","text":"<p>Show detailed information about a benchmark.</p> <p>Syntax: <pre><code>cis-bench info &lt;FILENAME&gt; [OPTIONS]\n</code></pre></p> <p>Arguments:</p> <ul> <li><code>FILENAME</code> - Benchmark JSON file</li> </ul> <p>Options:</p> <ul> <li><code>--output-dir PATH</code> - Directory containing benchmark (default: ./benchmarks)</li> <li><code>-o, --output-format</code> - Format (table|json|yaml) - default: table</li> </ul> <p>Examples: <pre><code># Show benchmark details\ncis-bench info benchmark.json\n\n# JSON output\ncis-bench info benchmark.json --output-format json\n\n# YAML output\ncis-bench info benchmark.json --output-format yaml\n</code></pre></p> <p>Displays:</p> <ul> <li>Title, version, benchmark ID</li> <li>Downloaded date, scraper version</li> <li>Total recommendations</li> <li>CIS Controls counts (v7, v8)</li> <li>MITRE mappings count</li> <li>NIST controls count</li> <li>Sample recommendations</li> </ul>"},{"location":"user-guide/commands-reference/#catalog-management","title":"Catalog Management","text":""},{"location":"user-guide/commands-reference/#cis-bench-catalog-refresh","title":"<code>cis-bench catalog refresh</code>","text":"<p>Build or refresh the searchable catalog database.</p> <p>Syntax: <pre><code>cis-bench catalog refresh [OPTIONS]\n</code></pre></p> <p>Options:</p> <ul> <li><code>--browser TEXT</code> - Browser for auth (default: chrome)</li> <li><code>--max-pages INTEGER</code> - Limit pages to scrape (for testing)</li> <li><code>--rate-limit FLOAT</code> - Seconds between batches (default: 2.0)</li> </ul> <p>Examples: <pre><code># Full catalog refresh (~2 minutes with parallel scraping)\ncis-bench catalog refresh\n\n# Test with limited pages\ncis-bench catalog refresh --max-pages 5\n\n# Faster scraping (less polite)\ncis-bench catalog refresh --rate-limit 1.0\n</code></pre></p> <p>What it does: 1. Authenticates with WorkBench 2. Scrapes catalog pages in parallel (10 pages/batch, 5 threads) 3. Detects ~66 pages automatically 4. Builds searchable database with ~1,300+ benchmarks 5. Creates FTS5 full-text search index 6. Takes ~2 minutes for full catalog</p> <p>Performance:</p> <ul> <li>Parallel: 10 pages per batch</li> <li>Threads: 5 concurrent</li> <li>Retry logic: 3 attempts with backoff</li> <li>Failure threshold: Aborts if &gt;10% fail</li> </ul>"},{"location":"user-guide/commands-reference/#cis-bench-catalog-search","title":"<code>cis-bench catalog search</code>","text":"<p>Search catalog (similar to top-level search).</p> <p>Syntax: <pre><code>cis-bench catalog search [QUERY] [OPTIONS]\n</code></pre></p> <p>See <code>cis-bench search</code> for options and examples.</p>"},{"location":"user-guide/commands-reference/#cis-bench-catalog-info","title":"<code>cis-bench catalog info</code>","text":"<p>Show catalog information for a benchmark.</p> <p>Syntax: <pre><code>cis-bench catalog info &lt;BENCHMARK_ID&gt; [OPTIONS]\n</code></pre></p> <p>Options:</p> <ul> <li><code>-o, --output-format</code> - Format (table|json|yaml)</li> </ul>"},{"location":"user-guide/commands-reference/#cis-bench-catalog-platforms","title":"<code>cis-bench catalog platforms</code>","text":"<p>List all platforms with benchmark counts.</p> <p>Syntax: <pre><code>cis-bench catalog platforms [OPTIONS]\n</code></pre></p> <p>Options:</p> <ul> <li><code>-o, --output-format</code> - Format (table|json|csv|yaml)</li> </ul> <p>Example: <pre><code>cis-bench catalog platforms\ncis-bench catalog platforms --output-format json\n</code></pre></p>"},{"location":"user-guide/commands-reference/#cis-bench-catalog-stats","title":"<code>cis-bench catalog stats</code>","text":"<p>Show catalog statistics.</p> <p>Syntax: <pre><code>cis-bench catalog stats [OPTIONS]\n</code></pre></p> <p>Options:</p> <ul> <li><code>-o, --output-format</code> - Format (table|json|yaml)</li> </ul> <p>Example: <pre><code>cis-bench catalog stats\ncis-bench catalog stats --output-format json\n</code></pre></p> <p>Shows:</p> <ul> <li>Total benchmarks</li> <li>Published benchmarks</li> <li>Downloaded benchmarks count</li> <li>Platforms count</li> <li>Communities count</li> <li>Last refresh date</li> </ul>"},{"location":"user-guide/commands-reference/#output-formats","title":"Output Formats","text":"<p>All query commands support <code>--output-format</code> for scripting:</p> <p>Available Formats:</p> <ul> <li><code>table</code> - Human-friendly table (default)</li> <li><code>json</code> - JSON for piping to jq, etc.</li> <li><code>csv</code> - CSV for spreadsheets</li> <li><code>yaml</code> - YAML for configs</li> </ul> <p>Commands Supporting Output Formats:</p> <ul> <li><code>search</code></li> <li><code>list</code></li> <li><code>info</code></li> <li><code>auth status</code></li> <li><code>catalog search</code></li> <li><code>catalog info</code></li> <li><code>catalog platforms</code></li> <li><code>catalog stats</code></li> </ul> <p>Scripting Examples: <pre><code># Get benchmark IDs\ncis-bench search oracle --platform-type cloud --output-format json | jq -r '.[].benchmark_id'\n\n# Export to CSV\ncis-bench search \"ubuntu\" --latest --output-format csv &gt; benchmarks.csv\n\n# Check auth in scripts\nif cis-bench auth status --output-format json 2&gt;/dev/null | jq -r '.logged_in' | grep -q true; then\necho \"Authenticated\"\nfi\n\n# Download all Oracle Cloud benchmarks\ncis-bench search oracle --platform-type cloud --latest --output-format json | \\\njq -r '.[].benchmark_id' | \\\nxargs -I {} cis-bench download {}\n</code></pre></p>"},{"location":"user-guide/commands-reference/#environment-variables","title":"Environment Variables","text":"<p>Session/Auth:</p> <ul> <li><code>CIS_BENCH_VERIFY_SSL</code> - SSL verification (true/false, default: false)</li> </ul> <p>Display:</p> <ul> <li><code>CIS_BENCH_TABLE_TITLE_WIDTH</code> - Table title column width (default: 90)</li> <li><code>CIS_BENCH_SEARCH_LIMIT</code> - Default search limit (default: 1000)</li> </ul> <p>Environment:</p> <ul> <li><code>CIS_BENCH_ENV</code> - Environment (production|dev|test)</li> </ul> <p>SSL/TLS (automatically respected):</p> <ul> <li><code>REQUESTS_CA_BUNDLE</code> - Path to CA cert bundle</li> <li><code>SSL_CERT_FILE</code> - Path to SSL cert file</li> <li><code>CURL_CA_BUNDLE</code> - curl-compatible cert bundle</li> </ul>"},{"location":"user-guide/commands-reference/#common-workflows","title":"Common Workflows","text":""},{"location":"user-guide/commands-reference/#first-time-setup","title":"First Time Setup","text":"<pre><code># Install\npip install -e .\n\n# Login (one-time)\ncis-bench auth login --browser chrome\n\n# Build catalog (one-time, ~2 min)\ncis-bench catalog refresh\n</code></pre>"},{"location":"user-guide/commands-reference/#find-and-download","title":"Find and Download","text":"<pre><code># Search for benchmarks\ncis-bench search \"oracle cloud\"\n\n# Download by ID\ncis-bench download 23598\n\n# Export to XCCDF\ncis-bench export 23598 --format xccdf --style cis\n</code></pre>"},{"location":"user-guide/commands-reference/#unified-workflow-easiest","title":"Unified Workflow (Easiest)","text":"<pre><code># One command does everything\ncis-bench get \"ubuntu 22\" --format xccdf --style cis\n</code></pre>"},{"location":"user-guide/commands-reference/#scripting-and-automation","title":"Scripting and Automation","text":"<pre><code># Search and pipe\ncis-bench search --platform-type cloud --output-format json | jq\n\n# Batch download\ncis-bench search \"windows server\" --latest --output-format json | \\\njq -r '.[].benchmark_id' | \\\nxargs -I {} cis-bench download {}\n\n# Inventory\ncis-bench list --output-format csv &gt; inventory.csv\n</code></pre>"},{"location":"user-guide/commands-reference/#exit-codes","title":"Exit Codes","text":"<ul> <li><code>0</code> - Success</li> <li><code>1</code> - Error (authentication failed, file not found, etc.)</li> </ul>"},{"location":"user-guide/commands-reference/#data-storage","title":"Data Storage","text":"<p>Session:</p> <ul> <li><code>~/.cis-bench/session.cookies</code> - Saved authentication session</li> </ul> <p>Catalog Database:</p> <ul> <li><code>~/.cis-bench/catalog.db</code> - SQLite database with FTS5 search</li> </ul> <p>Downloaded Benchmarks:</p> <ul> <li>Stored in: <code>~/.cis-bench/catalog.db</code> (downloaded_benchmarks table)</li> <li>Also saved as: <code>./benchmarks/*.json</code> files</li> </ul> <p>Development/Test:</p> <ul> <li>Dev: <code>~/.cis-bench-dev/</code></li> <li>Test: <code>/tmp/cis-bench-test/</code></li> </ul>"},{"location":"user-guide/commands-reference/#see-also","title":"See Also","text":"<ul> <li>Getting Started - Installation and setup</li> <li>Catalog Guide - Catalog usage details</li> <li>XCCDF Guide - XCCDF export details</li> <li>Configuration - Environment configuration</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"user-guide/configuration/","title":"Configuration","text":"<p>Configuration options for CIS Benchmark CLI.</p> <p>Documentation Path</p> <p>You are here: User Guide &gt; Configuration</p> <ul> <li>For commands: See Commands Reference</li> <li>For troubleshooting: See Troubleshooting</li> </ul>"},{"location":"user-guide/configuration/#environment-variables","title":"Environment Variables","text":""},{"location":"user-guide/configuration/#cis_bench_env","title":"<code>CIS_BENCH_ENV</code>","text":"<p>Set the application environment.</p> <p>Values:</p> <ul> <li><code>production</code> (default) - Use <code>~/.cis-bench/</code></li> <li><code>dev</code> - Use <code>~/.cis-bench-dev/</code></li> <li><code>test</code> - Use temp directory (automatic in tests)</li> </ul> <p>Usage: <pre><code>export CIS_BENCH_ENV=dev\ncis-bench catalog refresh\n</code></pre></p> <p>Data Locations:</p> <ul> <li>Production: <code>~/.cis-bench/catalog.db</code></li> <li>Dev: <code>~/.cis-bench-dev/catalog.db</code></li> <li>Test: <code>/tmp/cis-bench-test/catalog.db</code></li> </ul>"},{"location":"user-guide/configuration/#env-file","title":".env File","text":"<p>Optional configuration file: <code>~/.cis-bench/.env</code></p> <p>Example: <pre><code># Set environment\nCIS_BENCH_ENV=dev\n\n# Disable SSL verification (if needed)\nCIS_BENCH_SSL_VERIFY=false\n</code></pre></p> <p>Loaded automatically via python-dotenv if file exists.</p>"},{"location":"user-guide/configuration/#directory-structure","title":"Directory Structure","text":"<pre><code>~/.cis-bench/ # Production (default)\n\u251c\u2500\u2500 catalog.db # Catalog database\n\u251c\u2500\u2500 benchmarks/ # Downloaded benchmarks (if using file storage)\n\u2514\u2500\u2500 .env # Optional config file\n\n~/.cis-bench-dev/ # Development (CIS_BENCH_ENV=dev)\n\u251c\u2500\u2500 catalog.db\n\u2514\u2500\u2500 benchmarks/\n\n/tmp/cis-bench-test/ # Test (automatic)\n\u2514\u2500\u2500 catalog.db\n</code></pre>"},{"location":"user-guide/configuration/#database-configuration","title":"Database Configuration","text":"<p>Catalog Database:</p> <ul> <li>Type: SQLite with FTS5</li> <li>Location: <code>{data_dir}/catalog.db</code></li> <li>Schema: 8 tables (3NF normalized)</li> </ul> <p>Downloaded Benchmarks:</p> <ul> <li>Storage: Inside catalog.db</li> <li>Format: JSON (in database)</li> <li>Hash: SHA256 for change detection</li> </ul> <p>Search Index:</p> <ul> <li>Type: FTS5 virtual table</li> <li>Tokenizer: porter + unicode61</li> <li>Fields: title, platform, community, description</li> </ul>"},{"location":"user-guide/configuration/#logging-configuration","title":"Logging Configuration","text":""},{"location":"user-guide/configuration/#log-levels","title":"Log Levels","text":"<p>Controlled via CLI flags:</p> <pre><code>cis-bench --verbose export ... # DEBUG level\ncis-bench export ... # INFO level (default)\ncis-bench --quiet export ... # WARNING level\n</code></pre> <p>Log Format:</p> <ul> <li>Normal: <code>LEVEL: module: message</code></li> <li>Verbose: <code>timestamp - LEVEL - module - function:line - message</code></li> </ul> <p>Log Output:</p> <ul> <li>stderr (logs)</li> <li>stdout (user output)</li> </ul>"},{"location":"user-guide/configuration/#catalog-configuration","title":"Catalog Configuration","text":""},{"location":"user-guide/configuration/#scraping","title":"Scraping","text":"<p>Rate Limiting:</p> <ul> <li>Default: 2 seconds between requests</li> <li>Configurable: <code>--rate-limit</code> option</li> <li>Respectful to CIS servers</li> </ul> <p>Pages:</p> <ul> <li>Default: All pages (~68)</li> <li>Limit: <code>--max-pages</code> option</li> <li>Update: Page 1 only</li> </ul> <p>Authentication:</p> <ul> <li>Browser cookies (chrome, firefox, edge, safari)</li> <li>Cookie file (Netscape format)</li> <li>Required for WorkBench access</li> </ul>"},{"location":"user-guide/configuration/#xccdf-export-configuration","title":"XCCDF Export Configuration","text":""},{"location":"user-guide/configuration/#styles","title":"Styles","text":"<p>Defined in: <code>src/cis_bench/exporters/configs/{style}_style.yaml</code></p> <p>Available:</p> <ul> <li><code>disa</code> - DISA/DoD STIG format</li> <li><code>cis</code> - CIS native format</li> </ul> <p>Adding new style: 1. Create <code>{name}_style.yaml</code> in configs/ 2. Use: <code>--format xccdf --style {name}</code></p> <p>See: How to Add XCCDF Style</p>"},{"location":"user-guide/configuration/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"user-guide/configuration/#custom-data-directory","title":"Custom Data Directory","text":"<p>Not currently configurable via .env, but can modify in code:</p> <pre><code>from cis_bench.config import Config\n\n# Override in your code\nConfig._custom_data_dir = Path(\"/custom/location\")\n</code></pre>"},{"location":"user-guide/configuration/#ssl-verification","title":"SSL Verification","text":"<p>Currently disabled by default for catalog scraper (CIS WorkBench cert issues).</p> <p>To enable (future): <pre><code># In .env\nCIS_BENCH_SSL_VERIFY=true\n</code></pre></p>"},{"location":"user-guide/configuration/#default-settings","title":"Default Settings","text":"<p>Paths:</p> <ul> <li>Data: <code>~/.cis-bench/</code></li> <li>Catalog: <code>~/.cis-bench/catalog.db</code></li> <li>Benchmarks: Stored in catalog DB</li> </ul> <p>Catalog:</p> <ul> <li>Rate limit: 2 seconds</li> <li>Max pages: All (68)</li> <li>Status filter: Published</li> <li>Latest only: False</li> </ul> <p>Export:</p> <ul> <li>Format: yaml</li> <li>XCCDF style: disa</li> <li>Output: Same name as input with new extension</li> </ul> <p>Logging:</p> <ul> <li>Level: INFO</li> <li>Format: Standard</li> <li>Output: stderr</li> </ul>"},{"location":"user-guide/configuration/#see-also","title":"See Also","text":"<ul> <li>Getting Started - Initial setup</li> <li>Commands Reference - All commands</li> <li>Troubleshooting - Common issues</li> </ul>"},{"location":"user-guide/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions.</p> <p>Documentation Path</p> <p>You are here: User Guide &gt; Troubleshooting</p> <ul> <li>For configuration: See Configuration</li> <li>For commands: See Commands Reference</li> <li>For workflows: See Workflows</li> </ul>"},{"location":"user-guide/troubleshooting/#installation-issues","title":"Installation Issues","text":""},{"location":"user-guide/troubleshooting/#command-not-found-cis-bench","title":"\"Command not found: cis-bench\"","text":"<p>Cause: Package not installed or virtual environment not activated.</p> <p>Solution: <pre><code># Activate venv\nsource venv/bin/activate\n\n# Install package\npip install -e .\n\n# Verify\ncis-bench --version\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#no-module-named-cis_bench","title":"\"No module named 'cis_bench'\"","text":"<p>Cause: Package not installed in editable mode.</p> <p>Solution: <pre><code>pip install -e .\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#authentication-issues","title":"Authentication Issues","text":""},{"location":"user-guide/troubleshooting/#not-authenticated-login-redirect","title":"\"Not authenticated\" / Login redirect","text":"<p>Cause: Not logged into CIS WorkBench in browser.</p> <p>Solution: 1. Open browser 2. Go to https://workbench.cisecurity.org 3. Log in 4. Try CLI command again</p>"},{"location":"user-guide/troubleshooting/#failed-to-extract-cookies","title":"\"Failed to extract cookies\"","text":"<p>Cause: Browser database locked or no cookies found.</p> <p>Solutions:</p> <ul> <li>Close all browser windows</li> <li>Try different browser: <code>--browser firefox</code></li> <li>Use cookie file instead: <code>--cookies cookies.txt</code></li> <li>Check you're logged into correct site</li> </ul>"},{"location":"user-guide/troubleshooting/#ssl-certificate-error","title":"SSL Certificate Error","text":"<p>Cause: CIS WorkBench certificate chain issues.</p> <p>Current: Verification disabled by default in catalog scraper.</p> <p>If you see SSL errors: <pre><code># Not yet configurable, report as issue\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#catalog-issues","title":"Catalog Issues","text":""},{"location":"user-guide/troubleshooting/#catalog-not-found","title":"\"Catalog not found\"","text":"<p>Cause: Catalog not initialized.</p> <p>Solution: <pre><code>cis-bench catalog refresh --browser chrome\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#no-benchmarks-found","title":"\"No benchmarks found\"","text":"<p>Causes:</p> <ul> <li>Search too specific</li> <li>Wrong status filter</li> <li>Catalog out of date</li> </ul> <p>Solutions: <pre><code># Broader search\ncis-bench catalog search \"linux\"\n\n# Try without filters\ncis-bench catalog list\n\n# Include archived\ncis-bench catalog search \"benchmark\" --status Archived\n\n# Refresh catalog\ncis-bench catalog update\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#slow-catalog-refresh","title":"Slow Catalog Refresh","text":"<p>Normal: Full refresh takes ~10 minutes (68 pages \u00d7 2 sec rate limit).</p> <p>Alternatives:</p> <ul> <li>Use <code>catalog update</code> for quick refresh (~30 sec)</li> <li>Test with <code>--max-pages 5</code> first</li> <li>Increase rate with <code>--rate-limit 1</code> (less polite to CIS)</li> </ul>"},{"location":"user-guide/troubleshooting/#export-issues","title":"Export Issues","text":""},{"location":"user-guide/troubleshooting/#unknown-transformation","title":"\"Unknown transformation\"","text":"<p>Cause: Transform function not registered.</p> <p>Check:</p> <ul> <li>Transform name in YAML config</li> <li>Function exists in code</li> <li>Registered with TransformRegistry</li> </ul>"},{"location":"user-guide/troubleshooting/#no-converter-registered-for-_element","title":"\"No converter registered for _Element\"","text":"<p>Cause: Trying to serialize lxml Elements directly.</p> <p>This is a bug - report with:</p> <ul> <li>Which style you're using</li> <li>Sample benchmark data</li> </ul>"},{"location":"user-guide/troubleshooting/#htmltexttype-is-not-derived-from-htmltextwithsubtype","title":"\"HtmlTextType is not derived from HtmlTextWithSubType\"","text":"<p>Cause: Wrong XCCDF type for element.</p> <p>Check:</p> <ul> <li><code>rule_elements</code> section in YAML</li> <li>Using correct type (HtmlTextType vs HtmlTextWithSubType)</li> <li>XCCDF version (1.1.4 vs 1.2)</li> </ul>"},{"location":"user-guide/troubleshooting/#download-issues","title":"Download Issues","text":""},{"location":"user-guide/troubleshooting/#benchmark-not-found","title":"\"Benchmark not found\"","text":"<p>Cause: Invalid ID or not in catalog.</p> <p>Solutions: <pre><code># Search first\ncis-bench catalog search \"name\"\n\n# Check ID\ncis-bench catalog info 23598\n\n# Refresh catalog\ncis-bench catalog update\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#already-up-to-date","title":"\"Already up-to-date\"","text":"<p>Not an error - Benchmark hasn't changed.</p> <p>Force re-download: <pre><code>cis-bench catalog download 23598 --force\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#database-issues","title":"Database Issues","text":""},{"location":"user-guide/troubleshooting/#catalog-database-locked","title":"Catalog Database Locked","text":"<p>Cause: Multiple processes accessing database.</p> <p>Solution:</p> <ul> <li>Close other cis-bench processes</li> <li>Wait a moment and retry</li> <li>Check for zombie processes: <code>ps aux | grep cis-bench</code></li> </ul>"},{"location":"user-guide/troubleshooting/#catalog-database-corrupted","title":"Catalog Database Corrupted","text":"<p>Symptoms:</p> <ul> <li>Random SQL errors</li> <li>Missing data</li> <li>Crashes</li> </ul> <p>Solution: <pre><code># Backup first\ncp ~/.cis-bench/catalog.db ~/.cis-bench/catalog.db.backup\n\n# Rebuild\nrm ~/.cis-bench/catalog.db\ncis-bench catalog refresh\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#test-issues","title":"Test Issues","text":""},{"location":"user-guide/troubleshooting/#tests-polluting-production-database","title":"Tests Polluting Production Database","text":"<p>Should not happen - tests use isolated database.</p> <p>Check: <pre><code># Verify test env is set\npython3 -c \"import os; print(os.getenv('CIS_BENCH_ENV'))\"\n# Should print: None (when not in tests)\n\n# In tests, should be: test\n</code></pre></p> <p>If tests use production DB:</p> <ul> <li>Check <code>tests/conftest.py</code> has <code>test_environment</code> fixture</li> <li>Verify <code>autouse=True</code> on fixture</li> </ul>"},{"location":"user-guide/troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"user-guide/troubleshooting/#slow-exports","title":"Slow Exports","text":"<p>Normal for large benchmarks:</p> <ul> <li>322 recs to XCCDF: ~5-10 seconds</li> <li>Includes metadata generation</li> <li>XML serialization</li> <li>Post-processing</li> </ul> <p>If extremely slow (&gt;30 sec):</p> <ul> <li>Check --verbose output</li> <li>May be issue with specific mapping</li> <li>Report with benchmark size</li> </ul>"},{"location":"user-guide/troubleshooting/#slow-search","title":"Slow Search","text":"<p>FTS5 should be &lt;1ms.</p> <p>If slow:</p> <ul> <li>Check database size</li> <li>Run <code>VACUUM</code> on SQLite</li> <li>Rebuild FTS5 index: <pre><code>sqlite3 ~/.cis-bench/catalog.db \"DELETE FROM benchmarks_fts\"\n# Then refresh catalog\n</code></pre></li> </ul>"},{"location":"user-guide/troubleshooting/#common-errors","title":"Common Errors","text":""},{"location":"user-guide/troubleshooting/#modulenotfounderror","title":"<code>ModuleNotFoundError</code>","text":"<p>Missing dependency.</p> <pre><code>pip install -e \".[dev]\"\n</code></pre>"},{"location":"user-guide/troubleshooting/#validationerror-from-pydantic","title":"<code>ValidationError</code> from Pydantic","text":"<p>Invalid data in benchmark.</p> <p>Check:</p> <ul> <li>Source benchmark JSON</li> <li>Required fields present</li> <li>Field types correct</li> </ul>"},{"location":"user-guide/troubleshooting/#clickabort","title":"<code>click.Abort</code>","text":"<p>User canceled or error in CLI command.</p> <p>Check preceding error message for details.</p>"},{"location":"user-guide/troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"user-guide/troubleshooting/#enable-verbose-logging","title":"Enable Verbose Logging","text":"<pre><code>cis-bench --verbose catalog refresh\n</code></pre> <p>Shows detailed debug information.</p>"},{"location":"user-guide/troubleshooting/#check-logs","title":"Check Logs","text":"<p>Logs go to stderr. Redirect to file: <pre><code>cis-bench catalog refresh 2&gt; debug.log\n</code></pre></p>"},{"location":"user-guide/troubleshooting/#report-issues","title":"Report Issues","text":"<p>https://github.com/aaronlippold/cis-benchmark-cli/issues</p> <p>Include:</p> <ul> <li>Command you ran</li> <li>Error message</li> <li><code>--verbose</code> output</li> <li>Platform (OS, Python version)</li> </ul>"},{"location":"user-guide/troubleshooting/#see-also","title":"See Also","text":"<ul> <li>Configuration - Environment settings</li> <li>Commands Reference - All commands</li> <li>Testing Guide - Testing setup</li> </ul>"},{"location":"user-guide/workflows/","title":"End-to-End Workflows","text":"<p>Real-world scenarios with complete commands and expected outcomes</p> <p>Documentation Path</p> <p>You are here: User Guide &gt; End-to-End Workflows</p> <ul> <li>For command syntax: See Commands Reference</li> <li>For term definitions: See Glossary</li> </ul>"},{"location":"user-guide/workflows/#overview","title":"Overview","text":"<p>This guide shows complete workflows for common use cases. Each scenario includes:</p> <ul> <li>Context - Who you are and what you need</li> <li>Prerequisites - What you need before starting</li> <li>Commands - Complete CLI commands (copy-paste ready)</li> <li>Expected Output - What success looks like</li> <li>Validation - How to verify it worked</li> <li>Troubleshooting - Common issues</li> </ul> <p>All examples use real benchmark IDs from CIS WorkBench.</p>"},{"location":"user-guide/workflows/#scenario-1-export-almalinux-10-for-openscap-scanning","title":"Scenario 1: Export AlmaLinux 10 for OpenSCAP Scanning","text":"<p>Context: You're a security engineer setting up OpenSCAP compliance scanning for AlmaLinux 10 servers. You need the CIS Benchmark in XCCDF format.</p> <p>Prerequisites:</p> <ul> <li>AlmaLinux 10 servers to scan</li> <li>OpenSCAP installed (<code>yum install openscap-scanner</code>)</li> <li>CIS WorkBench account</li> </ul>"},{"location":"user-guide/workflows/#step-1-setup-one-time","title":"Step 1: Setup (One-Time)","text":"<pre><code># Install cis-bench\npip install -e .\n\n# Login to CIS WorkBench\ncis-bench auth login --browser chrome\n\n# Build catalog\ncis-bench catalog refresh\n</code></pre> <p>Expected: <pre><code>Logged in\nSession saved to ~/.cis-bench/session.cookies\n\nCatalog refresh complete!\nBenchmarks: 1,343\nPages: 67\n</code></pre></p>"},{"location":"user-guide/workflows/#step-2-find-almalinux-10-benchmark","title":"Step 2: Find AlmaLinux 10 Benchmark","text":"<pre><code>cis-bench search \"almalinux 10\" --latest\n</code></pre> <p>Expected Output: <pre><code>\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Benchmark \u2502 Title \u2502 Version \u2502 Status \u2502\n\u2502 ID \u2502 \u2502 \u2502 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 23598 \u2502 CIS AlmaLinux OS 10 Benchmark \u2502 v1.0.0 \u2502 Published \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre></p> <p>Note: Benchmark ID is 23598</p>"},{"location":"user-guide/workflows/#step-3-download-and-export-to-xccdf","title":"Step 3: Download and Export to XCCDF","text":"<pre><code># Download benchmark\ncis-bench download 23598\n\n# Export to CIS-style XCCDF\ncis-bench export 23598 --format xccdf --style cis -o almalinux10-cis.xml\n</code></pre> <p>Expected: <pre><code>Downloading benchmark 23598...\nAlmaLinux OS 10 Benchmark v1.0.0\nDownloading 322 recommendations \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100%\nDownloaded: almalinux10.json\n\nExporting to XCCDF (CIS style)...\nExported: almalinux10-cis.xml (1.8 MB, 322 rules)\n</code></pre></p>"},{"location":"user-guide/workflows/#step-4-validate-xccdf","title":"Step 4: Validate XCCDF","text":"<pre><code># Check file exists\nls -lh almalinux10-cis.xml\n\n# Validate XML structure\nxmllint --noout almalinux10-cis.xml &amp;&amp; echo \"Valid XML\"\n\n# Check rule count\nxmllint --xpath \"count(//Rule)\" almalinux10-cis.xml\n# Expected: 322\n</code></pre>"},{"location":"user-guide/workflows/#step-5-run-openscap-scan","title":"Step 5: Run OpenSCAP Scan","text":"<pre><code># Run compliance scan\nsudo oscap xccdf eval \\\n--profile \"Level 1 - Server\" \\\n--results scan-results.xml \\\n--report scan-report.html \\\nalmalinux10-cis.xml\n\n# View results\nopen scan-report.html\n</code></pre> <p>Expected:</p> <ul> <li>HTML report showing pass/fail for each rule</li> <li>XML results file for remediation tracking</li> </ul>"},{"location":"user-guide/workflows/#troubleshooting","title":"Troubleshooting","text":"<p>Issue: \"Download failed - authentication required\" <pre><code># Check auth status\ncis-bench auth status\n\n# Re-login if needed\ncis-bench auth login --browser chrome\n</code></pre></p> <p>Issue: \"OpenSCAP can't parse XCCDF\" <pre><code># Verify XCCDF structure\nxmllint --schema schemas/xccdf-1.2.xsd almalinux10-cis.xml\n\n# Try DISA style instead (XCCDF 1.1.4, more compatible)\ncis-bench export 23598 --format xccdf --style disa -o almalinux10-disa.xml\n</code></pre></p>"},{"location":"user-guide/workflows/#scenario-2-create-compliance-tracking-spreadsheet","title":"Scenario 2: Create Compliance Tracking Spreadsheet","text":"<p>Context: You're a compliance officer tracking Oracle Cloud Infrastructure security controls. You need a CSV spreadsheet for status tracking.</p> <p>Benchmark: Oracle Cloud Infrastructure Foundations (ID: 24008)</p>"},{"location":"user-guide/workflows/#complete-workflow","title":"Complete Workflow","text":"<pre><code># 1. Setup (if not done)\ncis-bench auth login --browser chrome\ncis-bench catalog refresh\n\n# 2. Search and download\ncis-bench search \"oracle cloud foundations\"\n# Shows: Benchmark ID 24008\n\ncis-bench download 24008\n\n# 3. Export to CSV\ncis-bench export 24008 --format csv -o oci-compliance.csv\n\n# 4. Open in spreadsheet\nopen oci-compliance.csv # macOS\n# Or: libreoffice oci-compliance.csv # Linux\n</code></pre> <p>CSV Output Includes: <pre><code>ref,title,assessment_status,profiles,audit,remediation,cis_controls,nist_controls\n1.1,Ensure service admin is set,Automated,\"Level 1\",Check IAM policy...,Set IAM policy...,\"[4.1, 5.4]\",\"[AC-2, AC-3]\"\n1.2,Ensure password policy requires...,Automated,\"Level 1\",Check password settings...,Configure password...,\"[5.2]\",\"[IA-5]\"\n</code></pre></p>"},{"location":"user-guide/workflows/#add-status-tracking-column","title":"Add Status Tracking Column","text":"<p>Edit CSV to add tracking:</p> <ol> <li>Open in Excel/Numbers/Google Sheets</li> <li>Add column: \"Implementation Status\"</li> <li>Add column: \"Assigned To\"</li> <li>Add column: \"Target Date\"</li> <li>Add column: \"Notes\"</li> </ol> <p>Use for:</p> <ul> <li>Track implementation progress</li> <li>Assign controls to team members</li> <li>Report to management</li> <li>Audit evidence</li> </ul>"},{"location":"user-guide/workflows/#scenario-3-batch-export-all-cloud-benchmarks","title":"Scenario 3: Batch Export All Cloud Benchmarks","text":"<p>Context: You manage cloud security across AWS, Azure, GCP, and Oracle Cloud. You need XCCDF files for all cloud platforms.</p>"},{"location":"user-guide/workflows/#complete-workflow_1","title":"Complete Workflow","text":"<pre><code># 1. Find all cloud benchmarks\ncis-bench search --platform-type cloud --latest --output-format json &gt; cloud-benchmarks.json\n\n# View what we found\njq -r '.[] | \"\\(.benchmark_id): \\(.title)\"' cloud-benchmarks.json\n\n# 2. Download all cloud benchmarks\njq -r '.[].benchmark_id' cloud-benchmarks.json | \\\nhead -10 | \\\nxargs -I {} cis-bench download {}\n\n# 3. Create output directory\nmkdir -p xccdf-cloud-benchmarks\n\n# 4. Export all to XCCDF (DISA format for SCC)\ncis-bench list --output-format json | \\\njq -r 'select(.benchmark_id) | .benchmark_id' | \\\nwhile read id; do\ncis-bench export \"$id\" \\\n--format xccdf \\\n--style disa \\\n-o \"xccdf-cloud-benchmarks/benchmark-${id}-disa.xml\"\necho \"Exported: $id\"\ndone\n\n# 5. Verify\nls -lh xccdf-cloud-benchmarks/\n</code></pre> <p>Expected Output: <pre><code>xccdf-cloud-benchmarks/\n\u251c\u2500\u2500 benchmark-12345-disa.xml (AWS Foundations)\n\u251c\u2500\u2500 benchmark-12346-disa.xml (Azure Foundations)\n\u251c\u2500\u2500 benchmark-12347-disa.xml (Google Cloud)\n\u251c\u2500\u2500 benchmark-24008-disa.xml (Oracle Cloud)\n\u2514\u2500\u2500 ...\n</code></pre></p>"},{"location":"user-guide/workflows/#use-with-scap-compliance-checker-scc","title":"Use with SCAP Compliance Checker (SCC)","text":"<pre><code># Import all XCCDFs into SCC\nfor xccdf in xccdf-cloud-benchmarks/*.xml; do\necho \"Importing: $xccdf\"\n# SCC import process (tool-specific)\ndone\n</code></pre>"},{"location":"user-guide/workflows/#scenario-4-generate-inspec-profile-from-cis-benchmark","title":"Scenario 4: Generate InSpec Profile from CIS Benchmark","text":"<p>Context: You need to create an InSpec compliance profile from a CIS Benchmark for automated testing.</p> <p>Benchmark: Ubuntu 22.04 LTS (ID: 22162)</p>"},{"location":"user-guide/workflows/#complete-workflow_2","title":"Complete Workflow","text":"<pre><code># 1. Download and export to XCCDF\ncis-bench auth login --browser chrome\ncis-bench download 22162\ncis-bench export 22162 --format xccdf --style cis -o ubuntu2204-cis.xml\n\n# 2. Use SAF CLI to convert XCCDF InSpec\nnpm install -g @mitre/saf\n\nsaf generate xccdf_benchmark2inspec_stub \\\n-X ubuntu2204-cis.xml \\\n-o ubuntu2204-inspec \\\n--idType cis\n\n# 3. Verify InSpec profile\ncd ubuntu2204-inspec\ninspec check .\n\n# 4. Run compliance scan\ninspec exec . -t ssh://user@server --reporter cli json:results.json\n\n# 5. View results\ninspec_tools summary -j results.json\n</code></pre> <p>Expected InSpec Profile: <pre><code>ubuntu2204-inspec/\n\u251c\u2500\u2500 inspec.yml # Profile metadata\n\u251c\u2500\u2500 controls/\n\u2502 \u251c\u2500\u2500 1_1_1.rb # Recommendation 1.1.1\n\u2502 \u251c\u2500\u2500 1_1_2.rb # Recommendation 1.1.2\n\u2502 \u2514\u2500\u2500 ... # 200+ control files\n\u2514\u2500\u2500 libraries/\n\u2514\u2500\u2500 helper.rb # Shared code\n</code></pre></p> <p>Each control file contains: <pre><code>control '1_1_1' do\ntitle 'Ensure mounting of cramfs filesystems is disabled'\ndesc 'The cramfs filesystem type is a compressed...'\n\nimpact 0.7 # From XCCDF severity\n\ntag cis_controls: ['4.8']\ntag nist: ['CM-7', 'CM-7(1)']\n\ndescribe command('modprobe -n -v cramfs') do\nits('stdout') { should match /install \\/bin\\/true/ }\nend\nend\n</code></pre></p>"},{"location":"user-guide/workflows/#scenario-5-compare-benchmark-versions","title":"Scenario 5: Compare Benchmark Versions","text":"<p>Context: CIS updated the AlmaLinux 8 benchmark from v3.0.0 to v4.0.0. You need to see what changed.</p> <p>Benchmarks:</p> <ul> <li>AlmaLinux 8 v3.0.0 (ID: 15287)</li> <li>AlmaLinux 8 v4.0.0 (ID: 23598)</li> </ul>"},{"location":"user-guide/workflows/#complete-workflow_3","title":"Complete Workflow","text":"<pre><code># 1. Download both versions\ncis-bench download 15287 23598\n\n# 2. Export both to JSON (full data)\ncis-bench export 15287 --format json -o alma8-v3.json\ncis-bench export 23598 --format json -o alma8-v4.json\n\n# 3. Compare recommendation counts\njq '.total_recommendations' alma8-v3.json\njq '.total_recommendations' alma8-v4.json\n\n# 4. Extract recommendation refs\njq -r '.recommendations[].ref' alma8-v3.json | sort &gt; v3-refs.txt\njq -r '.recommendations[].ref' alma8-v4.json | sort &gt; v4-refs.txt\n\n# 5. Find differences\ncomm -23 v3-refs.txt v4-refs.txt &gt; removed.txt # In v3, not in v4\ncomm -13 v3-refs.txt v4-refs.txt &gt; added.txt # In v4, not in v3\ncomm -12 v3-refs.txt v4-refs.txt &gt; common.txt # In both\n\n# 6. Summary\necho \"Removed: $(wc -l &lt; removed.txt) recommendations\"\necho \"Added: $(wc -l &lt; added.txt) recommendations\"\necho \"Common: $(wc -l &lt; common.txt) recommendations\"\n\n# 7. Detail on new recommendations\necho \"New recommendations in v4.0.0:\"\ncat added.txt | while read ref; do\njq -r \".recommendations[] | select(.ref==\\\"$ref\\\") | .title\" alma8-v4.json\ndone\n</code></pre> <p>Expected Output: <pre><code>Removed: 5 recommendations\nAdded: 12 recommendations\nCommon: 310 recommendations\n\nNew recommendations in v4.0.0:\n1.1.28 Ensure bootloader password is set\n1.2.15 Ensure system-wide crypto policy is configured\n...\n</code></pre></p>"},{"location":"user-guide/workflows/#scenario-6-automated-cicd-integration","title":"Scenario 6: Automated CI/CD Integration","text":"<p>Context: You want to automatically download and export benchmarks in your CI/CD pipeline to keep compliance docs up-to-date.</p>"},{"location":"user-guide/workflows/#github-actions-workflow","title":"GitHub Actions Workflow","text":"<pre><code># .github/workflows/update-compliance-docs.yml\n\nname: Update Compliance Documentation\n\non:\nschedule:\n\n- cron: '0 0 * * 1' # Weekly on Monday\nworkflow_dispatch:\n\njobs:\nupdate-benchmarks:\nruns-on: ubuntu-latest\n\nsteps:\n\n- uses: actions/checkout@v3\n\n- name: Setup Python\nuses: actions/setup-python@v4\nwith:\npython-version: '3.11'\n\n- name: Install cis-bench\nrun: |\npip install -e .\n\n- name: Setup cookies\nrun: |\necho \"${{ secrets.CIS_COOKIES }}\" &gt; cookies.txt\n\n- name: Download benchmarks\nrun: |\ncis-bench download 23598 --cookies cookies.txt # AlmaLinux 10\ncis-bench download 22162 --cookies cookies.txt # Ubuntu 22.04\ncis-bench download 24008 --cookies cookies.txt # Oracle Cloud\n\n- name: Export to Markdown\nrun: |\nmkdir -p docs/compliance\ncis-bench export 23598 --format markdown -o docs/compliance/almalinux10.md\ncis-bench export 22162 --format markdown -o docs/compliance/ubuntu2204.md\ncis-bench export 24008 --format markdown -o docs/compliance/oracle-cloud.md\n\n- name: Commit updates\nrun: |\ngit config user.name \"GitHub Actions\"\ngit config user.email \"actions@github.com\"\ngit add docs/compliance/\ngit commit -m \"docs: update CIS benchmarks [skip ci]\" || true\ngit push\n</code></pre> <p>Result: Compliance documentation automatically updated weekly.</p>"},{"location":"user-guide/workflows/#scenario-7-multi-format-export-for-different-stakeholders","title":"Scenario 7: Multi-Format Export for Different Stakeholders","text":"<p>Context: You need to share Ubuntu 22.04 benchmark with different teams:</p> <ul> <li>Security team - Needs XCCDF for scanning</li> <li>Management - Needs CSV for tracking</li> <li>Documentation team - Needs Markdown for wiki</li> </ul> <p>Benchmark: Ubuntu 22.04 LTS Server (ID: 22162)</p>"},{"location":"user-guide/workflows/#complete-workflow_4","title":"Complete Workflow","text":"<pre><code># 1. Download once\ncis-bench download 22162\n\n# 2. Export to all formats\nmkdir -p exports/ubuntu2204\n\n# XCCDF for OpenSCAP/SCC\ncis-bench export 22162 --format xccdf --style disa \\\n-o exports/ubuntu2204/ubuntu-2204-disa.xml\n\n# CSV for tracking\ncis-bench export 22162 --format csv \\\n-o exports/ubuntu2204/ubuntu-2204-controls.csv\n\n# Markdown for wiki\ncis-bench export 22162 --format markdown \\\n-o exports/ubuntu2204/ubuntu-2204-guide.md\n\n# YAML for automation (Ansible/Chef)\ncis-bench export 22162 --format yaml \\\n-o exports/ubuntu2204/ubuntu-2204-data.yaml\n\n# JSON for scripting\ncis-bench export 22162 --format json \\\n-o exports/ubuntu2204/ubuntu-2204-structured.json\n\n# 3. Verify all exports\nls -lh exports/ubuntu2204/\n</code></pre> <p>Expected: <pre><code>total 12M\n-rw-r--r-- 1 user group 1.8M ubuntu-2204-disa.xml (SCAP scanning)\n-rw-r--r-- 1 user group 450K ubuntu-2204-controls.csv (Excel tracking)\n-rw-r--r-- 1 user group 2.1M ubuntu-2204-guide.md (Documentation)\n-rw-r--r-- 1 user group 1.2M ubuntu-2204-data.yaml (Automation)\n-rw-r--r-- 1 user group 980K ubuntu-2204-structured.json (APIs/Scripts)\n</code></pre></p>"},{"location":"user-guide/workflows/#distribution","title":"Distribution","text":"<pre><code># Share with teams\ncp exports/ubuntu2204/ubuntu-2204-disa.xml /shared/security/\ncp exports/ubuntu2204/ubuntu-2204-controls.csv /shared/management/\ncp exports/ubuntu2204/ubuntu-2204-guide.md /shared/wiki/\n</code></pre>"},{"location":"user-guide/workflows/#scenario-8-validate-xccdf-before-importing-to-scc","title":"Scenario 8: Validate XCCDF Before Importing to SCC","text":"<p>Context: You're importing CIS benchmarks into DISA SCC (SCAP Compliance Checker). SCC is picky about XCCDF format and will reject invalid files.</p> <p>Benchmark: RHEL 9 (ID: 18208)</p>"},{"location":"user-guide/workflows/#complete-workflow-with-validation","title":"Complete Workflow with Validation","text":"<pre><code># 1. Download and export\ncis-bench download 18208\ncis-bench export 18208 --format xccdf --style disa -o rhel9-disa.xml\n\n# 2. Validate XML syntax\nxmllint --noout rhel9-disa.xml\nif [ $? -eq 0 ]; then\necho \" Valid XML syntax\"\nelse\necho \" XML syntax error\"\nexit 1\nfi\n\n# 3. Validate against XCCDF schema\nxmllint --schema schemas/xccdf-1.1.4.xsd --noout rhel9-disa.xml\nif [ $? -eq 0 ]; then\necho \" Valid XCCDF 1.1.4 structure\"\nelse\necho \" XCCDF schema validation failed\"\nexit 1\nfi\n\n# 4. Check DISA conventions\npython3 &lt;&lt; EOF\nfrom cis_bench.validators.disa_conventions import validate_disa_conventions\nissues = validate_disa_conventions('rhel9-disa.xml')\nif not issues:\nprint(\" DISA conventions validated\")\nelse:\nprint(f\"WARNING: {len(issues)} convention issues found:\")\nfor issue in issues:\nprint(f\" - {issue}\")\nEOF\n\n# 5. Verify CCI count (should be reasonable)\ncci_count=$(xmllint --xpath \"count(//ident)\" rhel9-disa.xml)\necho \"Total CCIs: $cci_count\"\n\n# Sanity check (should be ~500-1500 for typical benchmark)\nif [ \"$cci_count\" -gt 100 ] &amp;&amp; [ \"$cci_count\" -lt 5000 ]; then\necho \" CCI count reasonable\"\nelse\necho \"WARNING: Unusual CCI count (expected 500-1500)\"\nfi\n\n# 6. Check for required STIG elements\nrequired_elements=\"VulnDiscussion FalsePositives\"\nfor elem in $required_elements; do\ncount=$(xmllint --xpath \"count(//*[local-name()='$elem'])\" rhel9-disa.xml)\necho \"$elem elements: $count\"\ndone\n\n# 7. If all validations pass, import to SCC\necho \" All validations passed - ready for SCC import\"\n# Import to SCC (tool-specific steps)\n</code></pre>"},{"location":"user-guide/workflows/#scenario-9-search-and-filter-for-specific-platforms","title":"Scenario 9: Search and Filter for Specific Platforms","text":"<p>Context: You support multiple platforms and need to find all relevant CIS benchmarks.</p>"},{"location":"user-guide/workflows/#find-all-database-benchmarks","title":"Find All Database Benchmarks","text":"<pre><code># Search by category\ncis-bench search --platform-type database --output-format table\n\n# Export to JSON for processing\ncis-bench search --platform-type database --output-format json &gt; databases.json\n\n# Extract specific platforms\njq -r '.[] | select(.platform == \"oracle-database\") | \"\\(.benchmark_id): \\(.title) \\(.version)\"' databases.json\njq -r '.[] | select(.platform == \"mysql\") | \"\\(.benchmark_id): \\(.title) \\(.version)\"' databases.json\njq -r '.[] | select(.platform == \"postgresql\") | \"\\(.benchmark_id): \\(.title) \\(.version)\"' databases.json\n</code></pre>"},{"location":"user-guide/workflows/#find-all-containerkubernetes-benchmarks","title":"Find All Container/Kubernetes Benchmarks","text":"<pre><code>cis-bench search --platform-type container\n</code></pre> <p>Shows: <pre><code>\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 Benchmark \u2502 Title \u2502 Version \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 6467 \u2502 CIS Kubernetes Benchmark \u2502 v1.9.0 \u2502\n\u2502 7533 \u2502 CIS Docker Benchmark \u2502 v1.7.0 \u2502\n\u2502 8034 \u2502 CIS Amazon EKS Benchmark \u2502 v1.5.0 \u2502\n\u2502 12696 \u2502 CIS Azure AKS Benchmark \u2502 v1.6.0 \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre></p>"},{"location":"user-guide/workflows/#download-specific-platform","title":"Download Specific Platform","text":"<pre><code># Download all Kubernetes-related\ncis-bench search \"kubernetes\" --output-format json | \\\njq -r '.[].benchmark_id' | \\\nxargs -I {} cis-bench download {}\n</code></pre>"},{"location":"user-guide/workflows/#scenario-10-quick-lookup-and-get","title":"Scenario 10: Quick Lookup and Get","text":"<p>Context: You need a specific benchmark fast and don't remember the ID.</p>"},{"location":"user-guide/workflows/#using-the-unified-get-command","title":"Using the Unified <code>get</code> Command","text":"<pre><code># Search and export in one command\ncis-bench get \"ubuntu 22\" --format xccdf --style cis\n\n# What happens:\n# 1. Searches catalog for \"ubuntu 22\"\n# 2. If multiple matches, shows interactive selection\n# 3. Downloads benchmark (or uses cache)\n# 4. Exports to XCCDF CIS style\n# 5. Outputs file path\n</code></pre> <p>Interactive Selection: <pre><code>Found 3 matching benchmarks:\n? Select benchmark:\n\u276f CIS Ubuntu Linux 22.04 LTS Benchmark v2.0.0 (22162)\nCIS Ubuntu Linux 22.04 LTS Server Benchmark v1.0.0 (18208)\nCIS Ubuntu Linux 20.04 LTS Benchmark v2.0.1 (23595)\n\nDownloading: 22162\nDownloaded (from cache)\n\nExporting to XCCDF (CIS style)...\nExported: ubuntu-22-04-cis.xml\n</code></pre></p> <p>Non-Interactive Mode: <pre><code># Skip interactive selection, show table instead\ncis-bench get \"ubuntu 22\" --format xccdf --style cis --non-interactive\n</code></pre></p>"},{"location":"user-guide/workflows/#scenario-11-scripting-with-json-output","title":"Scenario 11: Scripting with JSON Output","text":"<p>Context: You're building automation and need machine-readable output.</p>"},{"location":"user-guide/workflows/#search-to-json-pipeline","title":"Search to JSON Pipeline","text":"<pre><code># Find all latest OS benchmarks\ncis-bench search --platform-type os --latest --output-format json | \\\njq -r '.[] | {\nid: .benchmark_id,\ntitle: .title,\nversion: .version,\nplatform: .platform\n}'\n\n# Download IDs from JSON\ncis-bench search --platform-type os --latest --output-format json | \\\njq -r '.[].benchmark_id' | \\\nxargs -I {} cis-bench download {}\n</code></pre>"},{"location":"user-guide/workflows/#check-auth-status-programmatically","title":"Check Auth Status Programmatically","text":"<pre><code># Get auth status as JSON\nauth_status=$(cis-bench auth status --output-format json)\n\n# Parse with jq\nis_logged_in=$(echo \"$auth_status\" | jq -r '.logged_in')\n\nif [ \"$is_logged_in\" = \"true\" ]; then\necho \"Already logged in\"\nelse\necho \"Need to login\"\ncis-bench auth login --browser chrome\nfi\n</code></pre>"},{"location":"user-guide/workflows/#list-downloaded-benchmarks-as-json","title":"List Downloaded Benchmarks as JSON","text":"<pre><code># Get all downloaded benchmarks\ncis-bench list --output-format json &gt; inventory.json\n\n# Extract specific fields\njq -r '.[] | \"\\(.benchmark_id),\\(.title),\\(.version)\"' inventory.json &gt; inventory.csv\n\n# Count by platform\njq -r '.[] | .title' inventory.json | \\\ngrep -o \"AlmaLinux\\|Ubuntu\\|RHEL\" | \\\nsort | uniq -c\n</code></pre>"},{"location":"user-guide/workflows/#scenario-12-update-catalog-and-re-export","title":"Scenario 12: Update Catalog and Re-Export","text":"<p>Context: You downloaded benchmarks 6 months ago. CIS has released updates. You need to check for and download new versions.</p>"},{"location":"user-guide/workflows/#complete-workflow_5","title":"Complete Workflow","text":"<pre><code># 1. Check what you have\ncis-bench list --output-format table\n\n# 2. Update catalog (quick - page 1 only)\ncis-bench catalog update\n\n# 3. Check for updates to your downloaded benchmarks\ncis-bench catalog check-updates\n\n# Expected output:\n# Checking 12 downloaded benchmarks...\n# Updates available:\n# 23598: AlmaLinux 10 v1.0.0 v1.1.0\n# 22162: Ubuntu 22.04 v2.0.0 v2.0.1\n# No updates: 10 benchmarks\n\n# 4. Download updates\ncis-bench download 23598 --force # Force re-download\ncis-bench download 22162 --force\n\n# 5. Re-export to XCCDF\ncis-bench export 23598 --format xccdf --style disa -o almalinux10-v1.1.xml\ncis-bench export 22162 --format xccdf --style disa -o ubuntu2204-v2.0.1.xml\n\n# 6. Update your OpenSCAP/SCC configuration with new files\n</code></pre>"},{"location":"user-guide/workflows/#scenario-13-corporate-environment-with-ssl-issues","title":"Scenario 13: Corporate Environment with SSL Issues","text":"<p>Context: You're behind a corporate proxy with custom SSL certificates. Standard commands fail with SSL errors.</p>"},{"location":"user-guide/workflows/#setup-for-corporate-environment","title":"Setup for Corporate Environment","text":"<pre><code># Option 1: Disable SSL verification (not recommended for production)\nexport CIS_BENCH_VERIFY_SSL=false\ncis-bench auth login --browser chrome\ncis-bench catalog refresh\n\n# Option 2: Use corporate certificate bundle\nexport REQUESTS_CA_BUNDLE=/etc/ssl/corporate-ca-bundle.crt\ncis-bench auth login --browser chrome\ncis-bench catalog refresh\n\n# Option 3: Per-command flag\ncis-bench auth login --browser chrome --no-verify-ssl\ncis-bench download 23598 # Uses saved session settings\n</code></pre> <p>Verify SSL Settings: <pre><code>cis-bench auth status --output-format json | jq '.ssl_verify'\n# false (if disabled)\n</code></pre></p>"},{"location":"user-guide/workflows/#scenario-14-offline-mode-work-from-cache","title":"Scenario 14: Offline Mode (Work from Cache)","text":"<p>Context: You're on a plane without internet. You need to work with benchmarks you've already downloaded.</p>"},{"location":"user-guide/workflows/#prepare-before-going-offline","title":"Prepare Before Going Offline","text":"<pre><code># 1. Download everything you'll need\ncis-bench download 23598 22162 24008 18208\n\n# 2. Verify cache\ncis-bench list\n</code></pre>"},{"location":"user-guide/workflows/#work-offline","title":"Work Offline","text":"<pre><code># All these work offline (use cache):\ncis-bench list\ncis-bench info 23598\ncis-bench export 23598 --format xccdf --style cis\ncis-bench export 22162 --format csv\ncis-bench search \"ubuntu\" # Works if catalog cached\n\n# These REQUIRE internet (will fail offline):\ncis-bench download 12345 # New download\ncis-bench catalog refresh # Network required\n</code></pre>"},{"location":"user-guide/workflows/#common-command-combinations","title":"Common Command Combinations","text":""},{"location":"user-guide/workflows/#quick-reference-table","title":"Quick Reference Table","text":"Task Command Setup <code>cis-bench auth login --browser chrome &amp;&amp; cis-bench catalog refresh</code> Search <code>cis-bench search \"platform name\"</code> Get XCCDF <code>cis-bench get \"query\" --format xccdf --style cis</code> Download by ID <code>cis-bench download XXXXX</code> Export cached <code>cis-bench export XXXXX --format xccdf --style disa</code> List downloaded <code>cis-bench list</code> Check updates <code>cis-bench catalog check-updates</code> Batch export <code>cis-bench list --output-format json \\| jq -r '.[].benchmark_id' \\| xargs -I {} cis-bench export {} --format xccdf</code>"},{"location":"user-guide/workflows/#benchmark-id-reference","title":"Benchmark ID Reference","text":"<p>Common Benchmarks (as of Dec 2025):</p> ID Platform Version 23598 AlmaLinux 10 v1.0.0 15287 AlmaLinux 8 v3.0.0 22162 Ubuntu 22.04 LTS Server v2.0.0 23595 Ubuntu 20.04 LTS v2.0.1 18208 RHEL 9 v2.0.0 24008 Oracle Cloud Infrastructure v3.0.0 6467 Kubernetes v1.9.0 7533 Docker v1.7.0 <p>Find more: <pre><code>cis-bench search --platform-type &lt;category&gt;\ncis-bench catalog platforms\n</code></pre></p>"},{"location":"user-guide/xccdf-guide/","title":"XCCDF Export Guide","text":"<p>Complete guide to exporting CIS benchmarks to NIST XCCDF format with two style options: DISA STIG and CIS native.</p> <p>Documentation Path</p> <p>You are here: User Guide &gt; XCCDF Export</p> <ul> <li>For technical details: See XCCDF Styles Comparison</li> <li>For examples: See Workflows</li> <li>For commands: See Commands Reference</li> </ul>"},{"location":"user-guide/xccdf-guide/#overview","title":"Overview","text":"<p>XCCDF (Extensible Configuration Checklist Description Format) is the standard format for security configuration checklists.</p> <p>Two Export Styles:</p> <ol> <li>DISA - DISA/DoD STIG-compatible (XCCDF 1.1.4)</li> <li>CIS - CIS native format (XCCDF 1.2)</li> </ol> <p>Both styles are fully validated and production-ready.</p>"},{"location":"user-guide/xccdf-guide/#quick-start","title":"Quick Start","text":"<pre><code># Export to CIS format (default recommended)\ncis-bench export benchmark.json --format xccdf --style cis\n\n# Export to DISA format\ncis-bench export benchmark.json --format xccdf --style disa\n\n# Specify output file\ncis-bench export benchmark.json --format xccdf --style cis -o output.xml\n</code></pre>"},{"location":"user-guide/xccdf-guide/#disa-style","title":"DISA Style","text":"<p>XCCDF 1.1.4 - DISA STIG Compatible</p>"},{"location":"user-guide/xccdf-guide/#features","title":"Features","text":"<ul> <li>VulnDiscussion structure (combines description + rationale)</li> <li>CCI mappings (Control Correlation Identifiers)</li> <li>NIST 800-53 controls via CCIs</li> <li>Legacy VMS tags (FalsePositives, etc.)</li> <li>Compatible with:</li> <li>DISA SCAP Compliance Checker (SCC)</li> <li>DISA STIG Viewer</li> <li>OpenSCAP (DoD configurations)</li> </ul>"},{"location":"user-guide/xccdf-guide/#output-example","title":"Output Example","text":"<pre><code>&lt;Rule id=\"xccdf_cis_rule_6_1_1\"&gt;\n&lt;title&gt;Ensure AIDE is installed&lt;/title&gt;\n&lt;description&gt;\n&lt;VulnDiscussion&gt;\nAIDE is an intrusion detection tool...\n\nRationale: By monitoring filesystem state...\n&lt;/VulnDiscussion&gt;\n&lt;FalsePositives&gt;&lt;/FalsePositives&gt;\n...\n&lt;/description&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000123&lt;/ident&gt;\n&lt;ident system=\"http://cyber.mil/cci\"&gt;CCI-000126&lt;/ident&gt;\n&lt;fixtext&gt;Run the following command...&lt;/fixtext&gt;\n&lt;/Rule&gt;\n</code></pre>"},{"location":"user-guide/xccdf-guide/#use-cases","title":"Use Cases","text":"<ul> <li>DoD/Federal compliance</li> <li>DISA STIGs analysis</li> <li>RMF (Risk Management Framework)</li> <li>Importing into SCC or STIG Viewer</li> </ul>"},{"location":"user-guide/xccdf-guide/#cis-style","title":"CIS Style","text":"<p>XCCDF 1.2 - CIS Native Format</p>"},{"location":"user-guide/xccdf-guide/#features_1","title":"Features","text":"<ul> <li>Official CIS Controls structure (nested framework/safeguard)</li> <li>cc7/cc8 controlURI attributes on ident elements</li> <li>MITRE ATT&amp;CK mappings (techniques, tactics, mitigations)</li> <li>CIS Profiles (Level 1/2, Server/Workstation)</li> <li>NIST SP 800-53 references with Dublin Core</li> <li>Separate rationale element</li> <li>Enhanced metadata in custom namespace</li> </ul>"},{"location":"user-guide/xccdf-guide/#output-example_1","title":"Output Example","text":"<pre><code>&lt;Rule id=\"xccdf_org.cisecurity.benchmarks_rule_6_1_1\"&gt;\n&lt;title&gt;Ensure AIDE is installed&lt;/title&gt;\n&lt;description&gt;AIDE is an intrusion detection tool...&lt;/description&gt;\n\n&lt;metadata&gt;\n&lt;controls:cis_controls&gt;\n&lt;controls:framework urn=\"urn:cisecurity.org:controls:8.0\"&gt;\n&lt;controls:safeguard title=\"Log Sensitive Data Access\"\nurn=\"urn:cisecurity.org:controls:8.0:3.14\"&gt;\n&lt;controls:implementation_groups ig1=\"false\" ig2=\"false\" ig3=\"true\"/&gt;\n&lt;controls:asset_type&gt;Unknown&lt;/controls:asset_type&gt;\n&lt;controls:security_function&gt;Protect&lt;/controls:security_function&gt;\n&lt;/controls:safeguard&gt;\n&lt;/controls:framework&gt;\n&lt;/controls:cis_controls&gt;\n\n&lt;enhanced:mitre&gt;\n&lt;enhanced:technique id=\"T1565.001\"&gt;T1565.001&lt;/enhanced:technique&gt;\n&lt;enhanced:tactic id=\"TA0001\"&gt;TA0001&lt;/enhanced:tactic&gt;\n&lt;enhanced:mitigation id=\"M1022\"&gt;M1022&lt;/enhanced:mitigation&gt;\n&lt;/enhanced:mitre&gt;\n&lt;/metadata&gt;\n\n&lt;ident system=\"http://cisecurity.org/20-cc/v8.0\"\ncc8:controlURI=\"http://cisecurity.org/20-cc/v8.0/control/3/subcontrol/14\"/&gt;\n\n&lt;rationale&gt;By monitoring filesystem state...&lt;/rationale&gt;\n&lt;fixtext&gt;Run the following command...&lt;/fixtext&gt;\n&lt;/Rule&gt;\n</code></pre>"},{"location":"user-guide/xccdf-guide/#use-cases_1","title":"Use Cases","text":"<ul> <li>CIS-CAT compatibility</li> <li>General XCCDF tools</li> <li>Compliance mapping (MITRE, NIST)</li> <li>Security analysis</li> </ul>"},{"location":"user-guide/xccdf-guide/#comparison","title":"Comparison","text":"Feature DISA Style CIS Style XCCDF Version 1.1.4 1.2 CCI Mappings Yes (2161) No CIS Controls Flat metadata Official nested structure MITRE ATT&amp;CK In metadata Enhanced namespace NIST 800-53 Via CCIs Direct + Dublin Core VulnDiscussion Yes No (separate rationale) File Size (322 recs) 1.4 MB 1.7 MB Target Tools DISA SCC, STIG Viewer CIS-CAT, OpenSCAP"},{"location":"user-guide/xccdf-guide/#advanced-options","title":"Advanced Options","text":""},{"location":"user-guide/xccdf-guide/#output-file-naming","title":"Output File Naming","text":"<pre><code># Auto-generated name\ncis-bench export benchmark.json --format xccdf --style cis\n# Creates: benchmark.xml\n\n# Specify name\ncis-bench export benchmark.json --format xccdf --style cis -o custom-name.xml\n</code></pre>"},{"location":"user-guide/xccdf-guide/#batch-export","title":"Batch Export","text":"<pre><code># Export all downloaded benchmarks\nfor file in benchmarks/*.json; do\ncis-bench export \"$file\" --format xccdf --style cis\ndone\n</code></pre>"},{"location":"user-guide/xccdf-guide/#validation","title":"Validation","text":"<p>The exported XCCDF validates against:</p> <ul> <li>NIST XCCDF 1.2 schema (CIS style)</li> <li>NIST XCCDF 1.1.4 schema (DISA style)</li> </ul> <p>Validate with xmllint: <pre><code>xmllint --noout --schema xccdf_1.2.xsd output.xml\n</code></pre></p>"},{"location":"user-guide/xccdf-guide/#metadata-included","title":"Metadata Included","text":""},{"location":"user-guide/xccdf-guide/#disa-style-metadata","title":"DISA Style Metadata","text":"<ul> <li>CCI identifiers (from CIS Controls)</li> <li>NIST 800-53 controls</li> <li>VulnDiscussion</li> <li>Mitigations</li> <li>Impact</li> <li>References</li> </ul>"},{"location":"user-guide/xccdf-guide/#cis-style-metadata","title":"CIS Style Metadata","text":"<p>Official CIS Controls:</p> <ul> <li>Version 7.0 and 8.0</li> <li>Control URNs</li> <li>Implementation groups (IG1, IG2, IG3)</li> <li>Asset types</li> <li>Security functions</li> </ul> <p>Enhanced Metadata:</p> <ul> <li>MITRE ATT&amp;CK techniques</li> <li>MITRE tactics</li> <li>MITRE mitigations</li> <li>CIS Profiles</li> <li>NIST SP 800-53 references</li> </ul> <p>Reference Elements:</p> <ul> <li>Dublin Core metadata</li> <li>NIST control identifiers</li> <li>Source URLs</li> </ul>"},{"location":"user-guide/xccdf-guide/#output-files","title":"Output Files","text":""},{"location":"user-guide/xccdf-guide/#size-expectations","title":"Size Expectations","text":"<p>For 322 recommendations:</p> <ul> <li>DISA: ~1.4 MB</li> <li>CIS: ~1.7 MB</li> </ul> <p>Larger benchmarks proportionally larger.</p>"},{"location":"user-guide/xccdf-guide/#file-locations","title":"File Locations","text":"<p>Default: Same directory as input file with <code>.xml</code> extension</p> <p>Specify: Use <code>-o</code> option</p>"},{"location":"user-guide/xccdf-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/xccdf-guide/#no-converter-registered-for-_element","title":"\"No converter registered for _Element\"","text":"<p>This is an internal error. Report if you see it.</p>"},{"location":"user-guide/xccdf-guide/#large-file-size","title":"Large File Size","text":"<p>XCCDF files are verbose (XML + metadata). This is normal.</p>"},{"location":"user-guide/xccdf-guide/#validation-errors","title":"Validation Errors","text":"<p>Both styles validate against NIST schemas. If you get errors: 1. Check you're using correct schema version 2. Report as bug with sample data</p>"},{"location":"user-guide/xccdf-guide/#see-also","title":"See Also","text":"<ul> <li>XCCDF Styles Design - Technical details</li> <li>Mapping Engine - How it works</li> </ul>"}]}